\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\PassOptionsToPackage{hyphens}{url} % url is loaded by hyperref
\usepackage[unicode=true]{hyperref}
\hypersetup{
            pdftitle={Network 1 Timema Analysis},
            pdfauthor={Tim Farkas},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\title{Network 1 Timema Analysis}
\author{Tim Farkas}
\date{2/13/2018}

\begin{document}
\maketitle

\subsection{Data Input and
Manipulation}\label{data-input-and-manipulation}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# update.packages(ask = FALSE, checkBuilt = TRUE)  # update R packages}
\CommentTok{# tinytex::install_tinytex()}
\CommentTok{# tinytex::tlmgr_update()  # update LaTeX packages}
\CommentTok{#tinytex::reinstall_tinytex(force = TRUE)}

\KeywordTok{library}\NormalTok{(plotrix)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'plotrix' was built under R version 3.6.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# all arthropod data }
\NormalTok{ad <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{( }\StringTok{"data/all_art_n1_data2013.csv"}\NormalTok{, }\DataTypeTok{colClasses=}\KeywordTok{c}\NormalTok{(}\DataTypeTok{plant_id =} \StringTok{"factor"}\NormalTok{))}
\NormalTok{ad <-}\StringTok{ }\KeywordTok{droplevels}\NormalTok{(ad[ad}\OperatorTok{$}\NormalTok{plant_id }\OperatorTok{!=}\StringTok{ "021"}\NormalTok{, ])}

\CommentTok{# plant-level data}
\NormalTok{n1 <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"data/n1_plant_data_16Sept14.csv"}\NormalTok{, }\DataTypeTok{colClasses=}\KeywordTok{c}\NormalTok{(}\DataTypeTok{plant_id=}\StringTok{"character"}\NormalTok{))}
\NormalTok{n1}\OperatorTok{$}\NormalTok{plant_id <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(}\KeywordTok{ifelse}\NormalTok{(}\KeywordTok{nchar}\NormalTok{(n1}\OperatorTok{$}\NormalTok{plant_id) }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\StringTok{"00"}\NormalTok{, n1}\OperatorTok{$}\NormalTok{plant_id, }\DataTypeTok{sep =} \StringTok{""}\NormalTok{), }
                      \KeywordTok{ifelse}\NormalTok{(}\KeywordTok{nchar}\NormalTok{(n1}\OperatorTok{$}\NormalTok{plant_id) }\OperatorTok{==}\StringTok{ }\DecValTok{2}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\StringTok{"0"}\NormalTok{, n1}\OperatorTok{$}\NormalTok{plant_id, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{), n1}\OperatorTok{$}\NormalTok{plant_id)))}

\CommentTok{# carbon-nitrogen data}
\NormalTok{cnd.raw <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"data/cn_data.csv"}\NormalTok{)}
\NormalTok{cnd.raw}\OperatorTok{$}\NormalTok{id <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(}\KeywordTok{ifelse}\NormalTok{(}\KeywordTok{nchar}\NormalTok{(cnd.raw}\OperatorTok{$}\NormalTok{id) }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\StringTok{"00"}\NormalTok{, cnd.raw}\OperatorTok{$}\NormalTok{id, }\DataTypeTok{sep =} \StringTok{""}\NormalTok{), }
                      \KeywordTok{ifelse}\NormalTok{(}\KeywordTok{nchar}\NormalTok{(cnd.raw}\OperatorTok{$}\NormalTok{id) }\OperatorTok{==}\StringTok{ }\DecValTok{2}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\StringTok{"0"}\NormalTok{, cnd.raw}\OperatorTok{$}\NormalTok{id, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{), cnd.raw}\OperatorTok{$}\NormalTok{id)))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nfmal <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(}\DataTypeTok{mal=}\OtherTok{NULL}\NormalTok{, }\DataTypeTok{k=}\DecValTok{1}\NormalTok{) \{}
\NormalTok{  freq <-}\StringTok{ }\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{mal}
  \CommentTok{# adapted moph}
\NormalTok{  min.RSS <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(data, par) \{}
              \KeywordTok{with}\NormalTok{(data, }\KeywordTok{sum}\NormalTok{(( (par[}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{((par[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{par[}\DecValTok{1}\NormalTok{])}\OperatorTok{/}\NormalTok{par[}\DecValTok{2}\NormalTok{]) }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{((}\OperatorTok{-}\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{k }\OperatorTok{*}\StringTok{ }\NormalTok{x))) }\OperatorTok{-}\StringTok{ }\NormalTok{y)}\OperatorTok{^}\DecValTok{2}\NormalTok{))}
\NormalTok{  \}}

\NormalTok{  dat.ad <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(}\FloatTok{0.2}\NormalTok{, }\FloatTok{0.8}\NormalTok{), }\DataTypeTok{y =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, .}\DecValTok{65}\NormalTok{))}
\NormalTok{  pars.ad <-}\StringTok{ }\KeywordTok{optim}\NormalTok{(}\DataTypeTok{par =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), min.RSS, }\DataTypeTok{data=}\NormalTok{dat.ad)}\OperatorTok{$}\NormalTok{par}
  
\NormalTok{  freqs <-}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{)}
\NormalTok{  ws.ad <-}\StringTok{  }\NormalTok{(pars.ad[}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{((pars.ad[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{pars.ad[}\DecValTok{1}\NormalTok{])}\OperatorTok{/}\NormalTok{pars.ad[}\DecValTok{2}\NormalTok{]) }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{((}\OperatorTok{-}\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{k }\OperatorTok{*}\StringTok{ }\NormalTok{freqs)))}
  
  \CommentTok{# plot(freqs, ws.ad)}
  
  \CommentTok{# maladapted morph}
  
\NormalTok{  ws.mal <-}\StringTok{ }\KeywordTok{rev}\NormalTok{(ws.ad) }\OperatorTok{-}\StringTok{ }\NormalTok{.}\DecValTok{35} 
  
\NormalTok{  raw <-}\StringTok{ }\NormalTok{(ws.ad }\OperatorTok{*}\StringTok{ }\NormalTok{freqs) }\OperatorTok{+}\StringTok{ }\NormalTok{(ws.mal }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{freqs))}
  
\NormalTok{  min.w <-}\StringTok{ }\KeywordTok{min}\NormalTok{(raw)}
\NormalTok{  max.w <-}\StringTok{ }\KeywordTok{max}\NormalTok{(raw }\OperatorTok{-}\StringTok{ }\NormalTok{min.w)}
  
\NormalTok{  scaled <-}\StringTok{ }\NormalTok{(raw }\OperatorTok{-}\StringTok{ }\NormalTok{min.w)}\OperatorTok{/}\NormalTok{max.w}
  \KeywordTok{cbind}\NormalTok{(freqs, scaled)}
  \KeywordTok{plot}\NormalTok{(}\KeywordTok{rev}\NormalTok{(freqs), }\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{scaled)}
  \CommentTok{#plot(freqs, ws.ad, ylim=c(-2, 2), type="l")}
  \CommentTok{#plot(freqs, ws.ad, type="l")}
  \CommentTok{#lines(freqs, ws.mal, lty=2)}
  
  \CommentTok{# for output}
\NormalTok{   ws.ad2 <-}\StringTok{ }\NormalTok{(pars.ad[}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{((pars.ad[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{pars.ad[}\DecValTok{1}\NormalTok{])}\OperatorTok{/}\NormalTok{pars.ad[}\DecValTok{2}\NormalTok{]) }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{((}\OperatorTok{-}\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{k }\OperatorTok{*}\StringTok{ }\NormalTok{freq)))}
\NormalTok{   ws.mal2 <-}\StringTok{ }\NormalTok{(pars.ad[}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{((pars.ad[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{pars.ad[}\DecValTok{1}\NormalTok{])}\OperatorTok{/}\NormalTok{pars.ad[}\DecValTok{2}\NormalTok{]) }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{((}\OperatorTok{-}\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{k }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{freq)))) }\OperatorTok{-}\StringTok{ }\NormalTok{.}\DecValTok{35}
\NormalTok{   raw2 <-}\StringTok{ }\NormalTok{(ws.ad2 }\OperatorTok{*}\StringTok{ }\NormalTok{freq) }\OperatorTok{+}\StringTok{ }\NormalTok{(ws.mal2 }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{freq))}
\NormalTok{   sc2 <-}\StringTok{ }\NormalTok{(raw2}\OperatorTok{-}\NormalTok{min.w) }\OperatorTok{/}\StringTok{ }\NormalTok{max.w}
  
  \CommentTok{#plot(freqs, mal)}
  \CommentTok{#pars.ad}

  \DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{sc2}

\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{## overwrite with new maladaptation measure}

\CommentTok{# manipulate data and add variables }
\NormalTok{n1}\OperatorTok{$}\NormalTok{cn2 <-}\StringTok{ }\NormalTok{cnd.raw}\OperatorTok{$}\NormalTok{cn[}\KeywordTok{match}\NormalTok{(n1}\OperatorTok{$}\NormalTok{plant_id, cnd.raw}\OperatorTok{$}\NormalTok{id)]}
\NormalTok{n1}\OperatorTok{$}\NormalTok{pC <-}\StringTok{ }\NormalTok{cnd.raw}\OperatorTok{$}\NormalTok{wC[}\KeywordTok{match}\NormalTok{(n1}\OperatorTok{$}\NormalTok{plant_id, cnd.raw}\OperatorTok{$}\NormalTok{id)]}
\NormalTok{n1}\OperatorTok{$}\NormalTok{pN <-}\StringTok{ }\NormalTok{cnd.raw}\OperatorTok{$}\NormalTok{wN[}\KeywordTok{match}\NormalTok{(n1}\OperatorTok{$}\NormalTok{plant_id, cnd.raw}\OperatorTok{$}\NormalTok{id)]}

\NormalTok{n1}\OperatorTok{$}\NormalTok{host <-}\StringTok{ }\KeywordTok{factor}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{occupied <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{pcon_mal <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host}\OperatorTok{==}\StringTok{"A"}\NormalTok{, n1}\OperatorTok{$}\NormalTok{con_tim_C}\OperatorTok{/}\NormalTok{n1}\OperatorTok{$}\NormalTok{con_tim, n1}\OperatorTok{$}\NormalTok{con_tim_A}\OperatorTok{/}\NormalTok{n1}\OperatorTok{$}\NormalTok{con_tim)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{con_mal <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host}\OperatorTok{==}\StringTok{"A"}\NormalTok{, n1}\OperatorTok{$}\NormalTok{con_tim_C, n1}\OperatorTok{$}\NormalTok{con_tim_A)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{con_ad <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{, n1}\OperatorTok{$}\NormalTok{con_tim_C, n1}\OperatorTok{$}\NormalTok{con_tim_A)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.con_art5 <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_art5}\OperatorTok{-}\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{con_art5)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.con_art <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_art}\OperatorTok{-}\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{con_art)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k0.}\DecValTok{01}\NormalTok{ <-}\StringTok{ }\KeywordTok{nfmal}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mal, }\DataTypeTok{k=}\NormalTok{.}\DecValTok{01}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/Add Variables to n1 data-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k0.}\DecValTok{6}\NormalTok{ <-}\StringTok{ }\KeywordTok{nfmal}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mal, }\DataTypeTok{k=}\FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/Add Variables to n1 data-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k0.}\DecValTok{5}\NormalTok{ <-}\StringTok{ }\KeywordTok{nfmal}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mal, }\DataTypeTok{k=}\FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/Add Variables to n1 data-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k1.}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\KeywordTok{nfmal}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mal, }\DataTypeTok{k=}\FloatTok{1.2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/Add Variables to n1 data-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k2.}\DecValTok{0}\NormalTok{ <-}\StringTok{ }\KeywordTok{nfmal}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mal, }\DataTypeTok{k=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/Add Variables to n1 data-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k3.}\DecValTok{0}\NormalTok{ <-}\StringTok{ }\KeywordTok{nfmal}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mal, }\DataTypeTok{k=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/Add Variables to n1 data-6.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k4.}\DecValTok{0}\NormalTok{ <-}\StringTok{ }\KeywordTok{nfmal}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mal, }\DataTypeTok{k=}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/Add Variables to n1 data-7.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.mal <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{mal}\OperatorTok{-}\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mal, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.nf_mal_k0.}\DecValTok{01}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k0.}\DecValTok{01} \OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{nf_mal_k0.}\DecValTok{01}\NormalTok{, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.nf_mal_k0.}\DecValTok{6}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k0.}\DecValTok{6} \OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{nf_mal_k0.}\DecValTok{6}\NormalTok{, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.nf_mal_k0.}\DecValTok{5}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k0.}\DecValTok{5} \OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{nf_mal_k0.}\DecValTok{5}\NormalTok{, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.nf_mal_k1.}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k1.}\DecValTok{2} \OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{nf_mal_k1.}\DecValTok{2}\NormalTok{, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.nf_mal_k2.}\DecValTok{0}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k2.}\DecValTok{0} \OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{nf_mal_k2.}\DecValTok{0}\NormalTok{, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.nf_mal_k3.}\DecValTok{0}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k3.}\DecValTok{0} \OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{nf_mal_k3.}\DecValTok{0}\NormalTok{, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.nf_mal_k4.}\DecValTok{0}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{nf_mal_k4.}\DecValTok{0} \OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{nf_mal_k4.}\DecValTok{0}\NormalTok{, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{no_mal <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{, n1}\OperatorTok{$}\NormalTok{no_str_tim, n1}\OperatorTok{$}\NormalTok{no_grn_tim)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{no_adp <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host}\OperatorTok{==}\StringTok{"A"}\NormalTok{, n1}\OperatorTok{$}\NormalTok{no_str_tim, n1}\OperatorTok{$}\NormalTok{no_grn_tim)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{con_grn <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_grn_A }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_grn_C }
\NormalTok{n1}\OperatorTok{$}\NormalTok{con_str <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_str_A }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_str_C}
\NormalTok{n1}\OperatorTok{$}\NormalTok{rcon_grn <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_grn}\OperatorTok{/}\NormalTok{n1}\OperatorTok{$}\NormalTok{con_tim}
\NormalTok{n1}\OperatorTok{$}\NormalTok{rcon_grn_A <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_grn_A}\OperatorTok{/}\NormalTok{n1}\OperatorTok{$}\NormalTok{con_grn}
\NormalTok{n1}\OperatorTok{$}\NormalTok{rcon_grn_C <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_grn_C}\OperatorTok{/}\NormalTok{n1}\OperatorTok{$}\NormalTok{con_grn}
\NormalTok{n1}\OperatorTok{$}\NormalTok{con_q2N_A <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{q2N_A}\OperatorTok{*}\NormalTok{n1}\OperatorTok{$}\NormalTok{con_tim}
\NormalTok{n1}\OperatorTok{$}\NormalTok{con_q2N_C <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{q2N_C}\OperatorTok{*}\NormalTok{n1}\OperatorTok{$}\NormalTok{con_tim}
\NormalTok{n1}\OperatorTok{$}\NormalTok{rcon_q2N_C <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{q2N_C}\OperatorTok{/}\NormalTok{(n1}\OperatorTok{$}\NormalTok{q2N_A}\OperatorTok{+}\NormalTok{n1}\OperatorTok{$}\NormalTok{q2N_C)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{rcon_vol_C <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_vol_C}\OperatorTok{/}\NormalTok{n1}\OperatorTok{$}\NormalTok{con_vol}
\NormalTok{n1}\OperatorTok{$}\NormalTok{rcon_tim_C <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_tim_C}\OperatorTok{/}\NormalTok{n1}\OperatorTok{$}\NormalTok{con_tim}
\NormalTok{n1_occ <-}\StringTok{ }\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_tim_gs}\OperatorTok{>}\DecValTok{0}\NormalTok{,]}
\NormalTok{n1}\OperatorTok{$}\NormalTok{dens_art_}\DecValTok{5}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{/}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{ln.vol_cub}
\NormalTok{n1}\OperatorTok{$}\NormalTok{dens_tim_}\DecValTok{5}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim_}\DecValTok{5} \OperatorTok{/}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{ln.vol_cub}
\NormalTok{n1}\OperatorTok{$}\NormalTok{cn_rat <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{cn_ratio}
\NormalTok{n1}\OperatorTok{$}\NormalTok{vol_cubm <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{vol_cub }\OperatorTok{*}\StringTok{ }\FloatTok{0.000016}
\NormalTok{n1}\OperatorTok{$}\NormalTok{any_dens <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_any}\OperatorTok{/}\NormalTok{n1}\OperatorTok{$}\NormalTok{vol_cubm}
\NormalTok{n1}\OperatorTok{$}\NormalTok{any_dens_}\DecValTok{4}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_any_}\DecValTok{4}\OperatorTok{/}\NormalTok{n1}\OperatorTok{$}\NormalTok{vol_cubm}
\NormalTok{n1}\OperatorTok{$}\NormalTok{mal2 <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{mal}\OperatorTok{^}\DecValTok{2}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.mal2 <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{c.mal}\OperatorTok{^}\DecValTok{2}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.no_tim <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(n1}\OperatorTok{$}\NormalTok{no_tim)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{c.host <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{, }\OperatorTok{-}\NormalTok{.}\DecValTok{5}\NormalTok{, .}\DecValTok{5}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{con_q2N_mal <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{, n1}\OperatorTok{$}\NormalTok{con_q2N_C, n1}\OperatorTok{$}\NormalTok{con_q2N_A)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{con_q2N_ad <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "C"}\NormalTok{, n1}\OperatorTok{$}\NormalTok{con_q2N_C, n1}\OperatorTok{$}\NormalTok{con_q2N_A)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# subset data -- using arthropods over 5mm in body length only}
\NormalTok{dd_}\DecValTok{5}\NormalTok{ <-}\StringTok{ }\KeywordTok{droplevels}\NormalTok{(}\KeywordTok{subset}\NormalTok{(ad, }\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(ad}\OperatorTok{$}\NormalTok{weight) }\OperatorTok{&}\StringTok{ }\NormalTok{ad}\OperatorTok{$}\NormalTok{is_}\DecValTok{5}\NormalTok{ ))}
\NormalTok{dd_}\DecValTok{5}\OperatorTok{$}\NormalTok{plant_id <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(dd_}\DecValTok{5}\OperatorTok{$}\NormalTok{plant_id)}


\NormalTok{bins <-}\StringTok{ }\DecValTok{20} \CommentTok{# choose number of bins}
\NormalTok{dd_}\DecValTok{5}\OperatorTok{$}\NormalTok{mass.bin<-}\KeywordTok{cut}\NormalTok{(}\KeywordTok{log}\NormalTok{(dd_}\DecValTok{5}\OperatorTok{$}\NormalTok{weight), bins) }\CommentTok{# cut into pieces}
\NormalTok{work <-}\StringTok{ }\NormalTok{dd_}\DecValTok{5}\NormalTok{[, }\KeywordTok{c}\NormalTok{(}\StringTok{"plant_id"}\NormalTok{, }\StringTok{"host"}\NormalTok{, }\StringTok{"weight"}\NormalTok{, }\StringTok{"mass.bin"}\NormalTok{)] }\CommentTok{# extract columns}


\NormalTok{pids <-}\StringTok{ }\KeywordTok{levels}\NormalTok{(work}\OperatorTok{$}\NormalTok{plant_id)}
\NormalTok{ll <-}\StringTok{ }\KeywordTok{length}\NormalTok{(pids)}

\CommentTok{# initialize structures to collect coefficients}
\NormalTok{slopes<-}\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{, ll)}
\NormalTok{int1 <-}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{, ll)}
\NormalTok{int3 <-}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{, ll)}
\NormalTok{int5 <-}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{, ll)}
\NormalTok{int7 <-}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{, ll)}
\NormalTok{int8 <-}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{, ll)}
\NormalTok{int9 <-}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{, ll)}
\NormalTok{int10 <-}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{, ll)}
\NormalTok{int18 <-}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{, ll)}
\NormalTok{int20 <-}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{, ll)}
\NormalTok{pid <-}\StringTok{ }\KeywordTok{levels}\NormalTok{(work}\OperatorTok{$}\NormalTok{plant_id)}
\NormalTok{sd <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(pid, int1, int3, int5, int7, int8, int9, int10, int18, int20, slopes)}

\CommentTok{# loop over plants to create mass-abundance relationships}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\NormalTok{ll) \{}
  
\NormalTok{  plant <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(work, plant_id}\OperatorTok{==}\NormalTok{pids[i])}

  \CommentTok{# get counts of artropods in each bin}
\NormalTok{  mass.ab <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{with}\NormalTok{(plant, }\KeywordTok{table}\NormalTok{(mass.bin)), }\DataTypeTok{cat=}\KeywordTok{levels}\NormalTok{(plant}\OperatorTok{$}\NormalTok{mass.bin))}
  
  \CommentTok{# create rank of log mass bins, and recenter data for intercept analysis}
\NormalTok{  mass.ab}\OperatorTok{$}\NormalTok{cat.code0 <-}\StringTok{ }\DecValTok{1}\OperatorTok{:}\NormalTok{bins}
\NormalTok{  mass.ab}\OperatorTok{$}\NormalTok{cat.code1 <-}\StringTok{ }\NormalTok{mass.ab}\OperatorTok{$}\NormalTok{cat.code0 }\OperatorTok{-}\StringTok{ }\DecValTok{1} 
\NormalTok{  mass.ab}\OperatorTok{$}\NormalTok{cat.code3 <-}\StringTok{ }\NormalTok{mass.ab}\OperatorTok{$}\NormalTok{cat.code0 }\OperatorTok{-}\StringTok{ }\DecValTok{3}
\NormalTok{  mass.ab}\OperatorTok{$}\NormalTok{cat.code5 <-}\StringTok{ }\NormalTok{mass.ab}\OperatorTok{$}\NormalTok{cat.code0 }\OperatorTok{-}\StringTok{ }\DecValTok{5}
\NormalTok{  mass.ab}\OperatorTok{$}\NormalTok{cat.code7 <-}\StringTok{ }\NormalTok{mass.ab}\OperatorTok{$}\NormalTok{cat.code0 }\OperatorTok{-}\StringTok{ }\DecValTok{7}
\NormalTok{  mass.ab}\OperatorTok{$}\NormalTok{cat.code8 <-}\StringTok{ }\NormalTok{mass.ab}\OperatorTok{$}\NormalTok{cat.code0 }\OperatorTok{-}\StringTok{ }\DecValTok{8}
\NormalTok{  mass.ab}\OperatorTok{$}\NormalTok{cat.code9 <-}\StringTok{ }\NormalTok{mass.ab}\OperatorTok{$}\NormalTok{cat.code0 }\OperatorTok{-}\StringTok{ }\DecValTok{9}
\NormalTok{  mass.ab}\OperatorTok{$}\NormalTok{cat.code10 <-}\StringTok{ }\NormalTok{mass.ab}\OperatorTok{$}\NormalTok{cat.code0 }\OperatorTok{-}\StringTok{ }\DecValTok{10}
\NormalTok{  mass.ab}\OperatorTok{$}\NormalTok{cat.code18 <-}\StringTok{ }\NormalTok{mass.ab}\OperatorTok{$}\NormalTok{cat.code0 }\OperatorTok{-}\StringTok{ }\DecValTok{18}
\NormalTok{  mass.ab}\OperatorTok{$}\NormalTok{cat.code20 <-}\StringTok{ }\NormalTok{mass.ab}\OperatorTok{$}\NormalTok{cat.code0 }\OperatorTok{-}\StringTok{ }\DecValTok{20}
  
  \CommentTok{# replace 0 with NAs}
\NormalTok{  mass.ab}\OperatorTok{$}\NormalTok{Freq[mass.ab}\OperatorTok{$}\NormalTok{Freq}\OperatorTok{==}\DecValTok{0}\NormalTok{] <-}\StringTok{ }\OtherTok{NA}
\NormalTok{  plot.these <-}\StringTok{ }\NormalTok{mass.ab}
  
  \CommentTok{# run simple regression models}
\NormalTok{  mod0 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(}\KeywordTok{log}\NormalTok{(Freq) }\OperatorTok{~}\StringTok{ }\NormalTok{cat.code0, }\DataTypeTok{data =}\NormalTok{ plot.these)}
\NormalTok{  mod1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(}\KeywordTok{log}\NormalTok{(Freq) }\OperatorTok{~}\StringTok{ }\NormalTok{cat.code1, }\DataTypeTok{data =}\NormalTok{ plot.these)}
\NormalTok{  mod3 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(}\KeywordTok{log}\NormalTok{(Freq) }\OperatorTok{~}\StringTok{ }\NormalTok{cat.code3, }\DataTypeTok{data =}\NormalTok{ plot.these)}
\NormalTok{  mod5 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(}\KeywordTok{log}\NormalTok{(Freq) }\OperatorTok{~}\StringTok{ }\NormalTok{cat.code5, }\DataTypeTok{data =}\NormalTok{ plot.these)}
\NormalTok{  mod7 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(}\KeywordTok{log}\NormalTok{(Freq) }\OperatorTok{~}\StringTok{ }\NormalTok{cat.code7, }\DataTypeTok{data =}\NormalTok{ plot.these)}
\NormalTok{  mod8 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(}\KeywordTok{log}\NormalTok{(Freq) }\OperatorTok{~}\StringTok{ }\NormalTok{cat.code8, }\DataTypeTok{data =}\NormalTok{ plot.these)}
\NormalTok{  mod9 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(}\KeywordTok{log}\NormalTok{(Freq) }\OperatorTok{~}\StringTok{ }\NormalTok{cat.code9, }\DataTypeTok{data =}\NormalTok{ plot.these)}
\NormalTok{  mod10 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(}\KeywordTok{log}\NormalTok{(Freq) }\OperatorTok{~}\StringTok{ }\NormalTok{cat.code10, }\DataTypeTok{data =}\NormalTok{ plot.these)}
\NormalTok{  mod18 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(}\KeywordTok{log}\NormalTok{(Freq) }\OperatorTok{~}\StringTok{ }\NormalTok{cat.code18, }\DataTypeTok{data =}\NormalTok{ plot.these)}
\NormalTok{  mod20 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(}\KeywordTok{log}\NormalTok{(Freq) }\OperatorTok{~}\StringTok{ }\NormalTok{cat.code20, }\DataTypeTok{data =}\NormalTok{ plot.these)}
  
  \CommentTok{# collect the coefficients}
\NormalTok{  sd}\OperatorTok{$}\NormalTok{int1[i] <-}\StringTok{ }\KeywordTok{coef}\NormalTok{(mod1)[}\DecValTok{1}\NormalTok{]}
\NormalTok{  sd}\OperatorTok{$}\NormalTok{int3[i] <-}\StringTok{ }\KeywordTok{coef}\NormalTok{(mod3)[}\DecValTok{1}\NormalTok{]}
\NormalTok{  sd}\OperatorTok{$}\NormalTok{int5[i] <-}\StringTok{ }\KeywordTok{coef}\NormalTok{(mod5)[}\DecValTok{1}\NormalTok{]}
\NormalTok{  sd}\OperatorTok{$}\NormalTok{int7[i] <-}\StringTok{ }\KeywordTok{coef}\NormalTok{(mod7)[}\DecValTok{1}\NormalTok{]}
\NormalTok{  sd}\OperatorTok{$}\NormalTok{int8[i] <-}\StringTok{ }\KeywordTok{coef}\NormalTok{(mod8)[}\DecValTok{1}\NormalTok{]}
\NormalTok{  sd}\OperatorTok{$}\NormalTok{int9[i] <-}\StringTok{ }\KeywordTok{coef}\NormalTok{(mod9)[}\DecValTok{1}\NormalTok{]}
\NormalTok{  sd}\OperatorTok{$}\NormalTok{int10[i] <-}\StringTok{ }\KeywordTok{coef}\NormalTok{(mod10)[}\DecValTok{1}\NormalTok{]}
\NormalTok{  sd}\OperatorTok{$}\NormalTok{int18[i] <-}\StringTok{ }\KeywordTok{coef}\NormalTok{(mod18)[}\DecValTok{1}\NormalTok{]}
\NormalTok{  sd}\OperatorTok{$}\NormalTok{int20[i] <-}\StringTok{ }\KeywordTok{coef}\NormalTok{(mod20)[}\DecValTok{1}\NormalTok{]}
\NormalTok{  sd}\OperatorTok{$}\NormalTok{slopes[i]<-}\KeywordTok{coef}\NormalTok{(mod0)[}\DecValTok{2}\NormalTok{]}
  
\NormalTok{\}}

\CommentTok{# fix plant ID codes to be 3 character factor}
\NormalTok{sd}\OperatorTok{$}\NormalTok{pid <-}\StringTok{ }\KeywordTok{as.character}\NormalTok{(sd}\OperatorTok{$}\NormalTok{pid)}
\NormalTok{sd}\OperatorTok{$}\NormalTok{pid <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(}\KeywordTok{ifelse}\NormalTok{(}\KeywordTok{nchar}\NormalTok{(sd}\OperatorTok{$}\NormalTok{pid) }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\StringTok{"00"}\NormalTok{, sd}\OperatorTok{$}\NormalTok{pid, }\DataTypeTok{sep =} \StringTok{""}\NormalTok{), }
                                \KeywordTok{ifelse}\NormalTok{(}\KeywordTok{nchar}\NormalTok{(sd}\OperatorTok{$}\NormalTok{pid) }\OperatorTok{==}\StringTok{ }\DecValTok{2}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\StringTok{"0"}\NormalTok{, sd}\OperatorTok{$}\NormalTok{pid, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{), }
\NormalTok{                                       sd}\OperatorTok{$}\NormalTok{pid)))}

\CommentTok{# NA all intercepts for which no slope could be calculated (n = 1 or 2)}
\NormalTok{sd[}\KeywordTok{is.na}\NormalTok{(sd}\OperatorTok{$}\NormalTok{slopes), }\DecValTok{2}\OperatorTok{:}\DecValTok{11}\NormalTok{] <-}\StringTok{ }\OtherTok{NA}

\CommentTok{# add data to n1}

\NormalTok{## add intercepts to n1}

\NormalTok{n1}\OperatorTok{$}\NormalTok{mas <-}\StringTok{ }\OtherTok{NA}
\NormalTok{n1}\OperatorTok{$}\NormalTok{mai1 <-}\StringTok{ }\OtherTok{NA}
\NormalTok{n1}\OperatorTok{$}\NormalTok{mai3 <-}\StringTok{ }\OtherTok{NA}
\NormalTok{n1}\OperatorTok{$}\NormalTok{mai5 <-}\StringTok{ }\OtherTok{NA}
\NormalTok{n1}\OperatorTok{$}\NormalTok{mai7 <-}\StringTok{ }\OtherTok{NA}
\NormalTok{n1}\OperatorTok{$}\NormalTok{mai8 <-}\StringTok{ }\OtherTok{NA}
\NormalTok{n1}\OperatorTok{$}\NormalTok{mai9 <-}\StringTok{ }\OtherTok{NA}
\NormalTok{n1}\OperatorTok{$}\NormalTok{mai10 <-}\StringTok{ }\OtherTok{NA}
\NormalTok{n1}\OperatorTok{$}\NormalTok{mai18 <-}\StringTok{ }\OtherTok{NA}
\NormalTok{n1}\OperatorTok{$}\NormalTok{mai20 <-}\StringTok{ }\OtherTok{NA}

\CommentTok{# add data, excluding plant 021}
\NormalTok{n1[}\KeywordTok{match}\NormalTok{(sd}\OperatorTok{$}\NormalTok{pid[sd}\OperatorTok{$}\NormalTok{pid }\OperatorTok{!=}\StringTok{ "021"}\NormalTok{], n1}\OperatorTok{$}\NormalTok{plant_id), }
   \KeywordTok{c}\NormalTok{(}\StringTok{"mai1"}\NormalTok{, }\StringTok{"mai3"}\NormalTok{, }\StringTok{"mai5"}\NormalTok{, }\StringTok{"mai7"}\NormalTok{, }\StringTok{"mai8"}\NormalTok{, }\StringTok{"mai9"}\NormalTok{, }\StringTok{"mai10"}\NormalTok{, }\StringTok{"mai18"}\NormalTok{, }\StringTok{"mai20"}\NormalTok{, }\StringTok{"mas"}\NormalTok{)] <-}\StringTok{ }\NormalTok{sd[sd}\OperatorTok{$}\NormalTok{pid }\OperatorTok{!=}\StringTok{ "021"}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{11}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bins <-}\StringTok{ }\DecValTok{20} \CommentTok{# choose number of bins}
\NormalTok{dd_}\DecValTok{5}\OperatorTok{$}\NormalTok{mass.bin<-}\KeywordTok{cut}\NormalTok{(}\KeywordTok{log}\NormalTok{(dd_}\DecValTok{5}\OperatorTok{$}\NormalTok{weight), bins) }\CommentTok{# cut into pieces}

\NormalTok{work2 <-}\StringTok{ }\NormalTok{dd_}\DecValTok{5}\NormalTok{[, }\KeywordTok{c}\NormalTok{(}\StringTok{"plant_id"}\NormalTok{, }\StringTok{"host"}\NormalTok{, }\StringTok{"weight"}\NormalTok{, }\StringTok{"mass.bin"}\NormalTok{)]}

\NormalTok{mass.ab <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{table}\NormalTok{(dd_}\DecValTok{5}\OperatorTok{$}\NormalTok{mass.bin))}

\CommentTok{# check it}
\KeywordTok{sum}\NormalTok{(mass.ab}\OperatorTok{$}\NormalTok{Freq)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1102
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\DecValTok{20}\NormalTok{, }\DataTypeTok{y=}\NormalTok{mass.ab}\OperatorTok{$}\NormalTok{Freq)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/MAS for all communities combined-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mad <-}\StringTok{ }\KeywordTok{droplevels}\NormalTok{(ad[}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(ad}\OperatorTok{$}\NormalTok{weight) }\OperatorTok{&}\StringTok{ }\NormalTok{ad}\OperatorTok{$}\NormalTok{is_}\DecValTok{4}\NormalTok{, ])}

\NormalTok{mas <-}\StringTok{ }\KeywordTok{aggregate}\NormalTok{(mad}\OperatorTok{$}\NormalTok{weight, }\DataTypeTok{by=}\KeywordTok{list}\NormalTok{(}\DataTypeTok{plant_id =}\NormalTok{ mad}\OperatorTok{$}\NormalTok{plant_id), }\DataTypeTok{FUN=}\ControlFlowTok{function}\NormalTok{(x) \{}
  
  \ControlFlowTok{if}\NormalTok{(}\KeywordTok{length}\NormalTok{(x) }\OperatorTok{<}\StringTok{ }\DecValTok{3}\NormalTok{) }\KeywordTok{return}\NormalTok{(}\OtherTok{NA}\NormalTok{)}
  
\NormalTok{  lw <-}\StringTok{ }\KeywordTok{log}\NormalTok{(x)}
\NormalTok{  h1 <-}\StringTok{ }\KeywordTok{hist}\NormalTok{(x)}
\NormalTok{  cnt <-}\StringTok{ }\NormalTok{h1}\OperatorTok{$}\NormalTok{counts}
\NormalTok{  cnt[cnt}\OperatorTok{==}\DecValTok{0}\NormalTok{] <-}\StringTok{ }\OtherTok{NA}
\NormalTok{  mids <-}\StringTok{ }\NormalTok{h1}\OperatorTok{$}\NormalTok{mids}
\NormalTok{  an1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(}\KeywordTok{log}\NormalTok{(cnt) }\OperatorTok{~}\StringTok{ }\KeywordTok{log}\NormalTok{(mids))}
 
  \KeywordTok{return}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DataTypeTok{mas=}\NormalTok{an1}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{]))}
  
\NormalTok{\})}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-1.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-2.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-3.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-4.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-5.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-6.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-7.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-8.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-9.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-10.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-11.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-12.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-13.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-14.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-15.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-16.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-17.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-18.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-19.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-20.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-21.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-22.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-23.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-24.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-25.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-26.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-27.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-28.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-29.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-30.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-31.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-32.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-33.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-34.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-35.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-36.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-37.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-38.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-39.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-40.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-41.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-42.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-43.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-44.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-45.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-46.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-47.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-48.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-49.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-50.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-51.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-52.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-53.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-54.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-55.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-56.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-57.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-58.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-59.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-60.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-61.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-62.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-63.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-64.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-65.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-66.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-67.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-68.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-69.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-70.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-71.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-72.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-73.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-74.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-75.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-76.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-77.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-78.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-79.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-80.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-81.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-82.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-83.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-84.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-85.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-86.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-87.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-88.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-89.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-90.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-91.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-92.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-93.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-94.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-95.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-96.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-97.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-98.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-99.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-100.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-101.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-102.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-103.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-104.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-105.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-106.pdf}
\includegraphics{analyses_files/figure-latex/Calculate Mass-Abundance Relationships - Tims Way-107.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# add to N1 data}
\NormalTok{n1}\OperatorTok{$}\NormalTok{mas <-}\StringTok{ }\NormalTok{mas[}\KeywordTok{match}\NormalTok{(n1}\OperatorTok{$}\NormalTok{plant_id, mas}\OperatorTok{$}\NormalTok{plant_id), }\StringTok{"x"}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\subsection{Regression Analyses}\label{regression-analyses}

\paragraph{Drivers of Maladaptation}\label{drivers-of-maladaptation}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mal }\OperatorTok{~}\StringTok{ }\NormalTok{host, }\DataTypeTok{data=}\NormalTok{n1)}
\KeywordTok{summary}\NormalTok{(an1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mal ~ host, data = n1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.53932 -0.27745 -0.03932  0.26068  0.72255 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  0.27745    0.06669   4.160  7.2e-05 ***
## hostC        0.26187    0.08040   3.257  0.00158 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3592 on 91 degrees of freedom
##   (53 observations deleted due to missingness)
## Multiple R-squared:  0.1044, Adjusted R-squared:  0.09457 
## F-statistic: 10.61 on 1 and 91 DF,  p-value: 0.001582
\end{verbatim}

\paragraph{Effects of Maladaptation}\label{effects-of-maladaptation}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.5}\NormalTok{, }\FloatTok{0.5}\NormalTok{)}
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}

\CommentTok{# main effect models}
\NormalTok{an1.}\DecValTok{1}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_tim }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{con_tim }\OperatorTok{+}\StringTok{ }\NormalTok{cn2,}
             \DataTypeTok{family=}\NormalTok{quasipoisson, }
           \DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{4}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an1.}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_tim ~ c.mal + host + ln.vol_cub + con_tim + 
##     cn2, family = quasipoisson, data = n1, subset = no_tim > 
##     4)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.49224  -0.83543  -0.09667   0.62544   2.36662  
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)  
## (Intercept) -0.207594   1.213446  -0.171   0.8652  
## c.mal       -0.028035   0.298378  -0.094   0.9257  
## host1       -0.045736   0.358165  -0.128   0.8992  
## ln.vol_cub   0.167263   0.073955   2.262   0.0304 *
## con_tim      0.051004   0.028218   1.807   0.0798 .
## cn2          0.001773   0.035684   0.050   0.9607  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 0.90865)
## 
##     Null deviance: 35.583  on 38  degrees of freedom
## Residual deviance: 29.055  on 33  degrees of freedom
##   (1 observation deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an1.}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_tim }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{con_tim,}
             \DataTypeTok{family=}\NormalTok{quasipoisson, }
           \DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{4}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an1.}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_tim ~ c.mal + host + ln.vol_cub + con_tim, family = quasipoisson, 
##     data = n1, subset = no_tim > 4)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.51373  -0.80168  -0.06667   0.59580   2.36304  
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)  
## (Intercept) -0.149383   0.952609  -0.157   0.8763  
## c.mal       -0.005711   0.286871  -0.020   0.9842  
## host1       -0.042412   0.154675  -0.274   0.7855  
## ln.vol_cub   0.164847   0.071695   2.299   0.0276 *
## con_tim      0.056262   0.024962   2.254   0.0306 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 0.8610003)
## 
##     Null deviance: 36.470  on 39  degrees of freedom
## Residual deviance: 29.299  on 35  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an1.}\DecValTok{3}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_tim }\OperatorTok{~}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{con_tim,}
             \DataTypeTok{family=}\NormalTok{quasipoisson, }
           \DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{4}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an1.}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_tim ~ host + ln.vol_cub + con_tim, family = quasipoisson, 
##     data = n1, subset = no_tim > 4)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.51720  -0.80017  -0.06795   0.59200   2.36087  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)  
## (Intercept) -0.14857    0.93844  -0.158   0.8751  
## host1       -0.04130    0.14220  -0.290   0.7731  
## ln.vol_cub   0.16473    0.07046   2.338   0.0251 *
## con_tim      0.05629    0.02458   2.290   0.0280 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 0.8370613)
## 
##     Null deviance: 36.47  on 39  degrees of freedom
## Residual deviance: 29.30  on 36  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# final model}
\NormalTok{an1.f <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_tim }\OperatorTok{~}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{con_tim,}
             \DataTypeTok{family=}\NormalTok{quasipoisson, }
           \DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{4}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an1.f)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_tim ~ ln.vol_cub + con_tim, family = quasipoisson, 
##     data = n1, subset = no_tim > 4)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.51357  -0.79264  -0.04083   0.53831   2.37497  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)  
## (Intercept) -0.23088    0.88708  -0.260   0.7961  
## ln.vol_cub   0.17084    0.06667   2.563   0.0146 *
## con_tim      0.05505    0.02397   2.297   0.0274 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 0.8169915)
## 
##     Null deviance: 36.470  on 39  degrees of freedom
## Residual deviance: 29.371  on 37  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{##### With Neg-Freq Dep Mal Calc -- no difference}

\NormalTok{an1.}\DecValTok{1}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_tim }\OperatorTok{~}\StringTok{  }\NormalTok{con_tim }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub,}
             \DataTypeTok{family=}\NormalTok{quasipoisson, }
           \DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{4}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an1.}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_tim ~ con_tim + ln.vol_cub, family = quasipoisson, 
##     data = n1, subset = no_tim > 4)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.51357  -0.79264  -0.04083   0.53831   2.37497  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)  
## (Intercept) -0.23088    0.88708  -0.260   0.7961  
## con_tim      0.05505    0.02397   2.297   0.0274 *
## ln.vol_cub   0.17084    0.06667   2.563   0.0146 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 0.8169915)
## 
##     Null deviance: 36.470  on 39  degrees of freedom
## Residual deviance: 29.371  on 37  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.5}\NormalTok{, }\FloatTok{0.5}\NormalTok{)}
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}

\NormalTok{#### for new maladaptation model -- from p = 0.03 to 0.056}
\NormalTok{an2.}\DecValTok{1}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.nf_mal_k0.}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5}\OperatorTok{*}\NormalTok{host,}
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an2.}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_art_5 ~ c.nf_mal_k0.5 + ln.vol_cub + c.con_art5 * 
##     host, family = quasipoisson, data = n1, subset = no_tim > 
##     0)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.5517  -1.6891  -0.7854   0.7949   8.0273  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -3.39575    1.07406  -3.162  0.00216 ** 
## c.nf_mal_k0.5     0.40763    0.23405   1.742  0.08511 .  
## ln.vol_cub        0.46044    0.08406   5.478 4.13e-07 ***
## c.con_art5        0.06330    0.02624   2.413  0.01793 *  
## host1             0.41085    0.21784   1.886  0.06262 .  
## c.con_art5:host1 -0.05911    0.03704  -1.596  0.11416    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 5.568432)
## 
##     Null deviance: 652.94  on 92  degrees of freedom
## Residual deviance: 414.74  on 87  degrees of freedom
##   (1 observation deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{####}


\NormalTok{an2.}\DecValTok{1}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5}\OperatorTok{*}\NormalTok{host,}
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an2.}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_art_5 ~ c.mal + ln.vol_cub + c.con_art5 * host, 
##     family = quasipoisson, data = n1, subset = no_tim > 0)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.6751  -1.6447  -0.7855   0.8684   7.8261  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -3.07216    1.02646  -2.993   0.0036 ** 
## c.mal             0.49991    0.23689   2.110   0.0377 *  
## ln.vol_cub        0.43164    0.08042   5.367 6.55e-07 ***
## c.con_art5        0.06731    0.02611   2.578   0.0116 *  
## host1             0.47820    0.21732   2.200   0.0304 *  
## c.con_art5:host1 -0.06740    0.03701  -1.821   0.0720 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 5.346001)
## 
##     Null deviance: 652.94  on 92  degrees of freedom
## Residual deviance: 407.37  on 87  degrees of freedom
##   (1 observation deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an2.}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{host }\OperatorTok{*}\StringTok{ }\NormalTok{c.con_art5, }
             \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim}\OperatorTok{>}\DecValTok{1}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an2.}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_art_5 ~ c.mal + ln.vol_cub + host * c.con_art5, 
##     family = quasipoisson, data = n1, subset = no_tim > 1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.8730  -1.9463  -0.5069   0.9554   7.5987  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)   
## (Intercept)      -1.83738    1.27432  -1.442  0.15454   
## c.mal             0.44057    0.33068   1.332  0.18780   
## ln.vol_cub        0.33915    0.09909   3.423  0.00112 **
## host1             0.19255    0.35264   0.546  0.58707   
## c.con_art5        0.05499    0.02912   1.888  0.06382 . 
## host1:c.con_art5 -0.03657    0.05358  -0.683  0.49755   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 6.056629)
## 
##     Null deviance: 431.96  on 65  degrees of freedom
## Residual deviance: 324.94  on 60  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an2.}\DecValTok{3}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{mal }\OperatorTok{+}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.con_art5 }\OperatorTok{+}\StringTok{ }\NormalTok{cn_rat, }
             \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1)}
\KeywordTok{summary}\NormalTok{(an2.}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_art_5 ~ mal + host + ln.vol_cub + host * c.con_art5 + 
##     cn_rat, family = quasipoisson, data = n1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.8894  -1.5379  -0.5226   0.9420   7.5316  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -2.69695    1.49892  -1.799  0.07580 .  
## mal               0.57739    0.25635   2.252  0.02708 *  
## host1             0.76222    0.40843   1.866  0.06572 .  
## ln.vol_cub        0.45973    0.08489   5.416 6.39e-07 ***
## c.con_art5        0.08046    0.02808   2.865  0.00534 ** 
## cn_rat           -0.04820    0.04701  -1.025  0.30829    
## host1:c.con_art5 -0.06674    0.04068  -1.641  0.10484    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 5.285246)
## 
##     Null deviance: 624.76  on 85  degrees of freedom
## Residual deviance: 361.47  on 79  degrees of freedom
##   (60 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an2.}\DecValTok{4}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{mal }\OperatorTok{*}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub, }\DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1)}
\KeywordTok{summary}\NormalTok{(an2.}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_art_5 ~ mal * host + ln.vol_cub, family = quasipoisson, 
##     data = n1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.1205  -1.7340  -0.8982   0.8801   7.5285  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -3.13525    1.00302  -3.126   0.0024 ** 
## mal          0.51650    0.31353   1.647   0.1031    
## host1        0.64591    0.29033   2.225   0.0287 *  
## ln.vol_cub   0.41083    0.07754   5.298 8.54e-07 ***
## mal:host1   -0.29777    0.49148  -0.606   0.5462    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 5.511588)
## 
##     Null deviance: 652.94  on 92  degrees of freedom
## Residual deviance: 437.29  on 88  degrees of freedom
##   (53 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# main effect models}
\NormalTok{an2.}\DecValTok{1}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{cn2 }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5}\OperatorTok{*}\NormalTok{host,}
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an2.}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_art_5 ~ c.mal + ln.vol_cub + cn2 + c.con_art5 * 
##     host, family = quasipoisson, data = n1, subset = no_tim > 
##     0)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.7302  -1.5775  -0.5168   0.9412   7.4701  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -2.28015    1.48490  -1.536  0.12864    
## c.mal             0.56452    0.25661   2.200  0.03074 *  
## ln.vol_cub        0.45829    0.08452   5.422 6.22e-07 ***
## cn2              -0.05462    0.04758  -1.148  0.25450    
## c.con_art5        0.07966    0.02794   2.851  0.00556 ** 
## host1             0.80262    0.40694   1.972  0.05207 .  
## c.con_art5:host1 -0.06513    0.04052  -1.607  0.11196    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 5.261526)
## 
##     Null deviance: 624.76  on 85  degrees of freedom
## Residual deviance: 360.09  on 79  degrees of freedom
##   (8 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an2.f <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5}\OperatorTok{*}\NormalTok{host,}
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an2.f)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_art_5 ~ c.mal + ln.vol_cub + c.con_art5 * host, 
##     family = quasipoisson, data = n1, subset = no_tim > 0)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.6751  -1.6447  -0.7855   0.8684   7.8261  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -3.07216    1.02646  -2.993   0.0036 ** 
## c.mal             0.49991    0.23689   2.110   0.0377 *  
## ln.vol_cub        0.43164    0.08042   5.367 6.55e-07 ***
## c.con_art5        0.06731    0.02611   2.578   0.0116 *  
## host1             0.47820    0.21732   2.200   0.0304 *  
## c.con_art5:host1 -0.06740    0.03701  -1.821   0.0720 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 5.346001)
## 
##     Null deviance: 652.94  on 92  degrees of freedom
## Residual deviance: 407.37  on 87  degrees of freedom
##   (1 observation deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# partial r-sq}
\NormalTok{an2.}\DecValTok{1}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5,}
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset =}\NormalTok{ host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an2.}\DecValTok{1}\NormalTok{) }\CommentTok{# 37.6% R-sq}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_art_5 ~ c.mal + ln.vol_cub + c.con_art5, family = quasipoisson, 
##     data = n1, subset = host == "C")
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.6270  -1.5586  -0.7073   0.7373   7.9524  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -3.05242    1.26538  -2.412   0.0189 *  
## c.mal        0.71362    0.34010   2.098   0.0401 *  
## ln.vol_cub   0.42820    0.09911   4.320 5.95e-05 ***
## c.con_art5   0.07210    0.02852   2.528   0.0141 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 6.078791)
## 
##     Null deviance: 512.65  on 63  degrees of freedom
## Residual deviance: 311.59  on 60  degrees of freedom
##   (9 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1.p <-}\StringTok{ }\NormalTok{n1[}\KeywordTok{complete.cases}\NormalTok{(n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5}\NormalTok{, n1}\OperatorTok{$}\NormalTok{c.mal, n1}\OperatorTok{$}\NormalTok{ln.vol_cub, n1}\OperatorTok{$}\NormalTok{c.con_art5), ]}
\NormalTok{n1.p}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5}\NormalTok{ <-}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(n1.p}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5}\NormalTok{)}
\CommentTok{# to drop levels properly, keep vars of interest}
\NormalTok{n1.p <-}\StringTok{ }\NormalTok{n1.p[,}\KeywordTok{c}\NormalTok{(}\StringTok{"no_art_5"}\NormalTok{, }\StringTok{"c.mal"}\NormalTok{, }\StringTok{"ln.vol_cub"}\NormalTok{, }\StringTok{"c.con_art5"}\NormalTok{, }\StringTok{"host"}\NormalTok{, }\StringTok{"no_art_5"}\NormalTok{)]}

\NormalTok{an.full <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5,}
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset =}\NormalTok{ host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\NormalTok{an.art_mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\NormalTok{an.art_vol <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\NormalTok{an.art_con <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}

\NormalTok{an.mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(c.mal }\OperatorTok{~}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\NormalTok{an.vol <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(ln.vol_cub }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\NormalTok{an.con <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(c.con_art5 }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}

\NormalTok{r.art_mal <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.art_mal)}
\NormalTok{r.art_vol <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.art_vol)}
\NormalTok{r.art_con <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.art_con)}
\NormalTok{r.mal <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.mal)}
\NormalTok{r.vol <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.vol)}
\NormalTok{r.con <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.con)}

\NormalTok{an.p_mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(r.art_mal }\OperatorTok{~}\StringTok{ }\NormalTok{r.mal)}
\KeywordTok{summary}\NormalTok{(an.p_mal) }\CommentTok{# r-sq = 5.91 %}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = r.art_mal ~ r.mal)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9844 -0.7116 -0.0408  0.5926  3.6861 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)  
## (Intercept) 4.076e-17  1.436e-01   0.000   1.0000  
## r.mal       9.371e-01  4.210e-01   2.226   0.0297 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.149 on 62 degrees of freedom
## Multiple R-squared:  0.074,  Adjusted R-squared:  0.05906 
## F-statistic: 4.955 on 1 and 62 DF,  p-value: 0.02967
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an.p_vol <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(r.art_vol }\OperatorTok{~}\StringTok{ }\NormalTok{r.vol)}
\KeywordTok{summary}\NormalTok{(an.p_vol) }\CommentTok{# r-sq = 33.7 %}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = r.art_vol ~ r.vol)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9844 -0.7116 -0.0408  0.5926  3.6861 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -6.939e-18  1.436e-01   0.000        1    
## r.vol        5.473e-01  9.519e-02   5.749 2.95e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.149 on 62 degrees of freedom
## Multiple R-squared:  0.3477, Adjusted R-squared:  0.3372 
## F-statistic: 33.05 on 1 and 62 DF,  p-value: 2.945e-07
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an.p_con <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(r.art_con }\OperatorTok{~}\StringTok{ }\NormalTok{r.con)}
\KeywordTok{summary}\NormalTok{(an.p_con) }\CommentTok{# r-sq = 7.11 %}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = r.art_con ~ r.con)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9844 -0.7116 -0.0408  0.5926  3.6861 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)  
## (Intercept) 2.458e-17  1.436e-01   0.000   1.0000  
## r.con       1.143e-01  4.739e-02   2.413   0.0188 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.149 on 62 degrees of freedom
## Multiple R-squared:  0.08584,    Adjusted R-squared:  0.07109 
## F-statistic: 5.822 on 1 and 62 DF,  p-value: 0.0188
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# herbivore abundance}
\NormalTok{anh <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_herb_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.con_art5 }\OperatorTok{+}\StringTok{ }\NormalTok{cn2 }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1)}
\KeywordTok{summary}\NormalTok{(anh)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_herb_5 ~ host * c.con_art5 + cn2 + ln.vol_cub, 
##     family = quasipoisson, data = n1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.0557  -1.7191  -0.4770   0.5317   6.5428  
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -4.301610   0.919498  -4.678 7.11e-06 ***
## host1             0.499453   0.276353   1.807  0.07301 .  
## c.con_art5        0.050709   0.019107   2.654  0.00894 ** 
## cn2              -0.036775   0.028114  -1.308  0.19315    
## ln.vol_cub        0.609810   0.057103  10.679  < 2e-16 ***
## host1:c.con_art5 -0.008761   0.026901  -0.326  0.74520    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 4.263334)
## 
##     Null deviance: 1314.29  on 136  degrees of freedom
## Residual deviance:  518.29  on 131  degrees of freedom
##   (9 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# on arthropod diversity (5 mm)}

\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.5}\NormalTok{, }\FloatTok{0.5}\NormalTok{)}
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}

\NormalTok{## for neg freq dep mal}
\NormalTok{an3 <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.nf_mal_k2.}\DecValTok{0} \OperatorTok{*}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = rich_art_5 ~ c.nf_mal_k2.0 * host + ln.vol_cub, 
##     family = quasipoisson, data = n1, subset = no_tim > 0)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.5840  -0.9553  -0.3483   0.7788   2.3267  
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(>|t|)    
## (Intercept)         -2.72255    0.70002  -3.889 0.000195 ***
## c.nf_mal_k2.0        0.45476    0.19918   2.283 0.024827 *  
## host1               -0.06453    0.16319  -0.395 0.693484    
## ln.vol_cub           0.35269    0.05493   6.421 6.67e-09 ***
## c.nf_mal_k2.0:host1 -0.64648    0.45049  -1.435 0.154820    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.524261)
## 
##     Null deviance: 234.49  on 92  degrees of freedom
## Residual deviance: 140.23  on 88  degrees of freedom
##   (1 observation deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{##}


\NormalTok{an3 <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{host }\OperatorTok{*}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = rich_art_5 ~ c.mal * host + ln.vol_cub + host * 
##     c.con_art5, family = quasipoisson, data = n1, subset = no_tim > 
##     0)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3865  -1.0153  -0.2121   0.7193   2.0200  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -2.75709    0.68817  -4.006 0.000131 ***
## c.mal             0.72859    0.21402   3.404 0.001010 ** 
## host1            -0.02279    0.17607  -0.129 0.897303    
## ln.vol_cub        0.35623    0.05413   6.581 3.51e-09 ***
## c.con_art5        0.05687    0.01870   3.041 0.003126 ** 
## c.mal:host1      -0.98839    0.39786  -2.484 0.014921 *  
## host1:c.con_art5 -0.08287    0.02862  -2.896 0.004791 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.359015)
## 
##     Null deviance: 234.49  on 92  degrees of freedom
## Residual deviance: 122.51  on 86  degrees of freedom
##   (1 observation deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an3 <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.con_art5, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim_gs }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = rich_art_5 ~ host * c.mal + host + ln.vol_cub + 
##     host * c.con_art5, family = quasipoisson, data = n1, subset = no_tim_gs > 
##     0)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3865  -1.0153  -0.2121   0.7193   2.0200  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -2.75709    0.68817  -4.006 0.000131 ***
## host1            -0.02279    0.17607  -0.129 0.897303    
## c.mal             0.72859    0.21402   3.404 0.001010 ** 
## ln.vol_cub        0.35623    0.05413   6.581 3.51e-09 ***
## c.con_art5        0.05687    0.01870   3.041 0.003126 ** 
## host1:c.mal      -0.98839    0.39786  -2.484 0.014921 *  
## host1:c.con_art5 -0.08287    0.02862  -2.896 0.004791 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.359015)
## 
##     Null deviance: 234.49  on 92  degrees of freedom
## Residual deviance: 122.51  on 86  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{an3.}\DecValTok{1}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
             \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim}\OperatorTok{>}\DecValTok{1}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an3.}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = rich_art_5 ~ host * c.mal + host + ln.vol_cub + 
##     c.con_art5, family = quasipoisson, data = n1, subset = no_tim > 
##     1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.5165  -1.1008  -0.1576   0.9107   2.0497  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -2.50369    0.82816  -3.023  0.00368 ** 
## host1        0.61763    0.25225   2.448  0.01729 *  
## c.mal       -0.83967    0.61093  -1.374  0.17442    
## ln.vol_cub   0.28991    0.06540   4.433 4.02e-05 ***
## c.con_art5   0.04197    0.01804   2.326  0.02341 *  
## host1:c.mal  1.54806    0.67284   2.301  0.02490 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.446096)
## 
##     Null deviance: 153.997  on 65  degrees of freedom
## Residual deviance:  90.206  on 60  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an3.}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.con_art5 }\OperatorTok{+}
\StringTok{               }\NormalTok{cn_rat, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim_gs }\OperatorTok{>}\StringTok{ }\DecValTok{3}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an3.}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = rich_art_5 ~ host * c.mal + host + ln.vol_cub + 
##     host * c.con_art5 + cn_rat, family = quasipoisson, data = n1, 
##     subset = no_tim_gs > 3)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.6129  -0.9568  -0.2084   0.6939   2.2196  
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)  
## (Intercept)      -0.655505   2.317628  -0.283   0.7791  
## host1            -0.390998   0.604090  -0.647   0.5221  
## c.mal            -0.093110   1.124048  -0.083   0.9345  
## ln.vol_cub        0.327657   0.124026   2.642   0.0127 *
## c.con_art5        0.003396   0.053773   0.063   0.9500  
## cn_rat           -0.066657   0.056740  -1.175   0.2487  
## host1:c.mal       1.325556   1.247692   1.062   0.2960  
## host1:c.con_art5  0.071246   0.062926   1.132   0.2660  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.635073)
## 
##     Null deviance: 84.078  on 39  degrees of freedom
## Residual deviance: 52.518  on 32  degrees of freedom
##   (2 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# final model}

\NormalTok{an3.}\DecValTok{1}\NormalTok{ <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{cn2 }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.con_art5, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1)}
\KeywordTok{summary}\NormalTok{(an3.}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = rich_art_5 ~ host * c.mal + ln.vol_cub + cn2 + 
##     host * c.con_art5, family = quasipoisson, data = n1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3927  -1.0121  -0.2293   0.6199   2.1031  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -2.17357    1.18643  -1.832  0.07076 .  
## host1            -0.19521    0.31487  -0.620  0.53708    
## c.mal            -0.30162    0.34848  -0.866  0.38940    
## ln.vol_cub        0.37460    0.05774   6.487 7.32e-09 ***
## cn2              -0.02960    0.03520  -0.841  0.40301    
## c.con_art5       -0.02420    0.02222  -1.089  0.27959    
## host1:c.mal       1.10013    0.40981   2.684  0.00887 ** 
## host1:c.con_art5  0.09438    0.03096   3.049  0.00314 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.346103)
## 
##     Null deviance: 221.89  on 85  degrees of freedom
## Residual deviance: 110.07  on 78  degrees of freedom
##   (60 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an3.f <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.con_art5, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1)}
\KeywordTok{summary}\NormalTok{(an3.f)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = rich_art_5 ~ host * c.mal + ln.vol_cub + host * 
##     c.con_art5, family = quasipoisson, data = n1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3865  -1.0153  -0.2121   0.7193   2.0200  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -2.77989    0.63926  -4.349 3.75e-05 ***
## host1             0.02279    0.17607   0.129  0.89730    
## c.mal            -0.25980    0.33514  -0.775  0.44034    
## ln.vol_cub        0.35623    0.05413   6.581 3.51e-09 ***
## c.con_art5       -0.02600    0.02146  -1.212  0.22897    
## host1:c.mal       0.98839    0.39786   2.484  0.01492 *  
## host1:c.con_art5  0.08287    0.02862   2.896  0.00479 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.359015)
## 
##     Null deviance: 234.49  on 92  degrees of freedom
## Residual deviance: 122.51  on 86  degrees of freedom
##   (53 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# partial r-sq}

\NormalTok{an3 <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an3) }\CommentTok{# R-sq = 53% total}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = rich_art_5 ~ c.mal + ln.vol_cub + c.con_art5, family = quasipoisson, 
##     data = n1, subset = host == "C")
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3858  -1.1404  -0.2420   0.8255   2.0197  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -2.75955    0.79599  -3.467  0.00098 ***
## c.mal        0.72862    0.22775   3.199  0.00220 ** 
## ln.vol_cub   0.35643    0.06266   5.688 4.05e-07 ***
## c.con_art5   0.05688    0.01992   2.855  0.00590 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.538553)
## 
##     Null deviance: 184.732  on 63  degrees of freedom
## Residual deviance:  97.756  on 60  degrees of freedom
##   (9 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1.p <-}\StringTok{ }\NormalTok{n1[}\KeywordTok{complete.cases}\NormalTok{(n1}\OperatorTok{$}\NormalTok{rich_art_}\DecValTok{5}\NormalTok{, n1}\OperatorTok{$}\NormalTok{c.mal, n1}\OperatorTok{$}\NormalTok{ln.vol_cub, n1}\OperatorTok{$}\NormalTok{c.con_art5), ]}
\NormalTok{n1.p}\OperatorTok{$}\NormalTok{rich_art_}\DecValTok{5}\NormalTok{ <-}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(n1.p}\OperatorTok{$}\NormalTok{rich_art_}\DecValTok{5}\NormalTok{)}

\NormalTok{an.rich_mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\NormalTok{an.rich_vol <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\NormalTok{an.rich_con <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\NormalTok{an.mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(c.mal }\OperatorTok{~}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\NormalTok{an.vol <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(ln.vol_cub }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\NormalTok{an.con <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(c.con_art5 }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub, }
           \DataTypeTok{data=}\NormalTok{n1.p, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}

\NormalTok{r.rich_mal <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.rich_mal)}
\NormalTok{r.rich_vol <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.rich_vol)}
\NormalTok{r.rich_con <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.rich_con)}
\NormalTok{r.mal <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.mal)}
\NormalTok{r.vol <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.vol)}
\NormalTok{r.con <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.con)}

\NormalTok{an.p_mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(r.rich_mal }\OperatorTok{~}\StringTok{ }\NormalTok{r.mal)}
\KeywordTok{summary}\NormalTok{(an.p_mal) }\CommentTok{# r-sq = 9.92 %}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = r.rich_mal ~ r.mal)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.55867 -0.48803  0.00644  0.56164  1.30531 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)   
## (Intercept) -2.843e-17  8.486e-02   0.000  1.00000   
## r.mal        7.012e-01  2.488e-01   2.818  0.00648 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.6789 on 62 degrees of freedom
## Multiple R-squared:  0.1135, Adjusted R-squared:  0.09924 
## F-statistic: 7.941 on 1 and 62 DF,  p-value: 0.006476
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an.p_vol <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(r.rich_vol }\OperatorTok{~}\StringTok{ }\NormalTok{r.vol)}
\KeywordTok{summary}\NormalTok{(an.p_vol) }\CommentTok{# r-sq = 42.3 %}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = r.rich_vol ~ r.vol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.55867 -0.48803  0.00644  0.56164  1.30531 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 3.469e-17  8.486e-02   0.000        1    
## r.vol       3.864e-01  5.626e-02   6.868 3.63e-09 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.6789 on 62 degrees of freedom
## Multiple R-squared:  0.4321, Adjusted R-squared:  0.4229 
## F-statistic: 47.18 on 1 and 62 DF,  p-value: 3.631e-09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an.p_con <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(r.rich_con }\OperatorTok{~}\StringTok{ }\NormalTok{r.con)}
\KeywordTok{summary}\NormalTok{(an.p_con) }\CommentTok{# r-sq = 5.84 %}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = r.rich_con ~ r.con)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.55867 -0.48803  0.00644  0.56164  1.30531 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)  
## (Intercept) 6.889e-18  8.486e-02   0.000   1.0000  
## r.con       6.205e-02  2.801e-02   2.215   0.0304 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.6789 on 62 degrees of freedom
## Multiple R-squared:  0.07335,    Adjusted R-squared:  0.0584 
## F-statistic: 4.908 on 1 and 62 DF,  p-value: 0.03042
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.5}\NormalTok{, }\FloatTok{0.5}\NormalTok{)}
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}

\NormalTok{an5 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub , }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an5)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = cn2 ~ c.mal + host + ln.vol_cub, data = n1, subset = no_tim > 
##     0)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3563 -1.3177  0.0028  1.1640  4.5875 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 19.94660    1.90134  10.491   <2e-16 ***
## c.mal       -1.31193    0.54549  -2.405   0.0184 *  
## host1        7.56694    0.46137  16.401   <2e-16 ***
## ln.vol_cub   0.05646    0.15487   0.365   0.7164    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.81 on 82 degrees of freedom
##   (8 observations deleted due to missingness)
## Multiple R-squared:  0.8068, Adjusted R-squared:  0.7997 
## F-statistic: 114.1 on 3 and 82 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an6 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{pC, }\DataTypeTok{data=}\NormalTok{n1)}
\NormalTok{an7 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{pN, }\DataTypeTok{data=}\NormalTok{n1)}
\KeywordTok{summary}\NormalTok{(an6)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = cn2 ~ pC, data = n1)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -7.898 -3.701 -1.085  3.810 14.042 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  27.0853     3.2998   8.208 1.59e-13 ***
## pC           -0.2731     0.3185  -0.858    0.393    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.656 on 135 degrees of freedom
##   (9 observations deleted due to missingness)
## Multiple R-squared:  0.005417,   Adjusted R-squared:  -0.00195 
## F-statistic: 0.7353 on 1 and 135 DF,  p-value: 0.3927
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(an7)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = cn2 ~ pN, data = n1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.0101 -1.7586 -0.3754  1.3619 18.4994 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)   39.854      1.030   38.70   <2e-16 ***
## pN           -35.430      2.279  -15.55   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.795 on 135 degrees of freedom
##   (9 observations deleted due to missingness)
## Multiple R-squared:  0.6417, Adjusted R-squared:  0.639 
## F-statistic: 241.7 on 1 and 135 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{an5 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(pC }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim}\OperatorTok{>}\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an5)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = pC ~ c.mal + host, data = n1, subset = no_tim > 
##     0)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.0288 -0.5477 -0.0229  0.5032 11.0203 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  10.1707     0.2980  34.132   <2e-16 ***
## c.mal         0.2730     0.4463   0.612    0.542    
## host1         0.2438     0.3606   0.676    0.501    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.482 on 83 degrees of freedom
##   (8 observations deleted due to missingness)
## Multiple R-squared:  0.01341,    Adjusted R-squared:  -0.01036 
## F-statistic: 0.564 on 2 and 83 DF,  p-value: 0.5711
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{an5 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(pN }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{no_herb , }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim}\OperatorTok{>}\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an5)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = pN ~ c.mal + host + no_herb, data = n1, subset = no_tim > 
##     0)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.15346 -0.03789  0.00174  0.02453  0.58215 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 0.3535096  0.0202036  17.497  < 2e-16 ***
## c.mal       0.0380642  0.0251261   1.515    0.134    
## host1       0.1418512  0.0199923   7.095 4.19e-10 ***
## no_herb     0.0008782  0.0008526   1.030    0.306    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.08202 on 82 degrees of freedom
##   (8 observations deleted due to missingness)
## Multiple R-squared:  0.4475, Adjusted R-squared:  0.4273 
## F-statistic: 22.14 on 3 and 82 DF,  p-value: 1.35e-10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# final model}
\NormalTok{an5.}\DecValTok{1}\NormalTok{ <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an5.}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = cn2 ~ c.mal + host + ln.vol_cub + no_art_5, data = n1, 
##     subset = no_tim > 0)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3052 -1.1541 -0.0549  1.0570  4.3339 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 26.37517    1.91214  13.794   <2e-16 ***
## c.mal       -1.13413    0.55220  -2.054   0.0432 *  
## host1       -7.71009    0.46613 -16.541   <2e-16 ***
## ln.vol_cub   0.19395    0.17646   1.099   0.2750    
## no_art_5    -0.04080    0.02585  -1.579   0.1183    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.794 on 81 degrees of freedom
##   (8 observations deleted due to missingness)
## Multiple R-squared:  0.8125, Adjusted R-squared:  0.8033 
## F-statistic: 87.76 on 4 and 81 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an5.}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an5.}\DecValTok{2}\NormalTok{)}\CommentTok{# R-sq = 80.2 %}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = cn2 ~ c.mal + host + no_art_5, data = n1, subset = no_tim > 
##     0)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.377 -1.086 -0.082  1.093  4.516 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 28.42373    0.42761  66.471   <2e-16 ***
## c.mal       -1.17752    0.55149  -2.135   0.0357 *  
## host1       -7.53107    0.43730 -17.222   <2e-16 ***
## no_art_5    -0.02678    0.02251  -1.190   0.2375    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.796 on 82 degrees of freedom
##   (8 observations deleted due to missingness)
## Multiple R-squared:  0.8097, Adjusted R-squared:  0.8028 
## F-statistic: 116.3 on 3 and 82 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an5.f <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an5.f) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = cn2 ~ c.mal + host, data = n1, subset = no_tim > 
##     0)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.377 -1.280 -0.009  1.170  4.624 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  28.1514     0.3621  77.739   <2e-16 ***
## c.mal        -1.3051     0.5423  -2.407   0.0183 *  
## host1        -7.5170     0.4382 -17.153   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.8 on 83 degrees of freedom
##   (8 observations deleted due to missingness)
## Multiple R-squared:  0.8064, Adjusted R-squared:  0.8018 
## F-statistic: 172.9 on 2 and 83 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{## neg freq dep mal}
\NormalTok{an5.f <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{c.nf_mal_k0.}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{host, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an5.f)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = cn2 ~ c.nf_mal_k0.5 + host, data = n1, subset = no_tim > 
##     0)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1498 -1.3665 -0.0076  1.2264  4.2070 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)    
## (Intercept)    28.2882     0.3566  79.330   <2e-16 ***
## c.nf_mal_k0.5  -1.1872     0.5567  -2.133   0.0359 *  
## host1          -7.7235     0.4270 -18.086   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.813 on 83 degrees of freedom
##   (8 observations deleted due to missingness)
## Multiple R-squared:  0.8037, Adjusted R-squared:  0.799 
## F-statistic: 169.9 on 2 and 83 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{##}

\CommentTok{# partial r-sq}
\NormalTok{p.n1 <-}\StringTok{ }\NormalTok{n1[}\KeywordTok{complete.cases}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host, n1}\OperatorTok{$}\NormalTok{c.mal, n1}\OperatorTok{$}\NormalTok{cn2), ]}
\NormalTok{p.n1}\OperatorTok{$}\NormalTok{c.host <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(p.n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{, }\OperatorTok{-}\NormalTok{.}\DecValTok{5}\NormalTok{, .}\DecValTok{5}\NormalTok{)}

\NormalTok{an.mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(c.mal }\OperatorTok{~}\StringTok{ }\NormalTok{c.host, }\DataTypeTok{data=}\NormalTok{p.n1)}
\NormalTok{an.host <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(c.host }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal, }\DataTypeTok{data=}\NormalTok{p.n1)}
\NormalTok{an.cn_h <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{c.host, }\DataTypeTok{data=}\NormalTok{p.n1)}
\NormalTok{an.cn_m <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal, }\DataTypeTok{data=}\NormalTok{p.n1)}

\NormalTok{r.mal <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.mal)}
\NormalTok{r.host <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.host)}
\NormalTok{r.cn_h <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.cn_h)}
\NormalTok{r.cn_m <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.cn_m)}

\NormalTok{an.p_mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(r.cn_h }\OperatorTok{~}\StringTok{ }\NormalTok{r.mal) }
\KeywordTok{summary}\NormalTok{(an.p_mal) }\CommentTok{# r-sq = 5.41%}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = r.cn_h ~ r.mal)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.377 -1.280 -0.009  1.170  4.624 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)  
## (Intercept)  3.742e-17  1.930e-01   0.000   1.0000  
## r.mal       -1.305e+00  5.391e-01  -2.421   0.0176 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.79 on 84 degrees of freedom
## Multiple R-squared:  0.06523,    Adjusted R-squared:  0.0541 
## F-statistic: 5.861 on 1 and 84 DF,  p-value: 0.01763
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an.p_host <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(r.cn_m }\OperatorTok{~}\StringTok{ }\NormalTok{r.host)}
\KeywordTok{summary}\NormalTok{(an.p_host) }\CommentTok{# r-sq = 77.7%}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = r.cn_m ~ r.host)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.377 -1.280 -0.009  1.170  4.624 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -1.688e-18  1.930e-01    0.00        1    
## r.host      -7.517e+00  4.356e-01  -17.26   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.79 on 84 degrees of freedom
## Multiple R-squared:   0.78,  Adjusted R-squared:  0.7773 
## F-statistic: 297.8 on 1 and 84 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# on biomass}
\CommentTok{# changed starts from 0}
\NormalTok{an2 <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(biomass }\OperatorTok{~}\StringTok{ }\NormalTok{mal, }\DataTypeTok{family=}\NormalTok{Gamma, }\DataTypeTok{start=}\KeywordTok{c}\NormalTok{(}\FloatTok{0.0001}\NormalTok{,}\FloatTok{0.0001}\NormalTok{),}
           \DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{biomass }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{,])}
\KeywordTok{summary}\NormalTok{(an2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = biomass ~ mal, family = Gamma, data = n1[n1$biomass > 
##     0, ], start = c(1e-04, 1e-04))
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4097  -1.0986  -0.4272   0.2647   2.0929  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)    7.295      1.240   5.885 7.47e-08 ***
## mal           -3.431      1.733  -1.980   0.0509 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for Gamma family taken to be 1.196149)
## 
##     Null deviance: 111.56  on 87  degrees of freedom
## Residual deviance: 106.84  on 86  degrees of freedom
##   (41 observations deleted due to missingness)
## AIC: -120.38
## 
## Number of Fisher Scoring iterations: 21
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{## connectivity on maladaptation?}

\NormalTok{mal_nomal <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(n1_occ}\OperatorTok{$}\NormalTok{no_mal, n1_occ}\OperatorTok{$}\NormalTok{no_adp)}
\NormalTok{grn_str <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(n1_occ}\OperatorTok{$}\NormalTok{no_grn_tim, n1_occ}\OperatorTok{$}\NormalTok{no_str_tim)}

\CommentTok{#an1 <- glm(tims ~ n1_occ$con_tim, family=binomial) # no effect of connectivity, !!what is tims}
\NormalTok{an2 <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(mal }\OperatorTok{~}\StringTok{ }\NormalTok{con_tim, }\DataTypeTok{data=}\NormalTok{n1_occ)}
\KeywordTok{summary}\NormalTok{(an2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = mal ~ con_tim, data = n1_occ)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.49278  -0.43417   0.02203   0.29194   0.56315  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  0.49289    0.05898   8.357 6.96e-13 ***
## con_tim     -0.01668    0.02085  -0.800    0.426    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 0.1430296)
## 
##     Null deviance: 13.107  on 92  degrees of freedom
## Residual deviance: 13.016  on 91  degrees of freedom
## AIC: 87.043
## 
## Number of Fisher Scoring iterations: 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an3 <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(mal_nomal }\OperatorTok{~}\StringTok{ }\NormalTok{no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{family=}\NormalTok{binomial, }\DataTypeTok{data=}\NormalTok{n1_occ, }\DataTypeTok{subset=}\NormalTok{no_tim}\OperatorTok{>}\DecValTok{0}\NormalTok{)}

\KeywordTok{summary}\NormalTok{(an3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = mal_nomal ~ no_art_5, family = binomial, data = n1_occ, 
##     subset = no_tim > 0)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.5271  -1.0306  -0.3327   0.8986   2.5854  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(>|z|)  
## (Intercept) -0.338683   0.166728  -2.031   0.0422 *
## no_art_5    -0.002842   0.010716  -0.265   0.7909  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 133.15  on 92  degrees of freedom
## Residual deviance: 133.08  on 91  degrees of freedom
## AIC: 239.92
## 
## Number of Fisher Scoring iterations: 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an4 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mal }\OperatorTok{~}\StringTok{ }\NormalTok{no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }\DataTypeTok{data=}\NormalTok{n1)}
\KeywordTok{summary}\NormalTok{(an4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mal ~ no_art_5 + ln.vol_cub + host + c.con_art5, 
##     data = n1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.55503 -0.27132 -0.03773  0.27866  0.76125 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)   
## (Intercept)  0.515242   0.330751   1.558  0.12287   
## no_art_5     0.009593   0.004962   1.933  0.05643 . 
## ln.vol_cub  -0.027387   0.030703  -0.892  0.37482   
## host1        0.248194   0.094221   2.634  0.00996 **
## c.con_art5  -0.008293   0.009454  -0.877  0.38281   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3568 on 88 degrees of freedom
##   (53 observations deleted due to missingness)
## Multiple R-squared:  0.1451, Adjusted R-squared:  0.1062 
## F-statistic: 3.734 on 4 and 88 DF,  p-value: 0.007463
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# plant growth}

\KeywordTok{hist}\NormalTok{(n1}\OperatorTok{$}\NormalTok{avg_growth)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/Plant Growth Flowering-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(avg_growth }\OperatorTok{~}\StringTok{  }\NormalTok{con_art5 }\OperatorTok{+}\StringTok{ }\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1)}
\KeywordTok{summary}\NormalTok{(an1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = avg_growth ~ con_art5 + host + no_art_5, data = n1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -49.527 -12.393  -1.892  10.114  45.407 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  81.8856     4.0065  20.438   <2e-16 ***
## con_art5     -0.9006     0.3759  -2.396   0.0183 *  
## host1       -40.4208     3.9231 -10.303   <2e-16 ***
## no_art_5     -0.5023     0.2250  -2.232   0.0277 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 18.14 on 105 degrees of freedom
##   (37 observations deleted due to missingness)
## Multiple R-squared:  0.5578, Adjusted R-squared:  0.5452 
## F-statistic: 44.15 on 3 and 105 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(n1}\OperatorTok{$}\NormalTok{avg_no_flwrs)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/Plant Growth Flowering-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1}\OperatorTok{$}\NormalTok{no_not_herb_}\DecValTok{5}\NormalTok{ <-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{-}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_herb_}\DecValTok{5}
\NormalTok{an2 <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(avg_no_flwrs }\OperatorTok{~}\StringTok{ }\NormalTok{no_herb_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{family=}\NormalTok{quasipoisson)}
\KeywordTok{summary}\NormalTok{(an2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = avg_no_flwrs ~ no_herb_5 + ln.vol_cub, family = quasipoisson, 
##     data = n1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.8752  -1.0093  -0.5487   0.2925   2.5442  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)   
## (Intercept) -3.53768    1.22170  -2.896  0.00508 **
## no_herb_5    0.01450    0.01187   1.221  0.22618   
## ln.vol_cub   0.29910    0.10407   2.874  0.00540 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.286064)
## 
##     Null deviance: 109.804  on 70  degrees of freedom
## Residual deviance:  83.553  on 68  degrees of freedom
##   (75 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.5}\NormalTok{, }\FloatTok{0.5}\NormalTok{)}
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}

\NormalTok{an.s1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{c.no_tim }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }\DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{c.mal }\OperatorTok{<}\StringTok{ }\FloatTok{0.6}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an.s1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mas ~ host * c.mal + host * c.no_art_5 + c.mal * 
##     c.no_tim + c.con_art5, data = n1[n1$no_art_5 > 2 & n1$no_tim > 
##     0 & n1$c.mal < 0.6, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.60977 -0.18461 -0.01867  0.15665  0.64327 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -0.681677   0.053586 -12.721  < 2e-16 ***
## host1             0.214007   0.103443   2.069  0.04242 *  
## c.mal             0.150830   0.129742   1.163  0.24914    
## c.no_art_5       -0.030005   0.004684  -6.406 1.72e-08 ***
## c.no_tim         -0.014150   0.009853  -1.436  0.15560    
## c.con_art5        0.027374   0.008206   3.336  0.00139 ** 
## host1:c.mal       0.116187   0.228700   0.508  0.61310    
## host1:c.no_art_5 -0.021955   0.010567  -2.078  0.04157 *  
## c.mal:c.no_tim    0.101103   0.036701   2.755  0.00755 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2837 on 67 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.5893, Adjusted R-squared:  0.5403 
## F-statistic: 12.02 on 8 and 67 DF,  p-value: 1.833e-10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an.sf <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{c.no_tim }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }\DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an.sf)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mas ~ host * c.mal + host * c.no_art_5 + c.mal * 
##     c.no_tim + c.con_art5, data = n1[n1$no_art_5 > 2 & n1$no_tim > 
##     0, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.60977 -0.18461 -0.01867  0.15665  0.64327 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -0.681677   0.053586 -12.721  < 2e-16 ***
## host1             0.214007   0.103443   2.069  0.04242 *  
## c.mal             0.150830   0.129742   1.163  0.24914    
## c.no_art_5       -0.030005   0.004684  -6.406 1.72e-08 ***
## c.no_tim         -0.014150   0.009853  -1.436  0.15560    
## c.con_art5        0.027374   0.008206   3.336  0.00139 ** 
## host1:c.mal       0.116187   0.228700   0.508  0.61310    
## host1:c.no_art_5 -0.021955   0.010567  -2.078  0.04157 *  
## c.mal:c.no_tim    0.101103   0.036701   2.755  0.00755 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2837 on 67 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.5893, Adjusted R-squared:  0.5403 
## F-statistic: 12.02 on 8 and 67 DF,  p-value: 1.833e-10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{## neg freq dep mal}
\NormalTok{an.sf <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.nf_mal_k2.}\DecValTok{0} \OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.nf_mal_k2.}\DecValTok{0}\OperatorTok{*}\NormalTok{c.no_tim }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }\DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an.sf)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mas ~ host * c.nf_mal_k2.0 + host * c.no_art_5 + 
##     c.nf_mal_k2.0 * c.no_tim + c.con_art5, data = n1[n1$no_art_5 > 
##     2 & n1$no_tim > 0, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.65026 -0.18648 -0.01336  0.15695  0.65073 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(>|t|)    
## (Intercept)            -0.669402   0.053918 -12.415  < 2e-16 ***
## host1                   0.186294   0.099619   1.870  0.06585 .  
## c.nf_mal_k2.0           0.191140   0.124392   1.537  0.12910    
## c.no_art_5             -0.030816   0.004728  -6.518 1.09e-08 ***
## c.no_tim                0.004219   0.010516   0.401  0.68956    
## c.con_art5              0.027535   0.008168   3.371  0.00125 ** 
## host1:c.nf_mal_k2.0    -0.008786   0.240330  -0.037  0.97094    
## host1:c.no_art_5       -0.018592   0.010529  -1.766  0.08200 .  
## c.nf_mal_k2.0:c.no_tim  0.106121   0.042233   2.513  0.01439 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2854 on 67 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.5841, Adjusted R-squared:  0.5345 
## F-statistic: 11.76 on 8 and 67 DF,  p-value: 2.717e-10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{###}

\NormalTok{an1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mai1 }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{c.no_tim, }\DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mai1 ~ host * c.mal + host * c.no_art_5 + c.mal * 
##     c.no_tim, data = n1[n1$no_art_5 > 2 & n1$no_tim > 0, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.50939 -0.40094 -0.02639  0.31742  2.32790 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)       0.488093   0.115158   4.238 6.94e-05 ***
## host1            -0.507877   0.212174  -2.394  0.01945 *  
## c.mal             0.054880   0.283720   0.193  0.84720    
## c.no_art_5        0.052519   0.010370   5.065 3.34e-06 ***
## c.no_tim          0.004581   0.021266   0.215  0.83010    
## host1:c.mal      -1.054458   0.502242  -2.100  0.03949 *  
## host1:c.no_art_5  0.044190   0.023411   1.888  0.06335 .  
## c.mal:c.no_tim   -0.276703   0.080579  -3.434  0.00102 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.6286 on 68 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.4525, Adjusted R-squared:  0.3961 
## F-statistic: 8.028 on 7 and 68 DF,  p-value: 4.402e-07
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an20 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mai20 }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{c.no_tim, }\DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an20)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mai20 ~ host * c.mal + host * c.no_art_5 + c.mal * 
##     c.no_tim, data = n1[n1$no_art_5 > 2 & n1$no_tim > 0, ])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.3788 -0.4707 -0.0875  0.3971  3.4183 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -0.06086    0.17739  -0.343 0.732602    
## host1             1.22800    0.32684   3.757 0.000359 ***
## c.mal             0.03294    0.43705   0.075 0.940145    
## c.no_art_5       -0.01297    0.01597  -0.812 0.419549    
## c.no_tim          0.02004    0.03276   0.612 0.542669    
## host1:c.mal       2.45150    0.77366   3.169 0.002295 ** 
## host1:c.no_art_5 -0.06586    0.03606  -1.826 0.072183 .  
## c.mal:c.no_tim    0.33483    0.12413   2.698 0.008801 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.9683 on 68 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.2636, Adjusted R-squared:  0.1878 
## F-statistic: 3.477 on 7 and 68 DF,  p-value: 0.003047
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an3 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mai3 }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal}\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{c.no_tim, }
          \DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mai3 ~ host * c.mal + host * c.no_art_5 + c.mal * 
##     c.no_tim, data = n1[n1$no_art_5 > 2 & n1$no_tim > 0, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.99069 -0.30888 -0.04333  0.22945  1.86612 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)       0.430309   0.088111   4.884 6.62e-06 ***
## host1            -0.325153   0.162341  -2.003 0.049177 *  
## c.mal             0.052570   0.217083   0.242 0.809381    
## c.no_art_5        0.045625   0.007934   5.750 2.31e-07 ***
## c.no_tim          0.006208   0.016271   0.382 0.703982    
## host1:c.mal      -0.685410   0.384281  -1.784 0.078948 .  
## host1:c.no_art_5  0.032606   0.017913   1.820 0.073120 .  
## c.mal:c.no_tim   -0.212331   0.061654  -3.444 0.000986 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.4809 on 68 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.4951, Adjusted R-squared:  0.4432 
## F-statistic: 9.528 on 7 and 68 DF,  p-value: 3.449e-08
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an5 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mai5 }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{c.no_tim,}
          \DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an5)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mai5 ~ host * c.mal + host * c.no_art_5 + c.mal * 
##     c.no_tim, data = n1[n1$no_art_5 > 2 & n1$no_tim > 0, ])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.5089 -0.2210 -0.0606  0.1439  1.4043 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)       0.372524   0.063327   5.883 1.36e-07 ***
## host1            -0.142429   0.116677  -1.221  0.22641    
## c.mal             0.050260   0.156021   0.322  0.74834    
## c.no_art_5        0.038731   0.005703   6.792 3.36e-09 ***
## c.no_tim          0.007836   0.011694   0.670  0.50508    
## host1:c.mal      -0.316361   0.276189  -1.145  0.25604    
## host1:c.no_art_5  0.021021   0.012874   1.633  0.10713    
## c.mal:c.no_tim   -0.147959   0.044311  -3.339  0.00137 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3457 on 68 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.558,  Adjusted R-squared:  0.5125 
## F-statistic: 12.27 on 7 and 68 DF,  p-value: 4.965e-10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an7 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mai7 }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{c.no_tim,}
          \DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an7)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mai7 ~ host * c.mal + host * c.no_art_5 + c.mal * 
##     c.no_tim, data = n1[n1$no_art_5 > 2 & n1$no_tim > 0, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.38411 -0.15051 -0.05102  0.08080  0.94254 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)       0.314740   0.044738   7.035 1.23e-09 ***
## host1             0.040294   0.082429   0.489  0.62653    
## c.mal             0.047951   0.110224   0.435  0.66492    
## c.no_art_5        0.031837   0.004029   7.903 3.29e-11 ***
## c.no_tim          0.009464   0.008262   1.145  0.25602    
## host1:c.mal       0.052687   0.195119   0.270  0.78796    
## host1:c.no_art_5  0.009436   0.009095   1.037  0.30318    
## c.mal:c.no_tim   -0.083587   0.031305  -2.670  0.00948 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2442 on 68 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.623,  Adjusted R-squared:  0.5842 
## F-statistic: 16.05 on 7 and 68 DF,  p-value: 2.902e-12
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an8 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mai8 }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{c.no_tim,}
          \DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an8)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mai8 ~ host * c.mal + host * c.no_art_5 + c.mal * 
##     c.no_tim, data = n1[n1$no_art_5 > 2 & n1$no_tim > 0, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.33478 -0.16438 -0.03142  0.10841  0.74215 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)       0.285848   0.040637   7.034 1.23e-09 ***
## host1             0.131656   0.074872   1.758   0.0832 .  
## c.mal             0.046796   0.100119   0.467   0.6417    
## c.no_art_5        0.028390   0.003659   7.758 6.02e-11 ***
## c.no_tim          0.010277   0.007504   1.370   0.1753    
## host1:c.mal       0.237211   0.177231   1.338   0.1852    
## host1:c.no_art_5  0.003644   0.008261   0.441   0.6606    
## c.mal:c.no_tim   -0.051401   0.028435  -1.808   0.0751 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2218 on 68 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.6229, Adjusted R-squared:  0.584 
## F-statistic: 16.04 on 7 and 68 DF,  p-value: 2.933e-12
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an9 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mai9 }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{c.no_tim,}
          \DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an9)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mai9 ~ host * c.mal + host * c.no_art_5 + c.mal * 
##     c.no_tim, data = n1[n1$no_art_5 > 2 & n1$no_tim > 0, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.38322 -0.15543 -0.04908  0.11741  0.70110 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)       0.256956   0.041681   6.165 4.37e-08 ***
## host1             0.223018   0.076796   2.904  0.00496 ** 
## c.mal             0.045641   0.102692   0.444  0.65813    
## c.no_art_5        0.024943   0.003753   6.646 6.13e-09 ***
## c.no_tim          0.011091   0.007697   1.441  0.15418    
## host1:c.mal       0.421735   0.181785   2.320  0.02335 *  
## host1:c.no_art_5 -0.002149   0.008474  -0.254  0.80060    
## c.mal:c.no_tim   -0.019215   0.029165  -0.659  0.51222    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2275 on 68 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.5745, Adjusted R-squared:  0.5307 
## F-statistic: 13.12 on 7 and 68 DF,  p-value: 1.461e-10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an10 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mai10 }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{c.no_tim,}
           \DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an10)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mai10 ~ host * c.mal + host * c.no_art_5 + c.mal * 
##     c.no_tim, data = n1[n1$no_art_5 > 2 & n1$no_tim > 0, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.45265 -0.16372 -0.05317  0.14843  0.82478 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)       0.228063   0.047533   4.798 9.13e-06 ***
## host1             0.314380   0.087578   3.590  0.00062 ***
## c.mal             0.044486   0.117110   0.380  0.70523    
## c.no_art_5        0.021497   0.004280   5.022 3.93e-06 ***
## c.no_tim          0.011905   0.008778   1.356  0.17950    
## host1:c.mal       0.606259   0.207308   2.924  0.00468 ** 
## host1:c.no_art_5 -0.007941   0.009663  -0.822  0.41409    
## c.mal:c.no_tim    0.012971   0.033260   0.390  0.69778    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2595 on 68 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.4891, Adjusted R-squared:  0.4365 
## F-statistic:   9.3 on 7 and 68 DF,  p-value: 5.018e-08
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an18 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mai18 }\OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{c.no_tim,}
           \DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an18)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mai18 ~ host * c.mal + host * c.no_art_5 + c.mal * 
##     c.no_tim, data = n1[n1$no_art_5 > 2 & n1$no_tim > 0, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.98226 -0.39681 -0.08116  0.33437  2.89961 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -0.003074   0.148785  -0.021 0.983578    
## host1             1.045274   0.274130   3.813 0.000298 ***
## c.mal             0.035248   0.366569   0.096 0.923679    
## c.no_art_5       -0.006079   0.013398  -0.454 0.651466    
## c.no_tim          0.018416   0.027476   0.670 0.504960    
## host1:c.mal       2.082452   0.648900   3.209 0.002032 ** 
## host1:c.no_art_5 -0.054280   0.030247  -1.795 0.077173 .  
## c.mal:c.no_tim    0.270458   0.104109   2.598 0.011491 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.8121 on 68 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.2619, Adjusted R-squared:  0.1859 
## F-statistic: 3.446 on 7 and 68 DF,  p-value: 0.00325
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# predictions on Adenostoma}
\NormalTok{pred.slope <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an.s1, }\DataTypeTok{newdata=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{host=}\StringTok{"A"}\NormalTok{, }\DataTypeTok{c.mal=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\NormalTok{.}\DecValTok{5}\NormalTok{, .}\DecValTok{5}\NormalTok{), }\DataTypeTok{c.no_art_5=}\DecValTok{0}\NormalTok{, }\DataTypeTok{c.no_tim=}\DecValTok{0}\NormalTok{, }\DataTypeTok{c.con_art5=}\DecValTok{0}\NormalTok{), }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{) }\CommentTok{# changed an.s for an.s1}
\NormalTok{pred.int <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an1, }\DataTypeTok{newdata=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{host=}\StringTok{"A"}\NormalTok{, }\DataTypeTok{c.mal=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\NormalTok{.}\DecValTok{5}\NormalTok{, .}\DecValTok{5}\NormalTok{), }\DataTypeTok{c.no_art_5=}\DecValTok{0}\NormalTok{, }\DataTypeTok{c.no_tim=}\DecValTok{0}\NormalTok{, }\DataTypeTok{c.con_art5=}\DecValTok{0}\NormalTok{), }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{pred.int20 <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an20, }\DataTypeTok{newdata=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{host=}\StringTok{"A"}\NormalTok{, }\DataTypeTok{c.mal=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\NormalTok{.}\DecValTok{5}\NormalTok{, .}\DecValTok{5}\NormalTok{), }\DataTypeTok{c.no_art_5=}\DecValTok{0}\NormalTok{, }\DataTypeTok{c.no_tim=}\DecValTok{0}\NormalTok{, }\DataTypeTok{c.con_art5=}\DecValTok{0}\NormalTok{), }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{)}

\CommentTok{# predictions on Ceanothus}
\NormalTok{pred.slope <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an.s1, }\DataTypeTok{newdata=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{host=}\StringTok{"C"}\NormalTok{, }\DataTypeTok{c.mal=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\NormalTok{.}\DecValTok{5}\NormalTok{, .}\DecValTok{5}\NormalTok{), }\DataTypeTok{c.no_art_5=}\DecValTok{0}\NormalTok{, }\DataTypeTok{c.no_tim=}\DecValTok{0}\NormalTok{, }\DataTypeTok{c.con_art5=}\DecValTok{0}\NormalTok{), }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{) }\CommentTok{# changed an.s for an.s1}
\NormalTok{pred.int <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an1, }\DataTypeTok{newdata=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{host=}\StringTok{"C"}\NormalTok{, }\DataTypeTok{c.mal=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\NormalTok{.}\DecValTok{5}\NormalTok{, .}\DecValTok{5}\NormalTok{), }\DataTypeTok{c.no_art_5=}\DecValTok{0}\NormalTok{, }\DataTypeTok{c.no_tim=}\DecValTok{0}\NormalTok{, }\DataTypeTok{c.con_art5=}\DecValTok{0}\NormalTok{), }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{pred.int20 <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an20, }\DataTypeTok{newdata=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{host=}\StringTok{"C"}\NormalTok{, }\DataTypeTok{c.mal=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\NormalTok{.}\DecValTok{5}\NormalTok{, .}\DecValTok{5}\NormalTok{), }\DataTypeTok{c.no_art_5=}\DecValTok{0}\NormalTok{, }\DataTypeTok{c.no_tim=}\DecValTok{0}\NormalTok{), }\DataTypeTok{c.con_art5=}\DecValTok{0}\NormalTok{, }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{)}

\CommentTok{# partial r-sq}
\NormalTok{an.s2 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an.s2) }\CommentTok{# R-sq = 18.4 %}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mas ~ c.mal + c.no_art_5, data = n1[n1$no_art_5 > 
##     2 & n1$no_tim > 0 & n1$host == "A", ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.62088 -0.20001  0.03397  0.15980  0.85752 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -0.40958    0.10117  -4.048 0.000536 ***
## c.mal        0.18082    0.21821   0.829 0.416207    
## c.no_art_5  -0.04825    0.01169  -4.127 0.000443 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3531 on 22 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.4409, Adjusted R-squared:  0.3901 
## F-statistic: 8.675 on 2 and 22 DF,  p-value: 0.001668
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1.p <-}\StringTok{ }\NormalTok{n1[}\KeywordTok{complete.cases}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mas, n1}\OperatorTok{$}\NormalTok{c.mal,n1}\OperatorTok{$}\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{), ]}

\CommentTok{# to drop levels properly, keep vars of interest}
\NormalTok{n1.p <-}\StringTok{ }\NormalTok{n1.p[,}\KeywordTok{c}\NormalTok{(}\StringTok{"c.no_art_5"}\NormalTok{, }\StringTok{"c.mal"}\NormalTok{, }\StringTok{"no_tim"}\NormalTok{, }\StringTok{"host"}\NormalTok{, }\StringTok{"no_art_5"}\NormalTok{, }\StringTok{"mas"}\NormalTok{)]}

\NormalTok{an.mas.art <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1.p[(n1.p}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1.p}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1.p}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{), ])}
\NormalTok{an.mas.mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal, }\DataTypeTok{data=}\NormalTok{n1.p[(n1.p}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1.p}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1.p}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{), ])}
\NormalTok{an.mal.art <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(c.mal }\OperatorTok{~}\StringTok{ }\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1.p[(n1.p}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1.p}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1.p}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{), ])}
\NormalTok{an.art.mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(c.no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal, }\DataTypeTok{data=}\NormalTok{n1.p[(n1.p}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1.p}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1.p}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{), ])}

\NormalTok{r.mas <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.mas.art)}
\NormalTok{r.mal <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.mal.art)}
\NormalTok{r.art <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.art.mal)}

\NormalTok{an.p_mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(r.mas }\OperatorTok{~}\StringTok{ }\NormalTok{r.mal)}
\KeywordTok{summary}\NormalTok{(an.p_mal) }\CommentTok{# r-sq = 0% on Adenostoma}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = r.mas ~ r.mal)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.62088 -0.20001  0.03397  0.15980  0.85752 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)
## (Intercept) 9.661e-18  6.906e-02   0.000    1.000
## r.mal       1.808e-01  2.134e-01   0.847    0.406
## 
## Residual standard error: 0.3453 on 23 degrees of freedom
## Multiple R-squared:  0.03027,    Adjusted R-squared:  -0.0119 
## F-statistic: 0.7179 on 1 and 23 DF,  p-value: 0.4056
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an.p_art <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(r.mal}\OperatorTok{~}\StringTok{ }\NormalTok{r.art)}
\KeywordTok{summary}\NormalTok{(an.p_art) }\CommentTok{# r-sq = 7% on Adenostoma}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = r.mal ~ r.art)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.2155 -0.2155 -0.2155  0.1664  0.6756 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)
## (Intercept) -3.913e-18  6.370e-02   0.000    1.000
## r.art       -1.768e-02  1.055e-02  -1.676    0.107
## 
## Residual standard error: 0.3185 on 23 degrees of freedom
## Multiple R-squared:  0.1089, Adjusted R-squared:  0.07012 
## F-statistic:  2.81 on 1 and 23 DF,  p-value: 0.1072
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{pdf}\NormalTok{(}\DataTypeTok{file=}\StringTok{"figures/mas_curves_by_mal4A.pdf"}\NormalTok{)}

\KeywordTok{plot}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{19}\NormalTok{), }\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{), }\DataTypeTok{type=}\StringTok{"n"}\NormalTok{, }\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}
     \DataTypeTok{xlab=}\StringTok{"rank log biomass"}\NormalTok{, }\DataTypeTok{ylab=}\StringTok{"log abundance"}\NormalTok{, }\DataTypeTok{axes=}\OtherTok{FALSE}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DataTypeTok{at=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{9}\NormalTok{, }\DecValTok{14}\NormalTok{, }\DecValTok{19}\NormalTok{), }\DataTypeTok{labels=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{20}\NormalTok{))}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DataTypeTok{at=}\KeywordTok{seq}\NormalTok{(}\OperatorTok{-}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DataTypeTok{by=}\NormalTok{.}\DecValTok{5}\NormalTok{), }
     \DataTypeTok{labels=}\KeywordTok{c}\NormalTok{(}\StringTok{"-1"}\NormalTok{, }\StringTok{""}\NormalTok{, }\StringTok{"0"}\NormalTok{, }\StringTok{""}\NormalTok{, }\StringTok{"1"}\NormalTok{, }\StringTok{""}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{""}\NormalTok{, }\StringTok{"3"}\NormalTok{), }\DataTypeTok{las=}\DecValTok{1}\NormalTok{)}

\CommentTok{# lines(x=c(0, 19), y=c(pred.int$fit[1]-pred.int$se.fit[1], }
\CommentTok{#                       pred.int20$fit[1]+pred.int$se.fit[1]),}
\CommentTok{#       col="blue", lty=2)}
\CommentTok{# lines(x=c(0, 19), y=c(pred.int$fit[1]+pred.int$se.fit[1], }
\CommentTok{#                       pred.int20$fit[1]-pred.int$se.fit[1]),}
\CommentTok{#       col="blue", lty=2)}

\KeywordTok{polygon}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{19}\NormalTok{, }\DecValTok{19}\NormalTok{), }\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(pred.int}\OperatorTok{$}\NormalTok{fit[}\DecValTok{1}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{pred.int}\OperatorTok{$}\NormalTok{se.fit[}\DecValTok{1}\NormalTok{], }
\NormalTok{                               pred.int}\OperatorTok{$}\NormalTok{fit[}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\StringTok{ }\NormalTok{pred.int}\OperatorTok{$}\NormalTok{se.fit[}\DecValTok{1}\NormalTok{], }
\NormalTok{                               pred.int20}\OperatorTok{$}\NormalTok{fit[}\DecValTok{1}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{pred.int20}\OperatorTok{$}\NormalTok{se.fit[}\DecValTok{1}\NormalTok{], }
\NormalTok{                               pred.int20}\OperatorTok{$}\NormalTok{fit[}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\StringTok{ }\NormalTok{pred.int20}\OperatorTok{$}\NormalTok{se.fit[}\DecValTok{1}\NormalTok{]), }
        \DataTypeTok{lwd=}\NormalTok{.}\DecValTok{5}\NormalTok{, }\DataTypeTok{col=}\StringTok{"blue"}\NormalTok{, }\DataTypeTok{density=}\DecValTok{150}\NormalTok{)}

\KeywordTok{lines}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{19}\NormalTok{), }\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(pred.int}\OperatorTok{$}\NormalTok{fit[}\DecValTok{1}\NormalTok{], pred.int20}\OperatorTok{$}\NormalTok{fit[}\DecValTok{1}\NormalTok{]),}
      \DataTypeTok{col=}\StringTok{"blue"}\NormalTok{, }\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}

\CommentTok{# lines(x=c(0, 19), y=c(pred.int$fit[2]-pred.int$se.fit[2], }
\CommentTok{#                       pred.int20$fit[2]+pred.int$se.fit[2]),}
\CommentTok{#       col="red", lty=2)}
\CommentTok{# lines(x=c(0, 19), y=c(pred.int$fit[2]+pred.int$se.fit[2], }
\CommentTok{#                       pred.int20$fit[2]-pred.int$se.fit[2]),}
\CommentTok{#       col="red", lty=2)}

\KeywordTok{polygon}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{19}\NormalTok{, }\DecValTok{19}\NormalTok{), }\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(pred.int}\OperatorTok{$}\NormalTok{fit[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{pred.int}\OperatorTok{$}\NormalTok{se.fit[}\DecValTok{2}\NormalTok{], }
\NormalTok{                               pred.int}\OperatorTok{$}\NormalTok{fit[}\DecValTok{2}\NormalTok{] }\OperatorTok{+}\StringTok{ }\NormalTok{pred.int}\OperatorTok{$}\NormalTok{se.fit[}\DecValTok{2}\NormalTok{], }
\NormalTok{                               pred.int20}\OperatorTok{$}\NormalTok{fit[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{pred.int20}\OperatorTok{$}\NormalTok{se.fit[}\DecValTok{2}\NormalTok{], }
\NormalTok{                               pred.int20}\OperatorTok{$}\NormalTok{fit[}\DecValTok{2}\NormalTok{] }\OperatorTok{+}\StringTok{ }\NormalTok{pred.int20}\OperatorTok{$}\NormalTok{se.fit[}\DecValTok{2}\NormalTok{]), }
        \DataTypeTok{lwd=}\NormalTok{.}\DecValTok{5}\NormalTok{, }\DataTypeTok{col=}\StringTok{"red"}\NormalTok{, }\DataTypeTok{density=}\DecValTok{150}\NormalTok{)}

\KeywordTok{lines}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{19}\NormalTok{), }\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(pred.int}\OperatorTok{$}\NormalTok{fit[}\DecValTok{2}\NormalTok{], pred.int20}\OperatorTok{$}\NormalTok{fit[}\DecValTok{2}\NormalTok{]),}
      \DataTypeTok{col=}\StringTok{"red"}\NormalTok{, }\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}

\KeywordTok{abline}\NormalTok{(}\DataTypeTok{v=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{8}\NormalTok{), }\DataTypeTok{lty=}\DecValTok{2}\NormalTok{, }\DataTypeTok{lwd=}\DecValTok{1}\NormalTok{, }\DataTypeTok{col=}\StringTok{"darkgreen"}\NormalTok{)}

\KeywordTok{legend}\NormalTok{(}\DecValTok{3}\NormalTok{, }\FloatTok{2.5}\NormalTok{, }\DataTypeTok{legend=}\KeywordTok{c}\NormalTok{(}\StringTok{"maladapted"}\NormalTok{, }\StringTok{"well adapted"}\NormalTok{), }\DataTypeTok{fill=}\KeywordTok{c}\NormalTok{(}\StringTok{"red"}\NormalTok{, }\StringTok{"blue"}\NormalTok{), }
       \DataTypeTok{bty=}\StringTok{"n"}\NormalTok{, }\DataTypeTok{cex=}\NormalTok{.}\DecValTok{9}\NormalTok{)}

\KeywordTok{arrows}\NormalTok{(}\DataTypeTok{x0=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{8}\NormalTok{), }\DataTypeTok{x1=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{11}\NormalTok{), }\DataTypeTok{y0=}\KeywordTok{c}\NormalTok{(}\FloatTok{0.075}\NormalTok{, }\FloatTok{0.5}\NormalTok{), }\DataTypeTok{y1=}\KeywordTok{c}\NormalTok{(}\FloatTok{0.075}\NormalTok{, }\FloatTok{0.5}\NormalTok{), }\DataTypeTok{length=}\NormalTok{.}\DecValTok{1}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FloatTok{9.25}\NormalTok{), }\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(}\FloatTok{0.2}\NormalTok{, .}\DecValTok{6}\NormalTok{), }\DataTypeTok{labels=}\KeywordTok{c}\NormalTok{(}\StringTok{"p < 0.05"}\NormalTok{, }\StringTok{"p < 0.05"}\NormalTok{), }\DataTypeTok{cex=}\FloatTok{0.85}\NormalTok{)}

\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}

\NormalTok{an1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{c.mal}\OperatorTok{*}\NormalTok{host, }\DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{mas}\OperatorTok{<}\FloatTok{0.6} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{5}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mas ~ no_art_5 + c.mal * host, data = n1[n1$mas < 
##     0.6 & n1$no_art_5 > 5, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.54968 -0.17396 -0.06562  0.16417  1.00561 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -0.29509    0.10174  -2.900  0.00538 ** 
## no_art_5    -0.02844    0.00529  -5.376 1.67e-06 ***
## c.mal        0.07591    0.19195   0.395  0.69406    
## host1       -0.28841    0.09800  -2.943  0.00478 ** 
## c.mal:host1  0.20087    0.26738   0.751  0.45577    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3186 on 54 degrees of freedom
##   (12 observations deleted due to missingness)
## Multiple R-squared:  0.4593, Adjusted R-squared:  0.4193 
## F-statistic: 11.47 on 4 and 54 DF,  p-value: 8.242e-07
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1)}
\KeywordTok{summary}\NormalTok{(an1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mas ~ no_art_5, data = n1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.63760 -0.20930 -0.06227  0.17180  1.12303 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -0.37902    0.04887  -7.755 6.00e-12 ***
## no_art_5    -0.03222    0.00368  -8.755 3.75e-14 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3261 on 105 degrees of freedom
##   (39 observations deleted due to missingness)
## Multiple R-squared:  0.422,  Adjusted R-squared:  0.4165 
## F-statistic: 76.66 on 1 and 105 DF,  p-value: 3.748e-14
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mas[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{5}\NormalTok{] }\OperatorTok{~}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5}\NormalTok{[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{5}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/Drivers of MAS-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nfds.stats <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{nrow =} \DecValTok{7}\NormalTok{, }\DataTypeTok{ncol=}\DecValTok{12}\NormalTok{))}

\CommentTok{# Timema abundance}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{6}\NormalTok{) \{}
  
\NormalTok{an.tim <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{~}\StringTok{ }\NormalTok{n1[[}\DecValTok{189} \OperatorTok{+}\StringTok{ }\NormalTok{i]] }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{con_tim,}
             \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1,}
             \DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{4}\NormalTok{)}
\NormalTok{nfds.stats[}\DecValTok{1}\NormalTok{, }\KeywordTok{c}\NormalTok{(}\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{i }\OperatorTok{-}\StringTok{ }\DecValTok{1}\NormalTok{, }\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{i)] <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(an.tim)}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{, }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{)]}

\NormalTok{\}}

\CommentTok{# arthropod abundance}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{6}\NormalTok{) \{}
  
\NormalTok{an.art <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{n1[[}\DecValTok{189}\OperatorTok{+}\NormalTok{i]] }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{c.con_art5}\OperatorTok{*}\NormalTok{n1}\OperatorTok{$}\NormalTok{host,}
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\NormalTok{nfds.stats[}\DecValTok{2}\NormalTok{, }\KeywordTok{c}\NormalTok{(}\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{i }\OperatorTok{-}\StringTok{ }\DecValTok{1}\NormalTok{, }\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{i)] <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(an.art)}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{, }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{)]}

\NormalTok{\}}

\CommentTok{# arthropod richness}
\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{6}\NormalTok{) \{}

\NormalTok{an.rich <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(n1}\OperatorTok{$}\NormalTok{rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{*}\StringTok{ }\NormalTok{n1[[}\DecValTok{189}\OperatorTok{+}\NormalTok{i]] }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{cn2 }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{*}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{c.con_art5, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1)}
\NormalTok{nfds.stats[}\DecValTok{3}\OperatorTok{:}\DecValTok{4}\NormalTok{, }\KeywordTok{c}\NormalTok{(}\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{i }\OperatorTok{-}\StringTok{ }\DecValTok{1}\NormalTok{, }\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{i)] <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(an.rich)}\OperatorTok{$}\NormalTok{coefficients[}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{7}\NormalTok{), }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{)]}

\NormalTok{\}}

\CommentTok{# Mass-abundance}

\KeywordTok{contrasts}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{6}\NormalTok{) \{}
  
\NormalTok{an.mas <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mas }\OperatorTok{~}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{*}\StringTok{ }\NormalTok{n1[[}\DecValTok{189} \OperatorTok{+}\StringTok{ }\NormalTok{i]] }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{*}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{c.no_art_}\DecValTok{5} \OperatorTok{+}\StringTok{ }\NormalTok{n1[[}\DecValTok{189} \OperatorTok{+}\StringTok{ }\NormalTok{i]] }\OperatorTok{*}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{c.no_tim }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{c.con_art5, }\DataTypeTok{data=}\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, ])}
\NormalTok{nfds.stats[}\DecValTok{5}\OperatorTok{:}\DecValTok{6}\NormalTok{, }\KeywordTok{c}\NormalTok{(}\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{i }\OperatorTok{-}\StringTok{ }\DecValTok{1}\NormalTok{, }\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{i)] <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(an.mas)}\OperatorTok{$}\NormalTok{coefficients[}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{7}\NormalTok{), }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{)]}

\NormalTok{\}}

\CommentTok{# carbon - nitrogen}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{6}\NormalTok{) \{}
  
\NormalTok{an.cn <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(n1}\OperatorTok{$}\NormalTok{cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{n1[[}\DecValTok{189} \OperatorTok{+}\StringTok{ }\NormalTok{i]] }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\NormalTok{nfds.stats[}\DecValTok{7}\NormalTok{, }\KeywordTok{c}\NormalTok{(}\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{i }\OperatorTok{-}\StringTok{ }\DecValTok{1}\NormalTok{, }\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{i)] <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(an.cn)}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{, }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{)]}
  
\NormalTok{\}}

\NormalTok{nfds.stats}\OperatorTok{$}\NormalTok{term <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"mal"}\NormalTok{, }\StringTok{"mal"}\NormalTok{, }\StringTok{"mal"}\NormalTok{, }\StringTok{"mal * host"}\NormalTok{, }\StringTok{"mal"}\NormalTok{, }\StringTok{"mal * host"}\NormalTok{, }\StringTok{"mal"}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(nfds.stats) <-}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"b"}\NormalTok{, }\StringTok{"p"}\NormalTok{), }\DecValTok{6}\NormalTok{)}
\KeywordTok{write.csv}\NormalTok{(nfds.stats, }\DataTypeTok{file =} \StringTok{"data/nfds_stats.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Figures}\label{figures}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{jpeg}\NormalTok{(}\DataTypeTok{file=}\StringTok{"figures/n1_tim_mal.jpg"}\NormalTok{, }
     \DataTypeTok{width=}\DecValTok{750}\NormalTok{, }\DataTypeTok{height=}\DecValTok{750}\NormalTok{)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\KeywordTok{plot}\NormalTok{(}\DataTypeTok{y=}\KeywordTok{jitter}\NormalTok{(n1}\OperatorTok{$}\NormalTok{no_tim[n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{4}\NormalTok{], }\DecValTok{2}\NormalTok{), }
     \DataTypeTok{x=}\KeywordTok{jitter}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mal[n1}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{4}\NormalTok{], }\DecValTok{10}\NormalTok{), }
     \DataTypeTok{xlab=}\StringTok{"maladaptation"}\NormalTok{, }\DataTypeTok{ylab=}\StringTok{""}\NormalTok{, }
     \DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{17}\NormalTok{),}
     \DataTypeTok{las=}\DecValTok{1}\NormalTok{, }\DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }
     \DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{, }\DataTypeTok{cex.lab=}\FloatTok{1.5}\NormalTok{, }\DataTypeTok{cex.axis=}\FloatTok{1.5}\NormalTok{)}

\KeywordTok{title}\NormalTok{(}\DataTypeTok{ylab=}\KeywordTok{expression}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"T. cristinae"}\NormalTok{), }\StringTok{" abundance"}\NormalTok{)), }\DataTypeTok{cex.lab=}\FloatTok{1.5}\NormalTok{, }\DataTypeTok{line=}\FloatTok{3.5}\NormalTok{)}

\KeywordTok{axis.break}\NormalTok{(}\DataTypeTok{axis=}\DecValTok{2}\NormalTok{, }\DataTypeTok{breakpos=}\FloatTok{3.5}\NormalTok{)}

\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an2.f <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5}\OperatorTok{*}\NormalTok{host,}
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an2.f)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_art_5 ~ c.mal + ln.vol_cub + c.con_art5 * host, 
##     family = quasipoisson, data = n1, subset = no_tim > 0)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.6751  -1.6447  -0.7855   0.8684   7.8261  
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -2.594e+00  9.414e-01  -2.755  0.00714 ** 
## c.mal             4.999e-01  2.369e-01   2.110  0.03770 *  
## ln.vol_cub        4.316e-01  8.042e-02   5.367 6.55e-07 ***
## c.con_art5       -8.682e-05  2.590e-02  -0.003  0.99733    
## host1            -4.782e-01  2.173e-01  -2.200  0.03042 *  
## c.con_art5:host1  6.740e-02  3.701e-02   1.821  0.07201 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 5.346001)
## 
##     Null deviance: 652.94  on 92  degrees of freedom
## Residual deviance: 407.37  on 87  degrees of freedom
##   (1 observation deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an2.f1 <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5,}
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{host}\OperatorTok{==}\StringTok{ "C"}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an2.f1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = no_art_5 ~ c.mal + ln.vol_cub + c.con_art5, family = quasipoisson, 
##     data = n1, subset = no_tim > 0 & host == "C")
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.6270  -1.5586  -0.7073   0.7373   7.9524  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -3.05242    1.26538  -2.412   0.0189 *  
## c.mal        0.71362    0.34010   2.098   0.0401 *  
## ln.vol_cub   0.42820    0.09911   4.320 5.95e-05 ***
## c.con_art5   0.07210    0.02852   2.528   0.0141 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 6.078791)
## 
##     Null deviance: 512.65  on 63  degrees of freedom
## Residual deviance: 311.59  on 60  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1.}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\NormalTok{n1[}\KeywordTok{complete.cases}\NormalTok{(n1}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5}\NormalTok{, n1}\OperatorTok{$}\NormalTok{host, n1}\OperatorTok{$}\NormalTok{c.mal, n1}\OperatorTok{$}\NormalTok{ln.vol_cub, n1}\OperatorTok{$}\NormalTok{c.con_art5, n1}\OperatorTok{$}\NormalTok{no_tim), ]}
\NormalTok{res.art <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(}\KeywordTok{glm}\NormalTok{(no_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5}\OperatorTok{*}\NormalTok{host,}
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1.}\DecValTok{2}\NormalTok{, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{ ), }\StringTok{'deviance'}\NormalTok{)}
\NormalTok{res.mal <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(}\KeywordTok{lm}\NormalTok{(c.mal }\OperatorTok{~}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5}\OperatorTok{*}\NormalTok{host,}
           \DataTypeTok{data=}\NormalTok{n1.}\DecValTok{2}\NormalTok{, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{), }\StringTok{"pearson"}\NormalTok{)}

\NormalTok{an.res <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(res.art }\OperatorTok{~}\StringTok{ }\NormalTok{res.mal); }\KeywordTok{summary}\NormalTok{(an.res)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = res.art ~ res.mal)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4703 -1.3778 -0.3566  1.1054  7.9407 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)  
## (Intercept)  -0.2809     0.2192  -1.281   0.2033  
## res.mal       1.2042     0.6201   1.942   0.0552 .
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.114 on 91 degrees of freedom
## Multiple R-squared:  0.0398, Adjusted R-squared:  0.02925 
## F-statistic: 3.772 on 1 and 91 DF,  p-value: 0.05522
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nd=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{res.mal=}\KeywordTok{seq}\NormalTok{(}\KeywordTok{min}\NormalTok{(res.mal), }\KeywordTok{max}\NormalTok{(res.mal), }\DataTypeTok{len=}\DecValTok{50}\NormalTok{))}
\NormalTok{preds <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an.res, }\DataTypeTok{newdata=}\NormalTok{nd, }\DataTypeTok{type =} \StringTok{"response"}\NormalTok{, }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{nd}\OperatorTok{$}\NormalTok{fit <-}\StringTok{ }\NormalTok{preds}\OperatorTok{$}\NormalTok{fit}
\NormalTok{nd}\OperatorTok{$}\NormalTok{lower <-}\StringTok{ }\NormalTok{preds}\OperatorTok{$}\NormalTok{fit }\OperatorTok{-}\StringTok{ }\NormalTok{preds}\OperatorTok{$}\NormalTok{se.fit}
\NormalTok{nd}\OperatorTok{$}\NormalTok{upper <-}\StringTok{ }\NormalTok{preds}\OperatorTok{$}\NormalTok{fit }\OperatorTok{+}\StringTok{ }\NormalTok{preds}\OperatorTok{$}\NormalTok{se.fit}

\KeywordTok{jpeg}\NormalTok{(}\DataTypeTok{file=}\StringTok{"figures/n1_art_mal.jpg"}\NormalTok{, }
     \DataTypeTok{width=}\DecValTok{750}\NormalTok{, }\DataTypeTok{height=}\DecValTok{750}\NormalTok{)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\KeywordTok{plot}\NormalTok{(}\DataTypeTok{y=}\NormalTok{res.art, }\DataTypeTok{x=}\NormalTok{res.mal, }
     \DataTypeTok{xlab=}\StringTok{""}\NormalTok{, }\DataTypeTok{ylab=}\StringTok{""}\NormalTok{, }
     \DataTypeTok{las=}\DecValTok{1}\NormalTok{, }\DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }
     \DataTypeTok{cex=}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex.axis=}\DecValTok{2}\NormalTok{)}

\KeywordTok{title}\NormalTok{(}\DataTypeTok{ylab=}\StringTok{"arthropod abundance (residuals)"}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{, }\DataTypeTok{line=}\FloatTok{3.5}\NormalTok{)}
\KeywordTok{title}\NormalTok{(}\DataTypeTok{xlab=}\StringTok{"maladaptation (residuals)"}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{, }\DataTypeTok{line=}\FloatTok{4.5}\NormalTok{)}
\CommentTok{#axis.break(axis=2, breakpos=3.5)}

\KeywordTok{polygon}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(nd}\OperatorTok{$}\NormalTok{res.mal, }\KeywordTok{rev}\NormalTok{(nd}\OperatorTok{$}\NormalTok{res.mal)), }
        \DataTypeTok{y =} \KeywordTok{c}\NormalTok{(nd}\OperatorTok{$}\NormalTok{upper, }\KeywordTok{rev}\NormalTok{(nd}\OperatorTok{$}\NormalTok{lower)), }
        \DataTypeTok{col=}\StringTok{"grey"}\NormalTok{, }\DataTypeTok{density=}\DecValTok{100}\NormalTok{, }\DataTypeTok{lwd=}\NormalTok{.}\DecValTok{5}\NormalTok{)}

\KeywordTok{lines}\NormalTok{(nd}\OperatorTok{$}\NormalTok{res.mal, nd}\OperatorTok{$}\NormalTok{fit, }\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}

\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#lines(nd$res.mal, nd$upper, lty=2)}
\CommentTok{#lines(nd$res.mal, nd$lower, lty=2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an3.f <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{host}\OperatorTok{*}\NormalTok{c.con_art5, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1)}
\KeywordTok{summary}\NormalTok{(an3.f)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = rich_art_5 ~ host * c.mal + ln.vol_cub + host * 
##     c.con_art5, family = quasipoisson, data = n1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3865  -1.0153  -0.2121   0.7193   2.0200  
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -2.77989    0.63926  -4.349 3.75e-05 ***
## host1             0.02279    0.17607   0.129  0.89730    
## c.mal            -0.25980    0.33514  -0.775  0.44034    
## ln.vol_cub        0.35623    0.05413   6.581 3.51e-09 ***
## c.con_art5       -0.02600    0.02146  -1.212  0.22897    
## host1:c.mal       0.98839    0.39786   2.484  0.01492 *  
## host1:c.con_art5  0.08287    0.02862   2.896  0.00479 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.359015)
## 
##     Null deviance: 234.49  on 92  degrees of freedom
## Residual deviance: 122.51  on 86  degrees of freedom
##   (53 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1.}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\NormalTok{n1[}\KeywordTok{complete.cases}\NormalTok{(n1}\OperatorTok{$}\NormalTok{rich_art_}\DecValTok{5}\NormalTok{, n1}\OperatorTok{$}\NormalTok{c.mal, n1}\OperatorTok{$}\NormalTok{ln.vol_cub, n1}\OperatorTok{$}\NormalTok{c.con_art5), ]}

\CommentTok{# Adenostoma}
\NormalTok{an3.fA <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"A"}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an3.fA)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = rich_art_5 ~ c.mal + ln.vol_cub + c.con_art5, family = quasipoisson, 
##     data = n1, subset = host == "A")
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6979  -0.7854  -0.1862   0.5058   1.7825  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)   
## (Intercept) -2.76774    1.34874  -2.052  0.05077 . 
## c.mal       -0.25958    0.28588  -0.908  0.37255   
## ln.vol_cub   0.35518    0.11691   3.038  0.00551 **
## c.con_art5  -0.02596    0.01872  -1.387  0.17764   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 0.9827792)
## 
##     Null deviance: 35.823  on 28  degrees of freedom
## Residual deviance: 24.749  on 25  degrees of freedom
##   (44 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res.artA <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(}\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5,}
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1.}\DecValTok{2}\NormalTok{, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{host}\OperatorTok{==}\StringTok{"A"}\NormalTok{ ), }\StringTok{'deviance'}\NormalTok{)}
\NormalTok{res.malA <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(}\KeywordTok{lm}\NormalTok{(c.mal }\OperatorTok{~}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5,}
           \DataTypeTok{data=}\NormalTok{n1.}\DecValTok{2}\NormalTok{, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{host}\OperatorTok{==}\StringTok{"A"}\NormalTok{), }\StringTok{"working"}\NormalTok{)}

\NormalTok{an.resA <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(res.artA }\OperatorTok{~}\StringTok{ }\NormalTok{res.malA); }\KeywordTok{summary}\NormalTok{(an.resA)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = res.artA ~ res.malA)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.6110 -0.7195 -0.1231  0.5514  1.8781 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)
## (Intercept) -0.09272    0.17442  -0.532    0.599
## res.malA    -0.60915    0.46384  -1.313    0.200
## 
## Residual standard error: 0.9393 on 27 degrees of freedom
## Multiple R-squared:  0.06004,    Adjusted R-squared:  0.02523 
## F-statistic: 1.725 on 1 and 27 DF,  p-value: 0.2001
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ndA=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{res.malA=}\KeywordTok{seq}\NormalTok{(}\KeywordTok{min}\NormalTok{(res.malA), }\KeywordTok{max}\NormalTok{(res.malA), }\DataTypeTok{len=}\DecValTok{50}\NormalTok{))}
\NormalTok{predsA <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an.resA, }\DataTypeTok{newdata=}\NormalTok{ndA, }\DataTypeTok{type =} \StringTok{"response"}\NormalTok{, }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{ndA}\OperatorTok{$}\NormalTok{fit <-}\StringTok{ }\NormalTok{predsA}\OperatorTok{$}\NormalTok{fit}
\NormalTok{ndA}\OperatorTok{$}\NormalTok{lower <-}\StringTok{ }\NormalTok{predsA}\OperatorTok{$}\NormalTok{fit }\OperatorTok{-}\StringTok{ }\NormalTok{predsA}\OperatorTok{$}\NormalTok{se.fit}
\NormalTok{ndA}\OperatorTok{$}\NormalTok{upper <-}\StringTok{ }\NormalTok{predsA}\OperatorTok{$}\NormalTok{fit }\OperatorTok{+}\StringTok{ }\NormalTok{predsA}\OperatorTok{$}\NormalTok{se.fit}

\CommentTok{# Ceanothus}
\NormalTok{an3.fC <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5, }
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1, }\DataTypeTok{subset=}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(an3.fC)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = rich_art_5 ~ c.mal + ln.vol_cub + c.con_art5, family = quasipoisson, 
##     data = n1, subset = host == "C")
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3858  -1.1404  -0.2420   0.8255   2.0197  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -2.75955    0.79599  -3.467  0.00098 ***
## c.mal        0.72862    0.22775   3.199  0.00220 ** 
## ln.vol_cub   0.35643    0.06266   5.688 4.05e-07 ***
## c.con_art5   0.05688    0.01992   2.855  0.00590 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for quasipoisson family taken to be 1.538553)
## 
##     Null deviance: 184.732  on 63  degrees of freedom
## Residual deviance:  97.756  on 60  degrees of freedom
##   (9 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res.artC <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(}\KeywordTok{glm}\NormalTok{(rich_art_}\DecValTok{5} \OperatorTok{~}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5,}
           \DataTypeTok{family=}\NormalTok{quasipoisson, }\DataTypeTok{data=}\NormalTok{n1.}\DecValTok{2}\NormalTok{, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{ ), }\StringTok{'deviance'}\NormalTok{)}
\NormalTok{res.malC <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(}\KeywordTok{lm}\NormalTok{(c.mal }\OperatorTok{~}\StringTok{ }\NormalTok{ln.vol_cub }\OperatorTok{+}\StringTok{ }\NormalTok{c.con_art5,}
           \DataTypeTok{data=}\NormalTok{n1.}\DecValTok{2}\NormalTok{, }\DataTypeTok{subset =}\NormalTok{ no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{), }\StringTok{"working"}\NormalTok{)}

\NormalTok{an.resC <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(res.artC }\OperatorTok{~}\StringTok{ }\NormalTok{res.malC); }\KeywordTok{summary}\NormalTok{(an.resC)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = res.artC ~ res.malC)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.53433 -0.94271 -0.05687  1.10582  2.21744 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)   
## (Intercept)  -0.1589     0.1580  -1.006  0.31827   
## res.malC      1.3378     0.4632   2.888  0.00533 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.264 on 62 degrees of freedom
## Multiple R-squared:  0.1186, Adjusted R-squared:  0.1044 
## F-statistic: 8.342 on 1 and 62 DF,  p-value: 0.005327
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ndC=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{res.malC=}\KeywordTok{seq}\NormalTok{(}\KeywordTok{min}\NormalTok{(res.malC), }\KeywordTok{max}\NormalTok{(res.malC), }\DataTypeTok{len=}\DecValTok{50}\NormalTok{))}
\NormalTok{predsC <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an.resC, }\DataTypeTok{newdata=}\NormalTok{ndC, }\DataTypeTok{type =} \StringTok{"response"}\NormalTok{, }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{ndC}\OperatorTok{$}\NormalTok{fit <-}\StringTok{ }\NormalTok{predsC}\OperatorTok{$}\NormalTok{fit}
\NormalTok{ndC}\OperatorTok{$}\NormalTok{lower <-}\StringTok{ }\NormalTok{predsC}\OperatorTok{$}\NormalTok{fit }\OperatorTok{-}\StringTok{ }\NormalTok{predsC}\OperatorTok{$}\NormalTok{se.fit}
\NormalTok{ndC}\OperatorTok{$}\NormalTok{upper <-}\StringTok{ }\NormalTok{predsC}\OperatorTok{$}\NormalTok{fit }\OperatorTok{+}\StringTok{ }\NormalTok{predsC}\OperatorTok{$}\NormalTok{se.fit}

\KeywordTok{jpeg}\NormalTok{(}\DataTypeTok{file=}\StringTok{"figures/n1_rich_mal.jpg"}\NormalTok{, }
     \DataTypeTok{width=}\DecValTok{750}\NormalTok{, }\DataTypeTok{height=}\DecValTok{750}\NormalTok{)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\KeywordTok{plot}\NormalTok{(}\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(res.artA, res.artC), }\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(res.malA, res.malC), }
     \DataTypeTok{xlab=}\StringTok{""}\NormalTok{, }\DataTypeTok{ylab=}\StringTok{""}\NormalTok{, }
     \DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\KeywordTok{min}\NormalTok{(}\KeywordTok{c}\NormalTok{(res.artA, res.artC)), }\DecValTok{3}\NormalTok{),}
     \DataTypeTok{las=}\DecValTok{1}\NormalTok{, }\DataTypeTok{type=}\StringTok{"n"}\NormalTok{, }
     \DataTypeTok{cex=}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex.axis=}\DecValTok{2}\NormalTok{)}

\KeywordTok{title}\NormalTok{(}\DataTypeTok{ylab=}\StringTok{"arthropod richness (residuals)"}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{, }\DataTypeTok{line=}\FloatTok{3.5}\NormalTok{)}
\KeywordTok{title}\NormalTok{(}\DataTypeTok{xlab=}\StringTok{"maladaptation (residuals)"}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{, }\DataTypeTok{line=}\DecValTok{4}\NormalTok{)}
\CommentTok{#axis.break(axis=2, breakpos=3.5)}

\KeywordTok{points}\NormalTok{(}\DataTypeTok{y=}\NormalTok{res.artA, }\DataTypeTok{x=}\NormalTok{res.malA, }
       \DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }\DataTypeTok{col=}\StringTok{"blue"}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(}\DataTypeTok{y=}\NormalTok{res.artC, }\DataTypeTok{x=}\NormalTok{res.malC, }
       \DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }\DataTypeTok{col=}\StringTok{"orange"}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{2}\NormalTok{)}

\KeywordTok{polygon}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(ndC}\OperatorTok{$}\NormalTok{res.malC, }\KeywordTok{rev}\NormalTok{(ndC}\OperatorTok{$}\NormalTok{res.malC)), }
        \DataTypeTok{y =} \KeywordTok{c}\NormalTok{(ndC}\OperatorTok{$}\NormalTok{upper, }\KeywordTok{rev}\NormalTok{(ndC}\OperatorTok{$}\NormalTok{lower)), }
        \DataTypeTok{col=}\StringTok{"orange"}\NormalTok{, }\DataTypeTok{density=}\DecValTok{100}\NormalTok{, }\DataTypeTok{lwd=}\NormalTok{.}\DecValTok{5}\NormalTok{)}

\KeywordTok{lines}\NormalTok{(ndC}\OperatorTok{$}\NormalTok{res.malC, ndC}\OperatorTok{$}\NormalTok{fit, }\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{, }\DataTypeTok{col=}\StringTok{"orange"}\NormalTok{)}

\KeywordTok{legend}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\NormalTok{.}\DecValTok{5}\NormalTok{, }\DataTypeTok{y=}\DecValTok{3}\NormalTok{, }
       \DataTypeTok{legend=}\KeywordTok{c}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"C. spinosus"}\NormalTok{), }\KeywordTok{italic}\NormalTok{( }\StringTok{"A. fasciculatum"}\NormalTok{))), }
       \DataTypeTok{pch=}\KeywordTok{c}\NormalTok{(}\DecValTok{16}\NormalTok{, }\DecValTok{16}\NormalTok{), }\DataTypeTok{col=}\KeywordTok{c}\NormalTok{(}\StringTok{"orange"}\NormalTok{, }\StringTok{"blue"}\NormalTok{), }
       \DataTypeTok{bg=}\OtherTok{NULL}\NormalTok{, }\DataTypeTok{bty=}\StringTok{"n"}\NormalTok{, }\DataTypeTok{cex=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{), }\DataTypeTok{y.intersp =} \DecValTok{1}\NormalTok{)}

\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1.}\DecValTok{3}\NormalTok{ <-}\StringTok{ }\NormalTok{n1[}\KeywordTok{complete.cases}\NormalTok{(n1}\OperatorTok{$}\NormalTok{mas, n1}\OperatorTok{$}\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{, n1}\OperatorTok{$}\NormalTok{c.mal), ]}

\CommentTok{# Adenostoma}
\NormalTok{an.s2A <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1.}\DecValTok{3}\NormalTok{[n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an.s2A) }\CommentTok{# R-sq = 18.4 %}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mas ~ c.mal + c.no_art_5, data = n1.3[n1.3$no_art_5 > 
##     2 & n1.3$no_tim > 0 & n1.3$host == "A", ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.62088 -0.20001  0.03397  0.15980  0.85752 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -0.40958    0.10117  -4.048 0.000536 ***
## c.mal        0.18082    0.21821   0.829 0.416207    
## c.no_art_5  -0.04825    0.01169  -4.127 0.000443 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3531 on 22 degrees of freedom
## Multiple R-squared:  0.4409, Adjusted R-squared:  0.3901 
## F-statistic: 8.675 on 2 and 22 DF,  p-value: 0.001668
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an.mas.artA <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1.}\DecValTok{3}\NormalTok{[n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{, ])}
\NormalTok{an.mal.artA <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(c.mal }\OperatorTok{~}\StringTok{ }\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1.}\DecValTok{3}\NormalTok{[n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{, ])}

\NormalTok{res.masA <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.mas.artA)}
\NormalTok{res.malA <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.mal.artA)}

\NormalTok{an.p_malA <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(res.masA }\OperatorTok{~}\StringTok{ }\NormalTok{res.malA)}
\KeywordTok{summary}\NormalTok{(an.p_malA) }\CommentTok{# r-sq = 13.5! on Adenostoma}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = res.masA ~ res.malA)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.62088 -0.20001  0.03397  0.15980  0.85752 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)
## (Intercept) 9.661e-18  6.906e-02   0.000    1.000
## res.malA    1.808e-01  2.134e-01   0.847    0.406
## 
## Residual standard error: 0.3453 on 23 degrees of freedom
## Multiple R-squared:  0.03027,    Adjusted R-squared:  -0.0119 
## F-statistic: 0.7179 on 1 and 23 DF,  p-value: 0.4056
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ndA=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{res.malA=}\KeywordTok{seq}\NormalTok{(}\KeywordTok{min}\NormalTok{(res.malA), }\KeywordTok{max}\NormalTok{(res.malA), }\DataTypeTok{len=}\DecValTok{50}\NormalTok{))}
\NormalTok{predsA <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an.p_malA, }\DataTypeTok{newdata=}\NormalTok{ndA, }\DataTypeTok{type =} \StringTok{"response"}\NormalTok{, }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{ndA}\OperatorTok{$}\NormalTok{fit <-}\StringTok{ }\NormalTok{predsA}\OperatorTok{$}\NormalTok{fit}
\NormalTok{ndA}\OperatorTok{$}\NormalTok{lower <-}\StringTok{ }\NormalTok{predsA}\OperatorTok{$}\NormalTok{fit }\OperatorTok{-}\StringTok{ }\NormalTok{predsA}\OperatorTok{$}\NormalTok{se.fit}
\NormalTok{ndA}\OperatorTok{$}\NormalTok{upper <-}\StringTok{ }\NormalTok{predsA}\OperatorTok{$}\NormalTok{fit }\OperatorTok{+}\StringTok{ }\NormalTok{predsA}\OperatorTok{$}\NormalTok{se.fit}

\CommentTok{# Ceanothus}

\NormalTok{an.s2C <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{c.mal }\OperatorTok{+}\StringTok{ }\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{ , }\DataTypeTok{data=}\NormalTok{n1.}\DecValTok{3}\NormalTok{[n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "C"}\NormalTok{, ])}
\KeywordTok{summary}\NormalTok{(an.s2C) }\CommentTok{# R-sq = 18.4 %}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = mas ~ c.mal + c.no_art_5, data = n1.3[n1.3$no_art_5 > 
##     2 & n1.3$no_tim > 0 & n1.3$host == "C", ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.52193 -0.21290 -0.07037  0.18720  0.83286 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -0.720632   0.047085 -15.305  < 2e-16 ***
## c.mal        0.113283   0.129225   0.877    0.385    
## c.no_art_5  -0.029155   0.004516  -6.456 5.03e-08 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2882 on 48 degrees of freedom
## Multiple R-squared:  0.465,  Adjusted R-squared:  0.4427 
## F-statistic: 20.86 on 2 and 48 DF,  p-value: 3.025e-07
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{an.mas.artC <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(mas }\OperatorTok{~}\StringTok{ }\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1.}\DecValTok{3}\NormalTok{[n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "C"}\NormalTok{, ])}
\NormalTok{an.mal.artC <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(c.mal }\OperatorTok{~}\StringTok{ }\NormalTok{c.no_art_}\DecValTok{5}\NormalTok{, }\DataTypeTok{data=}\NormalTok{n1.}\DecValTok{3}\NormalTok{[n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_art_}\DecValTok{5} \OperatorTok{>}\StringTok{ }\DecValTok{2} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{no_tim }\OperatorTok{>}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{n1.}\DecValTok{3}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "C"}\NormalTok{, ])}

\NormalTok{res.masC <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.mas.artC)}
\NormalTok{res.malC <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.mal.artC)}

\NormalTok{an.resC <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(res.masC }\OperatorTok{~}\StringTok{ }\NormalTok{res.malC); }\KeywordTok{summary}\NormalTok{(an.resC)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = res.masC ~ res.malC)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.52193 -0.21290 -0.07037  0.18720  0.83286 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)
## (Intercept) 1.692e-17  3.994e-02   0.000     1.00
## res.malC    1.133e-01  1.279e-01   0.886     0.38
## 
## Residual standard error: 0.2852 on 49 degrees of freedom
## Multiple R-squared:  0.01576,    Adjusted R-squared:  -0.004329 
## F-statistic: 0.7845 on 1 and 49 DF,  p-value: 0.3801
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ndC=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{res.malC=}\KeywordTok{seq}\NormalTok{(}\KeywordTok{min}\NormalTok{(res.malC), }\KeywordTok{max}\NormalTok{(res.malC), }\DataTypeTok{len=}\DecValTok{50}\NormalTok{))}
\NormalTok{predsC <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an.resC, }\DataTypeTok{newdata=}\NormalTok{ndC, }\DataTypeTok{type =} \StringTok{"response"}\NormalTok{, }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{ndC}\OperatorTok{$}\NormalTok{fit <-}\StringTok{ }\NormalTok{predsC}\OperatorTok{$}\NormalTok{fit}
\NormalTok{ndC}\OperatorTok{$}\NormalTok{lower <-}\StringTok{ }\NormalTok{predsC}\OperatorTok{$}\NormalTok{fit }\OperatorTok{-}\StringTok{ }\NormalTok{predsC}\OperatorTok{$}\NormalTok{se.fit}
\NormalTok{ndC}\OperatorTok{$}\NormalTok{upper <-}\StringTok{ }\NormalTok{predsC}\OperatorTok{$}\NormalTok{fit }\OperatorTok{+}\StringTok{ }\NormalTok{predsC}\OperatorTok{$}\NormalTok{se.fit}

\KeywordTok{jpeg}\NormalTok{(}\DataTypeTok{file=}\StringTok{"figures/n1_mas_mal.jpg"}\NormalTok{, }
     \DataTypeTok{width=}\DecValTok{750}\NormalTok{, }\DataTypeTok{height=}\DecValTok{750}\NormalTok{)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\KeywordTok{plot}\NormalTok{(}\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(res.masA, res.masC),}
     \DataTypeTok{x=}\KeywordTok{c}\NormalTok{(res.malA, res.malC),}
     \DataTypeTok{xlab =} \StringTok{""}\NormalTok{, }
     \DataTypeTok{ylab =} \StringTok{""}\NormalTok{, }
     \DataTypeTok{las=}\DecValTok{1}\NormalTok{, }\DataTypeTok{type=}\StringTok{"n"}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex.axis=}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{2}\NormalTok{)}

\KeywordTok{title}\NormalTok{(}\DataTypeTok{ylab=}\StringTok{"mass-abundance slope (residuals)"}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{, }\DataTypeTok{line=}\FloatTok{4.5}\NormalTok{)}
\KeywordTok{title}\NormalTok{(}\DataTypeTok{xlab=}\StringTok{"maladaptation (residuals)"}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{, }\DataTypeTok{line=}\DecValTok{4}\NormalTok{)}

\KeywordTok{points}\NormalTok{(}\DataTypeTok{y=}\NormalTok{res.masC, }\DataTypeTok{x=}\NormalTok{res.malC, }
       \DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }\DataTypeTok{col=}\StringTok{"orange"}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(}\DataTypeTok{y=}\NormalTok{res.masA, }\DataTypeTok{x=}\NormalTok{res.malA, }
       \DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }\DataTypeTok{col=}\StringTok{"blue"}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{2}\NormalTok{)}


\CommentTok{#lines(nd$res.mal, nd$upper, lty=2)}
\CommentTok{#lines(nd$res.mal, nd$lower, lty=2)}

\KeywordTok{polygon}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(ndA}\OperatorTok{$}\NormalTok{res.malA, }\KeywordTok{rev}\NormalTok{(ndA}\OperatorTok{$}\NormalTok{res.malA)), }
        \DataTypeTok{y =} \KeywordTok{c}\NormalTok{(ndA}\OperatorTok{$}\NormalTok{upper, }\KeywordTok{rev}\NormalTok{(ndA}\OperatorTok{$}\NormalTok{lower)), }
        \DataTypeTok{col=}\StringTok{"blue"}\NormalTok{, }\DataTypeTok{density=}\DecValTok{50}\NormalTok{, }\DataTypeTok{lwd=}\NormalTok{.}\DecValTok{5}\NormalTok{, }\DataTypeTok{border=}\OtherTok{NA}\NormalTok{)}

\KeywordTok{lines}\NormalTok{(ndA}\OperatorTok{$}\NormalTok{res.malA, ndA}\OperatorTok{$}\NormalTok{fit,}
      \DataTypeTok{col=}\StringTok{"blue"}\NormalTok{, }\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}

\KeywordTok{legend}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\NormalTok{.}\DecValTok{5}\NormalTok{, }\DataTypeTok{y=}\NormalTok{.}\DecValTok{35}\NormalTok{, }
       \DataTypeTok{legend=}\KeywordTok{c}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"C. spinosus"}\NormalTok{), }\KeywordTok{italic}\NormalTok{( }\StringTok{"A. fasciculatum"}\NormalTok{))), }
       \DataTypeTok{pch=}\KeywordTok{c}\NormalTok{(}\DecValTok{16}\NormalTok{, }\DecValTok{16}\NormalTok{), }\DataTypeTok{col=}\KeywordTok{c}\NormalTok{(}\StringTok{"orange"}\NormalTok{, }\StringTok{"blue"}\NormalTok{), }
       \DataTypeTok{bg=}\OtherTok{NULL}\NormalTok{, }\DataTypeTok{bty=}\StringTok{"n"}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{2}\NormalTok{, }\DataTypeTok{y.intersp =} \DecValTok{1}\NormalTok{)}

\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p.n1 <-}\StringTok{ }\NormalTok{n1[}\KeywordTok{complete.cases}\NormalTok{(n1}\OperatorTok{$}\NormalTok{host, n1}\OperatorTok{$}\NormalTok{c.mal, n1}\OperatorTok{$}\NormalTok{cn2) }\OperatorTok{&}\StringTok{ }\NormalTok{n1}\OperatorTok{$}\NormalTok{pN }\OperatorTok{<}\StringTok{ }\DecValTok{1}\NormalTok{, ]}
\NormalTok{p.n1}\OperatorTok{$}\NormalTok{c.host <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(p.n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{, }\OperatorTok{-}\NormalTok{.}\DecValTok{5}\NormalTok{, .}\DecValTok{5}\NormalTok{)}

\NormalTok{an.mal <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(c.mal }\OperatorTok{~}\StringTok{ }\NormalTok{c.host, }\DataTypeTok{data=}\NormalTok{p.n1)}
\NormalTok{an.cn_h <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{c.host, }\DataTypeTok{data=}\NormalTok{p.n1)}

\NormalTok{r.mal <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.mal)}
\NormalTok{r.cn_h <-}\StringTok{ }\KeywordTok{resid}\NormalTok{(an.cn_h)}

\NormalTok{an.res <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(r.cn_h }\OperatorTok{~}\StringTok{ }\NormalTok{r.mal); }\KeywordTok{summary}\NormalTok{(an.res)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = r.cn_h ~ r.mal)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3758 -1.3005 -0.0045  1.1843  4.6236 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)  
## (Intercept) -4.396e-17  1.950e-01   0.000   1.0000  
## r.mal       -1.301e+00  5.417e-01  -2.403   0.0185 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.798 on 83 degrees of freedom
## Multiple R-squared:  0.06502,    Adjusted R-squared:  0.05376 
## F-statistic: 5.772 on 1 and 83 DF,  p-value: 0.01851
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nd=}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{r.mal=}\KeywordTok{seq}\NormalTok{(}\KeywordTok{min}\NormalTok{(r.mal), }\KeywordTok{max}\NormalTok{(r.mal), }\DataTypeTok{len=}\DecValTok{50}\NormalTok{))}
\NormalTok{preds <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an.res, }\DataTypeTok{newdata=}\NormalTok{nd, }\DataTypeTok{type =} \StringTok{"response"}\NormalTok{, }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{nd}\OperatorTok{$}\NormalTok{fit <-}\StringTok{ }\NormalTok{preds}\OperatorTok{$}\NormalTok{fit}
\NormalTok{nd}\OperatorTok{$}\NormalTok{lower <-}\StringTok{ }\NormalTok{preds}\OperatorTok{$}\NormalTok{fit }\OperatorTok{-}\StringTok{ }\NormalTok{preds}\OperatorTok{$}\NormalTok{se.fit}
\NormalTok{nd}\OperatorTok{$}\NormalTok{upper <-}\StringTok{ }\NormalTok{preds}\OperatorTok{$}\NormalTok{fit }\OperatorTok{+}\StringTok{ }\NormalTok{preds}\OperatorTok{$}\NormalTok{se.fit}


\KeywordTok{jpeg}\NormalTok{(}\DataTypeTok{file=}\StringTok{"figures/n1_cn_mal.jpg"}\NormalTok{, }
     \DataTypeTok{width=}\DecValTok{750}\NormalTok{, }\DataTypeTok{height=}\DecValTok{750}\NormalTok{)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\KeywordTok{plot}\NormalTok{(}\DataTypeTok{y=}\NormalTok{r.cn_h, }\DataTypeTok{x=}\NormalTok{r.mal, }
     \DataTypeTok{xlab=}\StringTok{""}\NormalTok{, }\DataTypeTok{ylab=}\StringTok{""}\NormalTok{, }
     \DataTypeTok{las=}\DecValTok{1}\NormalTok{, }\DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }
     \DataTypeTok{cex=}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{, }\DataTypeTok{cex.axis=}\DecValTok{2}\NormalTok{)}

\KeywordTok{title}\NormalTok{(}\DataTypeTok{ylab=}\StringTok{"carbon:nitrogen ratio (residuals)"}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{, }\DataTypeTok{line=}\FloatTok{3.5}\NormalTok{)}
\KeywordTok{title}\NormalTok{(}\DataTypeTok{xlab=}\StringTok{"maladaptation (residuals)"}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{, }\DataTypeTok{line=}\DecValTok{4}\NormalTok{)}
\CommentTok{#axis.break(axis=2, breakpos=3.5)}

\KeywordTok{polygon}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(nd}\OperatorTok{$}\NormalTok{r.mal, }\KeywordTok{rev}\NormalTok{(nd}\OperatorTok{$}\NormalTok{r.mal)), }
        \DataTypeTok{y =} \KeywordTok{c}\NormalTok{(nd}\OperatorTok{$}\NormalTok{upper, }\KeywordTok{rev}\NormalTok{(nd}\OperatorTok{$}\NormalTok{lower)), }
        \DataTypeTok{col=}\StringTok{"grey"}\NormalTok{, }\DataTypeTok{density=}\DecValTok{100}\NormalTok{, }\DataTypeTok{lwd=}\NormalTok{.}\DecValTok{5}\NormalTok{)}

\KeywordTok{lines}\NormalTok{(nd}\OperatorTok{$}\NormalTok{r.mal, nd}\OperatorTok{$}\NormalTok{fit, }\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}

\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# carbon on CN}
\KeywordTok{jpeg}\NormalTok{(}\DataTypeTok{file=}\StringTok{"figures/n1_cn_pC.jpg"}\NormalTok{, }
     \DataTypeTok{width=}\DecValTok{750}\NormalTok{, }\DataTypeTok{height=}\DecValTok{750}\NormalTok{)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\KeywordTok{plot}\NormalTok{(}\DataTypeTok{y=}\NormalTok{p.n1}\OperatorTok{$}\NormalTok{cn2, }\DataTypeTok{x=}\NormalTok{p.n1}\OperatorTok{$}\NormalTok{pC, }
     \DataTypeTok{ylab=}\StringTok{""}\NormalTok{, }\DataTypeTok{xlab=}\StringTok{""}\NormalTok{, }
     \DataTypeTok{las=}\DecValTok{1}\NormalTok{, }\DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }\DataTypeTok{col=}\KeywordTok{ifelse}\NormalTok{(p.n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{, }\StringTok{"blue"}\NormalTok{, }\StringTok{"orange"}\NormalTok{),}
     \DataTypeTok{cex=}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{, }\DataTypeTok{cex.axis=}\DecValTok{2}\NormalTok{)}

\KeywordTok{title}\NormalTok{(}\DataTypeTok{ylab=}\StringTok{"carbon:nitrogen ratio"}\NormalTok{, }\DataTypeTok{line=}\FloatTok{4.5}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{)}
\KeywordTok{title}\NormalTok{(}\DataTypeTok{xlab=}\StringTok{"mass carbon (mg)"}\NormalTok{, }\DataTypeTok{line=}\FloatTok{4.5}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{)}

\KeywordTok{legend}\NormalTok{(}\DataTypeTok{x=}\FloatTok{7.25}\NormalTok{, }\DataTypeTok{y=}\DecValTok{33}\NormalTok{, }
       \DataTypeTok{legend=}\KeywordTok{c}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"C. spinosus"}\NormalTok{), }\KeywordTok{italic}\NormalTok{( }\StringTok{"A. fasciculatum"}\NormalTok{))), }
       \DataTypeTok{pch=}\KeywordTok{c}\NormalTok{(}\DecValTok{16}\NormalTok{, }\DecValTok{16}\NormalTok{), }\DataTypeTok{col=}\KeywordTok{c}\NormalTok{(}\StringTok{"orange"}\NormalTok{, }\StringTok{"blue"}\NormalTok{), }
       \DataTypeTok{bg=}\OtherTok{NULL}\NormalTok{, }\DataTypeTok{bty=}\StringTok{"n"}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{2}\NormalTok{, }\DataTypeTok{y.intersp =} \DecValTok{1}\NormalTok{)}

\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# nitrogen on CN}

\NormalTok{an_n <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(cn2 }\OperatorTok{~}\StringTok{ }\NormalTok{pN }\OperatorTok{+}\StringTok{ }\KeywordTok{I}\NormalTok{(pN }\OperatorTok{^}\StringTok{ }\DecValTok{2}\NormalTok{), }\DataTypeTok{data=}\NormalTok{p.n1)}
\KeywordTok{summary}\NormalTok{(an_n)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = cn2 ~ pN + I(pN^2), data = p.n1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.1372 -0.9234  0.1656  1.0417  4.3042 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)   62.181      5.368  11.584  < 2e-16 ***
## pN          -133.353     24.095  -5.535 3.65e-07 ***
## I(pN^2)      100.705     26.418   3.812 0.000266 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.828 on 82 degrees of freedom
## Multiple R-squared:  0.8013, Adjusted R-squared:  0.7964 
## F-statistic: 165.3 on 2 and 82 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nd <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{pN=}\KeywordTok{seq}\NormalTok{(}\KeywordTok{min}\NormalTok{(p.n1}\OperatorTok{$}\NormalTok{pN), }\KeywordTok{max}\NormalTok{(p.n1}\OperatorTok{$}\NormalTok{pN), }\DataTypeTok{len=}\DecValTok{50}\NormalTok{))}
\NormalTok{preds <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(an_n, }\DataTypeTok{newdata=}\NormalTok{nd, }\DataTypeTok{type=}\StringTok{"response"}\NormalTok{, }\DataTypeTok{se.fit=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{nd <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(nd, }\DataTypeTok{fit=}\NormalTok{preds}\OperatorTok{$}\NormalTok{fit, }\DataTypeTok{upper=}\NormalTok{preds}\OperatorTok{$}\NormalTok{fit }\OperatorTok{+}\StringTok{ }\NormalTok{preds}\OperatorTok{$}\NormalTok{se.fit, }\DataTypeTok{lower=}\NormalTok{preds}\OperatorTok{$}\NormalTok{fit}\OperatorTok{-}\NormalTok{preds}\OperatorTok{$}\NormalTok{se.fit)}

\KeywordTok{jpeg}\NormalTok{(}\DataTypeTok{file=}\StringTok{"figures/n1_cn_pN.jpg"}\NormalTok{, }
     \DataTypeTok{width=}\DecValTok{750}\NormalTok{, }\DataTypeTok{height=}\DecValTok{750}\NormalTok{)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\KeywordTok{plot}\NormalTok{(}\DataTypeTok{y=}\NormalTok{p.n1}\OperatorTok{$}\NormalTok{cn2, }\DataTypeTok{x=}\NormalTok{p.n1}\OperatorTok{$}\NormalTok{pN, }
     \DataTypeTok{ylab=}\StringTok{""}\NormalTok{, }\DataTypeTok{xlab=}\StringTok{""}\NormalTok{, }
     \DataTypeTok{las=}\DecValTok{1}\NormalTok{, }\DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }\DataTypeTok{col=}\KeywordTok{ifelse}\NormalTok{(p.n1}\OperatorTok{$}\NormalTok{host }\OperatorTok{==}\StringTok{ "A"}\NormalTok{, }\StringTok{"blue"}\NormalTok{, }\StringTok{"orange"}\NormalTok{),}
     \DataTypeTok{cex=}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex.axis=}\DecValTok{2}\NormalTok{)}

\KeywordTok{title}\NormalTok{(}\DataTypeTok{ylab=}\StringTok{"carbon:nitrogen ratio"}\NormalTok{, }\DataTypeTok{line=}\FloatTok{4.5}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{)}
\KeywordTok{title}\NormalTok{(}\DataTypeTok{xlab=}\StringTok{"mass nitrogen (mg)"}\NormalTok{, }\DataTypeTok{line=}\FloatTok{4.5}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{3}\NormalTok{)}

\KeywordTok{polygon}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(nd}\OperatorTok{$}\NormalTok{pN, }\KeywordTok{rev}\NormalTok{(nd}\OperatorTok{$}\NormalTok{pN)), }
        \DataTypeTok{y =} \KeywordTok{c}\NormalTok{(nd}\OperatorTok{$}\NormalTok{upper, }\KeywordTok{rev}\NormalTok{(nd}\OperatorTok{$}\NormalTok{lower)), }
        \DataTypeTok{col=}\StringTok{"grey"}\NormalTok{, }\DataTypeTok{density=}\DecValTok{100}\NormalTok{, }\DataTypeTok{lwd=}\NormalTok{.}\DecValTok{5}\NormalTok{)}

\KeywordTok{lines}\NormalTok{(nd}\OperatorTok{$}\NormalTok{pN, nd}\OperatorTok{$}\NormalTok{fit, }\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{, }\DataTypeTok{col=}\StringTok{"grey"}\NormalTok{)}

\KeywordTok{legend}\NormalTok{(}\DataTypeTok{x=}\NormalTok{.}\DecValTok{5}\NormalTok{, }\DataTypeTok{y=}\DecValTok{30}\NormalTok{, }
       \DataTypeTok{legend=}\KeywordTok{c}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"C. spinosus"}\NormalTok{), }\KeywordTok{italic}\NormalTok{( }\StringTok{"A. fasciculatum"}\NormalTok{))), }
       \DataTypeTok{pch=}\KeywordTok{c}\NormalTok{(}\DecValTok{16}\NormalTok{, }\DecValTok{16}\NormalTok{), }\DataTypeTok{col=}\KeywordTok{c}\NormalTok{(}\StringTok{"orange"}\NormalTok{, }\StringTok{"blue"}\NormalTok{), }
       \DataTypeTok{bg=}\OtherTok{NULL}\NormalTok{, }\DataTypeTok{bty=}\StringTok{"n"}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{2}\NormalTok{, }\DataTypeTok{y.intersp =} \DecValTok{1}\NormalTok{)}

\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n1}\OperatorTok{$}\NormalTok{occ <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(n1}\OperatorTok{$}\NormalTok{no_tim_gs}\OperatorTok{==}\DecValTok{0}\NormalTok{, }\OtherTok{FALSE}\NormalTok{, }\OtherTok{TRUE}\NormalTok{)}
\NormalTok{n1}\OperatorTok{$}\NormalTok{radius <-}\StringTok{ }\NormalTok{(n1}\OperatorTok{$}\NormalTok{vol_cub}\OperatorTok{/}\NormalTok{(}\DecValTok{100000}\OperatorTok{*}\NormalTok{pi))}\OperatorTok{^}\NormalTok{(}\DecValTok{1}\OperatorTok{/}\DecValTok{3}\NormalTok{)}

\NormalTok{n1_occ <-}\StringTok{ }\NormalTok{n1[n1}\OperatorTok{$}\NormalTok{occ,]}

\NormalTok{adOnly <-}\StringTok{ }\NormalTok{n1_occ[n1_occ}\OperatorTok{$}\NormalTok{host}\OperatorTok{==}\StringTok{"A"}\NormalTok{,]}
\NormalTok{ceOnly <-}\StringTok{ }\NormalTok{n1_occ[n1_occ}\OperatorTok{$}\NormalTok{host}\OperatorTok{==}\StringTok{"C"}\NormalTok{,]}
\NormalTok{empty <-}\StringTok{ }\NormalTok{n1[}\OperatorTok{!}\NormalTok{n1}\OperatorTok{$}\NormalTok{occ,]}

\NormalTok{cFunA <-}\StringTok{ }\KeywordTok{colorRamp}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"skyblue1"}\NormalTok{, }\StringTok{"blue"}\NormalTok{))}
\NormalTok{cFunC <-}\StringTok{ }\KeywordTok{colorRamp}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"darkorange2"}\NormalTok{, }\StringTok{"peachpuff"}\NormalTok{))}

\NormalTok{colsA <-}\StringTok{ }\KeywordTok{rgb}\NormalTok{(}\KeywordTok{cFunA}\NormalTok{(adOnly}\OperatorTok{$}\NormalTok{mal), }\DataTypeTok{maxColorValue=}\DecValTok{255}\NormalTok{)}
\NormalTok{colsC <-}\StringTok{ }\KeywordTok{rgb}\NormalTok{(}\KeywordTok{cFunC}\NormalTok{(ceOnly}\OperatorTok{$}\NormalTok{mal), }\DataTypeTok{maxColorValue=}\DecValTok{255}\NormalTok{)}

\KeywordTok{jpeg}\NormalTok{(}\DataTypeTok{file=}\StringTok{"figures/n1_map.jpg"}\NormalTok{, }
     \DataTypeTok{width=}\DecValTok{750}\NormalTok{, }\DataTypeTok{height=}\DecValTok{750}\NormalTok{)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\KeywordTok{plot}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{, }\DataTypeTok{y=}\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{, }
     \DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{80}\NormalTok{), }\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{1}\NormalTok{, }\DecValTok{50}\NormalTok{), }
     \DataTypeTok{type=}\StringTok{"n"}\NormalTok{, }
     \DataTypeTok{xlab=}\StringTok{""}\NormalTok{, }\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}
     \DataTypeTok{las=}\DecValTok{1}\NormalTok{, }\DataTypeTok{cex.axis=}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex.lab=}\DecValTok{2}\NormalTok{, }\DataTypeTok{axes=}\OtherTok{FALSE}\NormalTok{)}
\CommentTok{#title(ylab="meters N-S", line=4, cex.lab=2)}
\KeywordTok{polygon}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{3}\NormalTok{, }\OperatorTok{-}\DecValTok{3}\NormalTok{, }\DecValTok{85}\NormalTok{, }\DecValTok{85}\NormalTok{), }\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{3}\NormalTok{, }\DecValTok{55}\NormalTok{, }\DecValTok{55}\NormalTok{, }\OperatorTok{-}\DecValTok{3}\NormalTok{), }\DataTypeTok{density=}\DecValTok{500}\NormalTok{, }\DataTypeTok{col=}\StringTok{"grey"}\NormalTok{)}
\KeywordTok{polygon}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\DecValTok{60}\NormalTok{, }\DecValTok{60}\NormalTok{, }\DecValTok{80}\NormalTok{, }\DecValTok{80}\NormalTok{), }\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{25}\NormalTok{, .}\DecValTok{25}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DataTypeTok{density=}\DecValTok{500}\NormalTok{, }\DataTypeTok{col=}\StringTok{"black"}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DecValTok{70}\NormalTok{, }\OperatorTok{-}\NormalTok{.}\DecValTok{75}\NormalTok{, }\DataTypeTok{labels=}\StringTok{"10 meters"}\NormalTok{, }\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{)}
\KeywordTok{symbols}\NormalTok{(}\DataTypeTok{x=}\NormalTok{adOnly}\OperatorTok{$}\NormalTok{x, }\DataTypeTok{y=}\NormalTok{adOnly}\OperatorTok{$}\NormalTok{y, }\DataTypeTok{circles=}\NormalTok{(adOnly}\OperatorTok{$}\NormalTok{radius), }\DataTypeTok{bg=}\NormalTok{colsA, }\DataTypeTok{inches=}\OtherTok{FALSE}\NormalTok{,}
        \DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{75}\NormalTok{), }\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{1}\NormalTok{, }\DecValTok{50}\NormalTok{),}
        \DataTypeTok{xlab =} \StringTok{"metres E-W"}\NormalTok{, }\DataTypeTok{ylab=}\StringTok{"metres N-S"}\NormalTok{, }\DataTypeTok{fg=}\StringTok{"blue"}\NormalTok{, }\DataTypeTok{lwd=}\FloatTok{2.5}\NormalTok{, }\DataTypeTok{cex.lab=}\FloatTok{1.5}\NormalTok{,}
        \DataTypeTok{cex.axis=}\FloatTok{1.5}\NormalTok{, }\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{)}
\KeywordTok{symbols}\NormalTok{(}\DataTypeTok{x=}\NormalTok{ceOnly}\OperatorTok{$}\NormalTok{x, }\DataTypeTok{y=}\NormalTok{ceOnly}\OperatorTok{$}\NormalTok{y, }\DataTypeTok{circles=}\NormalTok{(ceOnly}\OperatorTok{$}\NormalTok{radius), }\DataTypeTok{bg=}\NormalTok{colsC, }\DataTypeTok{inches=}\NormalTok{F, }\DataTypeTok{add=}\NormalTok{T,}
        \DataTypeTok{fg=}\StringTok{"orange"}\NormalTok{, }\DataTypeTok{lwd=}\FloatTok{2.5}\NormalTok{)}
\KeywordTok{symbols}\NormalTok{(}\DataTypeTok{x=}\NormalTok{empty}\OperatorTok{$}\NormalTok{x, }\DataTypeTok{y=}\NormalTok{empty}\OperatorTok{$}\NormalTok{y, }\DataTypeTok{circles=}\NormalTok{(empty}\OperatorTok{$}\NormalTok{radius), }\DataTypeTok{bg=}\StringTok{"white"}\NormalTok{,}
        \DataTypeTok{fg=}\KeywordTok{ifelse}\NormalTok{(empty}\OperatorTok{$}\NormalTok{host}\OperatorTok{==}\StringTok{"A"}\NormalTok{, }\StringTok{"blue"}\NormalTok{, }\StringTok{"orange"}\NormalTok{),}
        \DataTypeTok{inches=}\NormalTok{F, }\DataTypeTok{add=}\NormalTok{T, }\DataTypeTok{lwd=}\FloatTok{2.5}\NormalTok{)}



\KeywordTok{legend}\NormalTok{(}\DataTypeTok{x=}\DecValTok{0}\NormalTok{, }\DataTypeTok{y=}\DecValTok{50}\NormalTok{, }\DataTypeTok{legend=}\KeywordTok{c}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"A. fasciculatum"}\NormalTok{)), }\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"C. spinosus"}\NormalTok{))), }\DataTypeTok{pch=}\DecValTok{16}\NormalTok{, }\DataTypeTok{col=}\KeywordTok{c}\NormalTok{(}\StringTok{"blue"}\NormalTok{, }\StringTok{"orange"}\NormalTok{), }\DataTypeTok{bty=}\StringTok{"n"}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{2}\NormalTok{)}

\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ad}\OperatorTok{$}\NormalTok{taxon <-}\StringTok{ }\KeywordTok{factor}\NormalTok{(}\KeywordTok{ifelse}\NormalTok{(ad}\OperatorTok{$}\NormalTok{family }\OperatorTok{==}\StringTok{ "Formicidae"}\NormalTok{, }\StringTok{"Formicidae"}\NormalTok{, }
                          \KeywordTok{ifelse}\NormalTok{(ad}\OperatorTok{$}\NormalTok{order }\OperatorTok{==}\StringTok{ "Homoptera"}\NormalTok{, }\StringTok{"Hemiptera"}\NormalTok{,}
                                 \KeywordTok{ifelse}\NormalTok{(ad}\OperatorTok{$}\NormalTok{order }\OperatorTok{==}\StringTok{ "Neuroptera"}\NormalTok{, }\StringTok{"Chrysopidae"}\NormalTok{,}
                                        \KeywordTok{ifelse}\NormalTok{(ad}\OperatorTok{$}\NormalTok{order }\OperatorTok{==}\StringTok{ "Aranea"}\NormalTok{,}
                                               \KeywordTok{as.character}\NormalTok{(ad}\OperatorTok{$}\NormalTok{family),}
                                               \KeywordTok{ifelse}\NormalTok{(ad}\OperatorTok{$}\NormalTok{order }\OperatorTok{==}\StringTok{ "Coleoptera"} \OperatorTok{&}\StringTok{ }\NormalTok{ad}\OperatorTok{$}\NormalTok{family }\OperatorTok{!=}\StringTok{ ""}\NormalTok{, }
                                                      \KeywordTok{as.character}\NormalTok{(ad}\OperatorTok{$}\NormalTok{family), }
                                               \KeywordTok{as.character}\NormalTok{(ad}\OperatorTok{$}\NormalTok{order)))))))}

\CommentTok{#ad$taxon <- factor(ifelse(ad$family != "", as.character(ad$family),}
\CommentTok{#                          as.character(ad$order)))}

\NormalTok{ad}\OperatorTok{$}\NormalTok{taxon <-}\StringTok{ }\KeywordTok{factor}\NormalTok{(}\KeywordTok{ifelse}\NormalTok{(ad}\OperatorTok{$}\NormalTok{family }\OperatorTok{==}\StringTok{ "Formicidae"}\NormalTok{, }\StringTok{"Formicidae"}\NormalTok{, }
                          \KeywordTok{ifelse}\NormalTok{(ad}\OperatorTok{$}\NormalTok{order }\OperatorTok{==}\StringTok{ "Homoptera"}\NormalTok{, }\StringTok{"Hemiptera"}\NormalTok{,}
                                 \KeywordTok{ifelse}\NormalTok{(ad}\OperatorTok{$}\NormalTok{order }\OperatorTok{==}\StringTok{ "Aranea"}\NormalTok{, }\StringTok{"Aranea"}\NormalTok{, }
                                 \KeywordTok{ifelse}\NormalTok{(ad}\OperatorTok{$}\NormalTok{order }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Chrysopidae"}\NormalTok{, }\StringTok{"Diptera"}\NormalTok{,}
                                                        \StringTok{"Hymenoptera"}\NormalTok{), }
                                        \StringTok{"Other"}\NormalTok{, }\KeywordTok{as.character}\NormalTok{(ad}\OperatorTok{$}\NormalTok{order))))))}

\NormalTok{orders <-}\StringTok{ }\KeywordTok{levels}\NormalTok{(}\KeywordTok{droplevels}\NormalTok{(ad}\OperatorTok{$}\NormalTok{taxon[ad}\OperatorTok{$}\NormalTok{length }\OperatorTok{>=}\DecValTok{5}\NormalTok{]))}

\NormalTok{arts <-}\StringTok{ }\KeywordTok{setNames}\NormalTok{(}\KeywordTok{lapply}\NormalTok{(orders, }
                        \DataTypeTok{FUN=}\ControlFlowTok{function}\NormalTok{(x) }\KeywordTok{table}\NormalTok{(ad}\OperatorTok{$}\NormalTok{plant_id[ad}\OperatorTok{$}\NormalTok{taxon }\OperatorTok{==}\StringTok{ }\NormalTok{x }\OperatorTok{&}\StringTok{ }\NormalTok{ad}\OperatorTok{$}\NormalTok{length }\OperatorTok{>=}\DecValTok{5}\NormalTok{])),}
\NormalTok{                 orders)}

\NormalTok{newnames <-}\StringTok{ }\KeywordTok{paste}\NormalTok{(}\StringTok{"no_"}\NormalTok{, orders, }\StringTok{"_5"}\NormalTok{, }\DataTypeTok{sep=}\StringTok{''}\NormalTok{)}

\NormalTok{n1[, newnames] <-}\StringTok{ }\DecValTok{0}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(newnames)) \{}
  
\NormalTok{  n1[}\KeywordTok{match}\NormalTok{(}\KeywordTok{names}\NormalTok{(arts[[i]]), n1}\OperatorTok{$}\NormalTok{plant_id), newnames[i]] <-}\StringTok{ }\NormalTok{arts[[i]]}
  
\NormalTok{\}}

\NormalTok{pnames <-}\StringTok{ }\KeywordTok{paste}\NormalTok{(}\StringTok{"p_"}\NormalTok{, orders, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{)}

\NormalTok{n1[, pnames] <-}\StringTok{ }\DecValTok{0}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(pnames)) \{}
  
\NormalTok{  n1[, pnames[i]] <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(n1}\OperatorTok{$}\NormalTok{no_any_}\DecValTok{5} \OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{, }\OtherTok{NA}\NormalTok{, n1[, newnames[i]] }\OperatorTok{/}\StringTok{ }\NormalTok{n1[, }\StringTok{"no_any_5"}\NormalTok{])}
  
\NormalTok{\}}

\NormalTok{thresh <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{9}\NormalTok{, }\DataTypeTok{length.out =} \DecValTok{10}\NormalTok{), }\FloatTok{0.9999999}\NormalTok{)}

\NormalTok{surv <-}\StringTok{ }\KeywordTok{do.call}\NormalTok{(rbind, }\KeywordTok{lapply}\NormalTok{(pnames, }\DataTypeTok{FUN =} \ControlFlowTok{function}\NormalTok{(x) \{}
  
  \KeywordTok{sapply}\NormalTok{(thresh, }\DataTypeTok{FUN=}\ControlFlowTok{function}\NormalTok{(y) \{}
    
    \KeywordTok{sum}\NormalTok{(n1[, x] }\OperatorTok{>}\StringTok{ }\NormalTok{y, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}
    
\NormalTok{  \})}
  
\NormalTok{\})}
\NormalTok{)}

\KeywordTok{dimnames}\NormalTok{(surv) <-}\StringTok{ }\KeywordTok{list}\NormalTok{(orders, }\KeywordTok{c}\NormalTok{(thresh[}\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{], }\DecValTok{1}\NormalTok{))}

\NormalTok{arttot <-}\StringTok{ }\KeywordTok{table}\NormalTok{(}\KeywordTok{droplevels}\NormalTok{(ad}\OperatorTok{$}\NormalTok{taxon[ad}\OperatorTok{$}\NormalTok{length }\OperatorTok{>=}\StringTok{ }\DecValTok{5}\NormalTok{]))}

\NormalTok{surv <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(}\DataTypeTok{tot=}\NormalTok{arttot, surv)}

\NormalTok{surv <-}\StringTok{ }\NormalTok{surv[}\KeywordTok{order}\NormalTok{(surv[, }\StringTok{"tot"}\NormalTok{], }\DataTypeTok{decreasing=}\OtherTok{TRUE}\NormalTok{), ]}


\CommentTok{#ad[ad$order == "Lepidoptera" & ad$length >= 5, c("order", "family")]}

\CommentTok{#write.csv(surv, file="~/Dropbox/Projects/CA Arthropods/N1/Data/art_surv.csv", }
\CommentTok{#           row.names=TRUE)}

\KeywordTok{write.csv}\NormalTok{(surv, }\DataTypeTok{file=}\StringTok{"data/art_surv_gp.csv"}\NormalTok{, }
           \DataTypeTok{row.names=}\OtherTok{TRUE}\NormalTok{)}

\CommentTok{# smaller things}

\NormalTok{arttot <-}\StringTok{ }\KeywordTok{table}\NormalTok{(}\KeywordTok{droplevels}\NormalTok{(ad}\OperatorTok{$}\NormalTok{taxon[ad}\OperatorTok{$}\NormalTok{length }\OperatorTok{<}\DecValTok{5}\NormalTok{]))}

\NormalTok{ad[ad}\OperatorTok{$}\NormalTok{family}\OperatorTok{==}\StringTok{"Formicidae"}\NormalTok{, }\KeywordTok{c}\NormalTok{(}\StringTok{"genus"}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## NULL
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(partitions)}

\NormalTok{p =}\StringTok{ }\FloatTok{0.05}
\NormalTok{s =}\StringTok{ }\DecValTok{10}

\NormalTok{naive.pmf <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(}\DataTypeTok{prob =}\NormalTok{ .}\DecValTok{05}\NormalTok{, }\DataTypeTok{giveup =} \DecValTok{10}\NormalTok{, }\DataTypeTok{max =} \DecValTok{40}\NormalTok{, }\DataTypeTok{plot.pmf =} \OtherTok{TRUE}\NormalTok{) \{}

\NormalTok{  p =}\StringTok{ }\NormalTok{prob}
\NormalTok{  s =}\StringTok{ }\NormalTok{giveup}
  
\NormalTok{pmf <-}\StringTok{ }\KeywordTok{c}\NormalTok{((}\DecValTok{1} \OperatorTok{-}\StringTok{ }\KeywordTok{pgeom}\NormalTok{(s}\OperatorTok{-}\DecValTok{1}\NormalTok{, p)), }\KeywordTok{c}\NormalTok{(}\KeywordTok{lapply}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\NormalTok{(max}\OperatorTok{-}\NormalTok{s), }\ControlFlowTok{function}\NormalTok{(x) \{}
  
  \KeywordTok{library}\NormalTok{(partitions)}
\NormalTok{  part <-}\StringTok{ }\KeywordTok{t}\NormalTok{(}\KeywordTok{parts}\NormalTok{(x)) }
\NormalTok{  ps <-}\StringTok{ }\KeywordTok{lapply}\NormalTok{(}
          \KeywordTok{lapply}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(part), }\ControlFlowTok{function}\NormalTok{(y) part[y,]), }\ControlFlowTok{function}\NormalTok{(z) z[z }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{])}
\NormalTok{  ps <-}\StringTok{ }\NormalTok{ps[}\KeywordTok{sapply}\NormalTok{(ps, }\ControlFlowTok{function}\NormalTok{(q) }\KeywordTok{all}\NormalTok{(q }\OperatorTok{<}\StringTok{ }\NormalTok{s))]}
\NormalTok{  pt.ct <-}\StringTok{ }\KeywordTok{mapply}\NormalTok{(}\DataTypeTok{FUN=}\ControlFlowTok{function}\NormalTok{(unq, len) }\KeywordTok{factorial}\NormalTok{(len)}\OperatorTok{/}\KeywordTok{prod}\NormalTok{(}\KeywordTok{factorial}\NormalTok{(unq)), }
       \DataTypeTok{unq=}\KeywordTok{lapply}\NormalTok{(ps, table), }
       \DataTypeTok{len=}\KeywordTok{lapply}\NormalTok{(ps, length))}
\NormalTok{  probs <-}\StringTok{ }\KeywordTok{mapply}\NormalTok{(}\ControlFlowTok{function}\NormalTok{(ps, pt.ct) }\KeywordTok{prod}\NormalTok{(}\KeywordTok{dgeom}\NormalTok{(ps}\OperatorTok{-}\DecValTok{1}\NormalTok{, }\DataTypeTok{prob=}\NormalTok{p)) }\OperatorTok{*}\StringTok{ }\NormalTok{pt.ct,}
      \DataTypeTok{ps =}\NormalTok{ ps, }\DataTypeTok{pt.ct =}\NormalTok{ pt.ct)}
  \KeywordTok{sum}\NormalTok{(probs) }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\KeywordTok{pgeom}\NormalTok{(s}\OperatorTok{-}\DecValTok{1}\NormalTok{, p))}
  
\NormalTok{\}), }\DataTypeTok{recursive=}\OtherTok{TRUE}\NormalTok{))}

 \ControlFlowTok{if}\NormalTok{(plot.pmf }\OperatorTok{==}\StringTok{ }\OtherTok{TRUE}\NormalTok{) }\KeywordTok{plot}\NormalTok{(}\DecValTok{10}\OperatorTok{:}\NormalTok{max, pmf, }\DataTypeTok{type=}\StringTok{"l"}\NormalTok{)}

\NormalTok{cum <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(pmf) }\CommentTok{# cumulative density = 0.948273}
\NormalTok{expt <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(pmf }\OperatorTok{*}\StringTok{ }\DecValTok{10}\OperatorTok{:}\NormalTok{max) }\CommentTok{# expected value = 12.0177}

\KeywordTok{list}\NormalTok{(}\DataTypeTok{pmf =}\NormalTok{ pmf, }\DataTypeTok{cum =}\NormalTok{ cum, }\DataTypeTok{expt =}\NormalTok{ expt)}
\NormalTok{\}}

\KeywordTok{dgeom}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{05}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.05
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{dgeom}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{05}\NormalTok{)}\OperatorTok{^}\DecValTok{2} \OperatorTok{+}\StringTok{ }\KeywordTok{dgeom}\NormalTok{(}\DecValTok{1}\NormalTok{, .}\DecValTok{05}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.05
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{dgeom}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{05}\NormalTok{)}\OperatorTok{^}\DecValTok{3} \OperatorTok{+}\StringTok{ }\DecValTok{2}\OperatorTok{*}\NormalTok{(}\KeywordTok{dgeom}\NormalTok{(}\DecValTok{1}\NormalTok{, .}\DecValTok{05}\NormalTok{) }\OperatorTok{*}\StringTok{ }\KeywordTok{dgeom}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{05}\NormalTok{)) }\OperatorTok{+}\StringTok{ }\KeywordTok{dgeom}\NormalTok{(}\DecValTok{2}\NormalTok{, .}\DecValTok{05}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.05
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lm}\NormalTok{(}\KeywordTok{c}\NormalTok{(.}\DecValTok{3}\NormalTok{, .}\DecValTok{65}\NormalTok{) }\OperatorTok{~}\StringTok{ }\KeywordTok{c}\NormalTok{(.}\DecValTok{2}\NormalTok{, .}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = c(0.3, 0.65) ~ c(0.2, 0.8))
## 
## Coefficients:
## (Intercept)  c(0.2, 0.8)  
##      0.1833       0.5833
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{st.w <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) \{ }\FloatTok{1.117} \OperatorTok{-}\StringTok{ }\FloatTok{0.583} \OperatorTok{*}\StringTok{ }\NormalTok{freq \}}
\NormalTok{ gr.w <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) \{ }\FloatTok{0.183} \OperatorTok{+}\StringTok{ }\FloatTok{0.583} \OperatorTok{*}\StringTok{ }\NormalTok{freq\}}

\NormalTok{ w.bar <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) }\KeywordTok{st.w}\NormalTok{(freq) }\OperatorTok{*}\StringTok{ }\NormalTok{freq }\OperatorTok{+}\StringTok{ }\KeywordTok{gr.w}\NormalTok{(freq) }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{freq)}

\NormalTok{ wbs <-}\StringTok{ }\KeywordTok{w.bar}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{))}

\KeywordTok{cbind}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,.}\DecValTok{01}\NormalTok{), wbs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                   wbs
##   [1,] 0.00 0.1830000
##   [2,] 0.01 0.1980534
##   [3,] 0.02 0.2128736
##   [4,] 0.03 0.2274606
##   [5,] 0.04 0.2418144
##   [6,] 0.05 0.2559350
##   [7,] 0.06 0.2698224
##   [8,] 0.07 0.2834766
##   [9,] 0.08 0.2968976
##  [10,] 0.09 0.3100854
##  [11,] 0.10 0.3230400
##  [12,] 0.11 0.3357614
##  [13,] 0.12 0.3482496
##  [14,] 0.13 0.3605046
##  [15,] 0.14 0.3725264
##  [16,] 0.15 0.3843150
##  [17,] 0.16 0.3958704
##  [18,] 0.17 0.4071926
##  [19,] 0.18 0.4182816
##  [20,] 0.19 0.4291374
##  [21,] 0.20 0.4397600
##  [22,] 0.21 0.4501494
##  [23,] 0.22 0.4603056
##  [24,] 0.23 0.4702286
##  [25,] 0.24 0.4799184
##  [26,] 0.25 0.4893750
##  [27,] 0.26 0.4985984
##  [28,] 0.27 0.5075886
##  [29,] 0.28 0.5163456
##  [30,] 0.29 0.5248694
##  [31,] 0.30 0.5331600
##  [32,] 0.31 0.5412174
##  [33,] 0.32 0.5490416
##  [34,] 0.33 0.5566326
##  [35,] 0.34 0.5639904
##  [36,] 0.35 0.5711150
##  [37,] 0.36 0.5780064
##  [38,] 0.37 0.5846646
##  [39,] 0.38 0.5910896
##  [40,] 0.39 0.5972814
##  [41,] 0.40 0.6032400
##  [42,] 0.41 0.6089654
##  [43,] 0.42 0.6144576
##  [44,] 0.43 0.6197166
##  [45,] 0.44 0.6247424
##  [46,] 0.45 0.6295350
##  [47,] 0.46 0.6340944
##  [48,] 0.47 0.6384206
##  [49,] 0.48 0.6425136
##  [50,] 0.49 0.6463734
##  [51,] 0.50 0.6500000
##  [52,] 0.51 0.6533934
##  [53,] 0.52 0.6565536
##  [54,] 0.53 0.6594806
##  [55,] 0.54 0.6621744
##  [56,] 0.55 0.6646350
##  [57,] 0.56 0.6668624
##  [58,] 0.57 0.6688566
##  [59,] 0.58 0.6706176
##  [60,] 0.59 0.6721454
##  [61,] 0.60 0.6734400
##  [62,] 0.61 0.6745014
##  [63,] 0.62 0.6753296
##  [64,] 0.63 0.6759246
##  [65,] 0.64 0.6762864
##  [66,] 0.65 0.6764150
##  [67,] 0.66 0.6763104
##  [68,] 0.67 0.6759726
##  [69,] 0.68 0.6754016
##  [70,] 0.69 0.6745974
##  [71,] 0.70 0.6735600
##  [72,] 0.71 0.6722894
##  [73,] 0.72 0.6707856
##  [74,] 0.73 0.6690486
##  [75,] 0.74 0.6670784
##  [76,] 0.75 0.6648750
##  [77,] 0.76 0.6624384
##  [78,] 0.77 0.6597686
##  [79,] 0.78 0.6568656
##  [80,] 0.79 0.6537294
##  [81,] 0.80 0.6503600
##  [82,] 0.81 0.6467574
##  [83,] 0.82 0.6429216
##  [84,] 0.83 0.6388526
##  [85,] 0.84 0.6345504
##  [86,] 0.85 0.6300150
##  [87,] 0.86 0.6252464
##  [88,] 0.87 0.6202446
##  [89,] 0.88 0.6150096
##  [90,] 0.89 0.6095414
##  [91,] 0.90 0.6038400
##  [92,] 0.91 0.5979054
##  [93,] 0.92 0.5917376
##  [94,] 0.93 0.5853366
##  [95,] 0.94 0.5787024
##  [96,] 0.95 0.5718350
##  [97,] 0.96 0.5647344
##  [98,] 0.97 0.5574006
##  [99,] 0.98 0.5498336
## [100,] 0.99 0.5420334
## [101,] 1.00 0.5340000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{max}\NormalTok{(wbs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.676415
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{), wbs)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/unnamed-chunk-1-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#wss <- ws(seq(0, 1, .001))}
\CommentTok{#max(wss - min(wss))}
\CommentTok{#min(wss)}
\NormalTok{ws <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) \{}
\NormalTok{  raw <-}\StringTok{ }\FloatTok{1.517} \OperatorTok{*}\StringTok{ }\NormalTok{freq }\OperatorTok{-}\StringTok{ }\FloatTok{1.166} \OperatorTok{*}\StringTok{ }\NormalTok{freq}\OperatorTok{^}\DecValTok{2} \OperatorTok{+}\StringTok{ }\FloatTok{0.183}
\NormalTok{  (raw }\OperatorTok{-}\StringTok{ }\FloatTok{0.183}\NormalTok{)}\OperatorTok{/}\NormalTok{.}\DecValTok{493415}
\NormalTok{  \}}

\NormalTok{ws <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) \{}
\NormalTok{  raw <-}\StringTok{ }\KeywordTok{w.bar}\NormalTok{(freq)}
\NormalTok{  (raw }\OperatorTok{-}\StringTok{ }\FloatTok{0.183}\NormalTok{)}\OperatorTok{/}\NormalTok{.}\DecValTok{493415}
\NormalTok{  \}}

\KeywordTok{ws}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] 0.00000000 0.03050860 0.06054457 0.09010792 0.11919865 0.14781675
##   [7] 0.17596222 0.20363507 0.23083530 0.25756290 0.28381788 0.30960024
##  [13] 0.33490996 0.35974707 0.38411155 0.40800340 0.43142264 0.45436924
##  [19] 0.47684323 0.49884458 0.52037332 0.54142943 0.56201291 0.58212377
##  [25] 0.60176201 0.62092762 0.63962060 0.65784097 0.67558870 0.69286382
##  [31] 0.70966631 0.72599617 0.74185341 0.75723802 0.77215002 0.78658938
##  [37] 0.80055612 0.81405024 0.82707173 0.83962060 0.85169685 0.86330047
##  [43] 0.87443146 0.88508983 0.89527558 0.90498870 0.91422920 0.92299707
##  [49] 0.93129232 0.93911494 0.94646494 0.95334232 0.95974707 0.96567919
##  [55] 0.97113870 0.97612557 0.98063983 0.98468145 0.98825046 0.99134684
##  [61] 0.99397059 0.99612172 0.99780023 0.99900611 0.99973937 1.00000000
##  [67] 0.99978801 0.99910339 0.99794615 0.99631629 0.99421380 0.99163868
##  [73] 0.98859094 0.98507058 0.98107759 0.97661198 0.97167374 0.96626288
##  [79] 0.96037940 0.95402329 0.94719455 0.93989319 0.93211921 0.92387260
##  [85] 0.91515337 0.90596151 0.89629703 0.88615993 0.87555020 0.86446784
##  [91] 0.85291286 0.84088526 0.82838503 0.81541218 0.80196670 0.78804860
##  [97] 0.77365787 0.75879452 0.74345855 0.72764995 0.71136873
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{), }\KeywordTok{ws}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/unnamed-chunk-1-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{freq <-}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{99}\NormalTok{, .}\DecValTok{01}\NormalTok{)}
\NormalTok{k =}\StringTok{ }\DecValTok{1}
\NormalTok{ws <-}\StringTok{ }\DecValTok{1}\OperatorTok{-}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\KeywordTok{exp}\NormalTok{(freq)))}

\KeywordTok{plot}\NormalTok{(freq, ws)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/asymptotic model-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{freq <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.2}\NormalTok{, }\FloatTok{0.8}\NormalTok{)}
\NormalTok{df <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{a=}\KeywordTok{c}\NormalTok{(.}\DecValTok{99}\NormalTok{, .}\DecValTok{65}\NormalTok{), }\DataTypeTok{b=}\KeywordTok{I}\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\KeywordTok{exp}\NormalTok{(}\OperatorTok{-}\NormalTok{freq)))}
\NormalTok{an1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(a }\OperatorTok{~}\StringTok{ }\NormalTok{b, }\DataTypeTok{data=}\NormalTok{df)}
\NormalTok{preds <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(}\DataTypeTok{object =}\NormalTok{ an1, }\DataTypeTok{newdata =} \KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{b=}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{99}\NormalTok{, .}\DecValTok{01}\NormalTok{)))}
\NormalTok{k =}\StringTok{ }\DecValTok{1}
\NormalTok{c =}\StringTok{ }\NormalTok{.}\DecValTok{9}

\NormalTok{min.RSS <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(data, par) \{}
              \KeywordTok{with}\NormalTok{(data, }\KeywordTok{sum}\NormalTok{((par[}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\StringTok{ }\NormalTok{par[}\DecValTok{2}\NormalTok{] }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{c }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{(}\OperatorTok{-}\NormalTok{x))) }\OperatorTok{-}\StringTok{ }\NormalTok{y)}\OperatorTok{^}\DecValTok{2}\NormalTok{))}
\NormalTok{\}}

\NormalTok{dat <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(}\FloatTok{0.2}\NormalTok{, }\FloatTok{0.8}\NormalTok{), }\DataTypeTok{y =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, .}\DecValTok{65}\NormalTok{))}

\NormalTok{pars <-}\StringTok{ }\KeywordTok{optim}\NormalTok{(}\DataTypeTok{par =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{), min.RSS, }\DataTypeTok{data=}\NormalTok{dat)}\OperatorTok{$}\NormalTok{par}

\NormalTok{freqs <-}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{99}\NormalTok{, .}\DecValTok{01}\NormalTok{)}
\NormalTok{ws <-}\StringTok{ }\NormalTok{pars[}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\StringTok{ }\NormalTok{pars[}\DecValTok{2}\NormalTok{] }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{c }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{(}\OperatorTok{-}\NormalTok{freqs)))}
\KeywordTok{plot}\NormalTok{(freqs, ws)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/asymptotic model-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nfmal <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(}\DataTypeTok{mal=}\OtherTok{NULL}\NormalTok{, }\DataTypeTok{k=}\DecValTok{1}\NormalTok{) \{}
\NormalTok{  freq <-}\StringTok{ }\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{mal}
  \CommentTok{# adapted moph}
\NormalTok{  min.RSS <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(data, par) \{}
              \KeywordTok{with}\NormalTok{(data, }\KeywordTok{sum}\NormalTok{(( (par[}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{((par[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{par[}\DecValTok{1}\NormalTok{])}\OperatorTok{/}\NormalTok{par[}\DecValTok{2}\NormalTok{]) }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{((}\OperatorTok{-}\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{k }\OperatorTok{*}\StringTok{ }\NormalTok{x))) }\OperatorTok{-}\StringTok{ }\NormalTok{y)}\OperatorTok{^}\DecValTok{2}\NormalTok{))}
\NormalTok{  \}}

\NormalTok{  dat.ad <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(}\FloatTok{0.2}\NormalTok{, }\FloatTok{0.8}\NormalTok{), }\DataTypeTok{y =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, .}\DecValTok{65}\NormalTok{))}
\NormalTok{  pars.ad <-}\StringTok{ }\KeywordTok{optim}\NormalTok{(}\DataTypeTok{par =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), min.RSS, }\DataTypeTok{data=}\NormalTok{dat.ad)}\OperatorTok{$}\NormalTok{par}
  
\NormalTok{  freqs <-}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{)}
\NormalTok{  ws.ad <-}\StringTok{  }\NormalTok{(pars.ad[}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{((pars.ad[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{pars.ad[}\DecValTok{1}\NormalTok{])}\OperatorTok{/}\NormalTok{pars.ad[}\DecValTok{2}\NormalTok{]) }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{((}\OperatorTok{-}\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{k }\OperatorTok{*}\StringTok{ }\NormalTok{freqs)))}
  
  \CommentTok{# plot(freqs, ws.ad)}
  
  \CommentTok{# maladapted morph}
  
\NormalTok{  ws.mal <-}\StringTok{ }\KeywordTok{rev}\NormalTok{(ws.ad) }\OperatorTok{-}\StringTok{ }\NormalTok{.}\DecValTok{35} 
  
\NormalTok{  raw <-}\StringTok{ }\NormalTok{(ws.ad }\OperatorTok{*}\StringTok{ }\NormalTok{freqs) }\OperatorTok{+}\StringTok{ }\NormalTok{(ws.mal }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{freqs))}
  
\NormalTok{  min.w <-}\StringTok{ }\KeywordTok{min}\NormalTok{(raw)}
\NormalTok{  max.w <-}\StringTok{ }\KeywordTok{max}\NormalTok{(raw }\OperatorTok{-}\StringTok{ }\NormalTok{min.w)}
  
\NormalTok{  scaled <-}\StringTok{ }\NormalTok{(raw }\OperatorTok{-}\StringTok{ }\NormalTok{min.w)}\OperatorTok{/}\NormalTok{max.w}
  \KeywordTok{cbind}\NormalTok{(freqs, scaled)}
  \KeywordTok{plot}\NormalTok{(}\KeywordTok{rev}\NormalTok{(freqs), }\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{scaled)}
  \CommentTok{#plot(freqs, ws.ad, ylim=c(-2, 2), type="l")}
  \CommentTok{#plot(freqs, ws.ad, type="l")}
  \CommentTok{#lines(freqs, ws.mal, lty=2)}
  
  \CommentTok{# for output}
\NormalTok{   ws.ad2 <-}\StringTok{ }\NormalTok{(pars.ad[}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{((pars.ad[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{pars.ad[}\DecValTok{1}\NormalTok{])}\OperatorTok{/}\NormalTok{pars.ad[}\DecValTok{2}\NormalTok{]) }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{((}\OperatorTok{-}\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{k }\OperatorTok{*}\StringTok{ }\NormalTok{freq)))}
\NormalTok{   ws.mal2 <-}\StringTok{ }\NormalTok{(pars.ad[}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{((pars.ad[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{pars.ad[}\DecValTok{1}\NormalTok{])}\OperatorTok{/}\NormalTok{pars.ad[}\DecValTok{2}\NormalTok{]) }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{((}\OperatorTok{-}\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{k }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{freq)))) }\OperatorTok{-}\StringTok{ }\NormalTok{.}\DecValTok{35}
\NormalTok{   raw2 <-}\StringTok{ }\NormalTok{(ws.ad2 }\OperatorTok{*}\StringTok{ }\NormalTok{freq) }\OperatorTok{+}\StringTok{ }\NormalTok{(ws.mal2 }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{freq))}
\NormalTok{   sc2 <-}\StringTok{ }\NormalTok{(raw2}\OperatorTok{-}\NormalTok{min.w) }\OperatorTok{/}\StringTok{ }\NormalTok{max.w}
  
  \CommentTok{#plot(freqs, mal)}
  \CommentTok{#pars.ad}

  \DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{sc2}

\NormalTok{\}}


\CommentTok{#lm(c(1, .65) ~ c(.16, ))}
\NormalTok{st.w <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) \{ }\FloatTok{1.117} \OperatorTok{-}\StringTok{ }\FloatTok{0.583} \OperatorTok{*}\StringTok{ }\NormalTok{freq}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{freq)\}}
\NormalTok{gr.w <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) \{ }\FloatTok{0.183} \OperatorTok{+}\StringTok{ }\FloatTok{0.583} \OperatorTok{*}\StringTok{ }\NormalTok{freq}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{freq)\}}

\NormalTok{w.bar <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) }\KeywordTok{st.w}\NormalTok{(freq}\OperatorTok{-}\NormalTok{.}\DecValTok{01}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{freq }\OperatorTok{+}\StringTok{ }\KeywordTok{gr.w}\NormalTok{(freq}\OperatorTok{-}\NormalTok{.}\DecValTok{01}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{(freq}\OperatorTok{-}\NormalTok{.}\DecValTok{01}\NormalTok{))}

\NormalTok{wbs <-}\StringTok{ }\KeywordTok{w.bar}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{))}

\KeywordTok{cbind}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,.}\DecValTok{01}\NormalTok{), wbs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                   wbs
##   [1,] 0.00 0.1788828
##   [2,] 0.01 0.1941700
##   [3,] 0.02 0.2091085
##   [4,] 0.03 0.2237055
##   [5,] 0.04 0.2379677
##   [6,] 0.05 0.2519024
##   [7,] 0.06 0.2655163
##   [8,] 0.07 0.2788166
##   [9,] 0.08 0.2918103
##  [10,] 0.09 0.3045043
##  [11,] 0.10 0.3169056
##  [12,] 0.11 0.3290213
##  [13,] 0.12 0.3408583
##  [14,] 0.13 0.3524236
##  [15,] 0.14 0.3637242
##  [16,] 0.15 0.3747672
##  [17,] 0.16 0.3855594
##  [18,] 0.17 0.3961080
##  [19,] 0.18 0.4064198
##  [20,] 0.19 0.4165020
##  [21,] 0.20 0.4263615
##  [22,] 0.21 0.4360052
##  [23,] 0.22 0.4454402
##  [24,] 0.23 0.4546735
##  [25,] 0.24 0.4637121
##  [26,] 0.25 0.4725630
##  [27,] 0.26 0.4812331
##  [28,] 0.27 0.4897295
##  [29,] 0.28 0.4980592
##  [30,] 0.29 0.5062291
##  [31,] 0.30 0.5142463
##  [32,] 0.31 0.5221177
##  [33,] 0.32 0.5298504
##  [34,] 0.33 0.5374513
##  [35,] 0.34 0.5449274
##  [36,] 0.35 0.5522858
##  [37,] 0.36 0.5595334
##  [38,] 0.37 0.5666773
##  [39,] 0.38 0.5737243
##  [40,] 0.39 0.5806816
##  [41,] 0.40 0.5875561
##  [42,] 0.41 0.5943548
##  [43,] 0.42 0.6010847
##  [44,] 0.43 0.6077528
##  [45,] 0.44 0.6143661
##  [46,] 0.45 0.6209316
##  [47,] 0.46 0.6274563
##  [48,] 0.47 0.6339472
##  [49,] 0.48 0.6404113
##  [50,] 0.49 0.6468555
##  [51,] 0.50 0.6532869
##  [52,] 0.51 0.6597125
##  [53,] 0.52 0.6661392
##  [54,] 0.53 0.6725742
##  [55,] 0.54 0.6790242
##  [56,] 0.55 0.6854965
##  [57,] 0.56 0.6919978
##  [58,] 0.57 0.6985353
##  [59,] 0.58 0.7051160
##  [60,] 0.59 0.7117468
##  [61,] 0.60 0.7184347
##  [62,] 0.61 0.7251868
##  [63,] 0.62 0.7320100
##  [64,] 0.63 0.7389113
##  [65,] 0.64 0.7458977
##  [66,] 0.65 0.7529763
##  [67,] 0.66 0.7601539
##  [68,] 0.67 0.7674377
##  [69,] 0.68 0.7748345
##  [70,] 0.69 0.7823515
##  [71,] 0.70 0.7899956
##  [72,] 0.71 0.7977737
##  [73,] 0.72 0.8056929
##  [74,] 0.73 0.8137602
##  [75,] 0.74 0.8219826
##  [76,] 0.75 0.8303671
##  [77,] 0.76 0.8389206
##  [78,] 0.77 0.8476502
##  [79,] 0.78 0.8565629
##  [80,] 0.79 0.8656656
##  [81,] 0.80 0.8749654
##  [82,] 0.81 0.8844692
##  [83,] 0.82 0.8941841
##  [84,] 0.83 0.9041170
##  [85,] 0.84 0.9142749
##  [86,] 0.85 0.9246649
##  [87,] 0.86 0.9352939
##  [88,] 0.87 0.9461690
##  [89,] 0.88 0.9572970
##  [90,] 0.89 0.9686851
##  [91,] 0.90 0.9803402
##  [92,] 0.91 0.9922693
##  [93,] 0.92 1.0044794
##  [94,] 0.93 1.0169775
##  [95,] 0.94 1.0297706
##  [96,] 0.95 1.0428657
##  [97,] 0.96 1.0562698
##  [98,] 0.97 1.0699899
##  [99,] 0.98 1.0840330
## [100,] 0.99 1.0984060
## [101,] 1.00 1.1131160
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{max}\NormalTok{(wbs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.113116
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{), wbs)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/asymptotic model-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#wss <- ws(seq(0, 1, .001))}
\CommentTok{#max(wss - min(wss))}
\CommentTok{#min(wss)}
\NormalTok{ws <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) \{}
\NormalTok{  w.bar <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) }\KeywordTok{st.w}\NormalTok{(freq}\OperatorTok{-}\NormalTok{.}\DecValTok{01}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{freq }\OperatorTok{+}\StringTok{ }\KeywordTok{gr.w}\NormalTok{(freq}\OperatorTok{-}\NormalTok{.}\DecValTok{01}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{freq}\OperatorTok{-}\NormalTok{.}\DecValTok{01}\NormalTok{)}
\NormalTok{  raw <-}\StringTok{ }\KeywordTok{w.bar}\NormalTok{(freq) }\OperatorTok{*}\StringTok{ }\NormalTok{freq}
\NormalTok{  raw}\OperatorTok{/}\FloatTok{1.10934}
\NormalTok{  \}}

\KeywordTok{ws}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] 0.000000000 0.001717327 0.003701897 0.005944533 0.008436311 0.011168560
##   [7] 0.014132861 0.017321048 0.020725205 0.024337671 0.028151034 0.032158138
##  [13] 0.036352077 0.040726197 0.045274098 0.049989630 0.054866897 0.059900256
##  [19] 0.065084313 0.070413929 0.075884216 0.081490540 0.087228518 0.093094017
##  [25] 0.099083161 0.105192323 0.111418129 0.117757457 0.124207438 0.130765455
##  [31] 0.137429142 0.144196388 0.151065331 0.158034364 0.165102130 0.172267526
##  [37] 0.179529701 0.186888056 0.194342243 0.201892168 0.209537989 0.217280116
##  [43] 0.225119211 0.233056187 0.241092213 0.249228707 0.257467340 0.265810035
##  [49] 0.274258969 0.282816569 0.291485515 0.300268741 0.309169430 0.318191021
##  [55] 0.327337201 0.336611913 0.346019350 0.355563959 0.365250438 0.375083737
##  [61] 0.385069059 0.395211859 0.405517845 0.415992976 0.426643465 0.437475774
##  [67] 0.448496621 0.459712974 0.471132054 0.482761334 0.494608540 0.506681649
##  [73] 0.518988892 0.531538749 0.544339957 0.557401501 0.570732620 0.584342806
##  [79] 0.598241803 0.612439605 0.626946460 0.641772870 0.656929587 0.672427615
##  [85] 0.688278211 0.704492885 0.721083398 0.738061764 0.755440249 0.773231371
##  [91] 0.791447901 0.810102862 0.829209529 0.848781429 0.868832341 0.889376298
##  [97] 0.910427584 0.932000735 0.954110539 0.976772039 1.000000526
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{), }\KeywordTok{ws}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/asymptotic model-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{freqs <-}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{)}

\KeywordTok{png}\NormalTok{(}\DataTypeTok{filename =} \StringTok{"figures/nfds_mal.png"}\NormalTok{)}

\KeywordTok{plot}\NormalTok{(freqs, freqs, }\DataTypeTok{type=}\StringTok{"n"}\NormalTok{, }
     \DataTypeTok{xlab=} \StringTok{"frequency of cryptic morph"}\NormalTok{, }
     \DataTypeTok{ylab=} \StringTok{"average population fitness (scaled)"}\NormalTok{, }
     \DataTypeTok{cex.lab =} \FloatTok{1.5}\NormalTok{, }\DataTypeTok{las =} \DecValTok{1}\NormalTok{, }\DataTypeTok{cex.axis =} \FloatTok{1.5}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \KeywordTok{c}\NormalTok{(}\FloatTok{0.01}\NormalTok{, .}\DecValTok{6}\NormalTok{ , }\FloatTok{1.2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{)) \{}
  
\NormalTok{  min.RSS <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(data, par) \{}
              \KeywordTok{with}\NormalTok{(data, }\KeywordTok{sum}\NormalTok{(( (par[}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{((par[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{par[}\DecValTok{1}\NormalTok{])}\OperatorTok{/}\NormalTok{par[}\DecValTok{2}\NormalTok{]) }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{((}\OperatorTok{-}\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{k }\OperatorTok{*}\StringTok{ }\NormalTok{x))) }\OperatorTok{-}\StringTok{ }\NormalTok{y)}\OperatorTok{^}\DecValTok{2}\NormalTok{))}
\NormalTok{  \}}

\NormalTok{  dat.ad <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(}\FloatTok{0.2}\NormalTok{, }\FloatTok{0.8}\NormalTok{), }\DataTypeTok{y =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, .}\DecValTok{65}\NormalTok{))}
\NormalTok{  pars.ad <-}\StringTok{ }\KeywordTok{optim}\NormalTok{(}\DataTypeTok{par =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), min.RSS, }\DataTypeTok{data=}\NormalTok{dat.ad)}\OperatorTok{$}\NormalTok{par}
  
\NormalTok{  freqs <-}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{01}\NormalTok{)}
\NormalTok{  ws.ad <-}\StringTok{  }\NormalTok{(pars.ad[}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{((pars.ad[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{pars.ad[}\DecValTok{1}\NormalTok{])}\OperatorTok{/}\NormalTok{pars.ad[}\DecValTok{2}\NormalTok{]) }\OperatorTok{*}\StringTok{ }\KeywordTok{exp}\NormalTok{((}\OperatorTok{-}\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{k }\OperatorTok{*}\StringTok{ }\NormalTok{freqs)))}
  
  
  \CommentTok{# maladapted morph}
  
\NormalTok{  ws.mal <-}\StringTok{ }\KeywordTok{rev}\NormalTok{(ws.ad) }\OperatorTok{-}\StringTok{ }\NormalTok{.}\DecValTok{35} 
  
\NormalTok{  raw <-}\StringTok{ }\NormalTok{(ws.ad }\OperatorTok{*}\StringTok{ }\NormalTok{freqs) }\OperatorTok{+}\StringTok{ }\NormalTok{(ws.mal }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{freqs))}
  
\NormalTok{  min.w <-}\StringTok{ }\KeywordTok{min}\NormalTok{(raw)}
\NormalTok{  max.w <-}\StringTok{ }\KeywordTok{max}\NormalTok{(raw }\OperatorTok{-}\StringTok{ }\NormalTok{min.w)}
  
\NormalTok{  scaled <-}\StringTok{ }\NormalTok{(raw }\OperatorTok{-}\StringTok{ }\NormalTok{min.w)}\OperatorTok{/}\NormalTok{max.w}
  
  \KeywordTok{lines}\NormalTok{(freqs, scaled)}
\NormalTok{\}}

\KeywordTok{text}\NormalTok{(}\KeywordTok{c}\NormalTok{(.}\DecValTok{2}\NormalTok{, .}\DecValTok{7}\NormalTok{), }\KeywordTok{c}\NormalTok{(.}\DecValTok{8}\NormalTok{, .}\DecValTok{6}\NormalTok{), }
     \DataTypeTok{labels=}\KeywordTok{c}\NormalTok{(}\StringTok{"k = 0.01"}\NormalTok{, }\StringTok{"k = 4.0"}\NormalTok{),}
     \DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{)}

\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lm}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\FloatTok{1.667}\NormalTok{, }\FloatTok{1.0835}\NormalTok{) }\OperatorTok{~}\StringTok{ }\KeywordTok{c}\NormalTok{(.}\DecValTok{2}\NormalTok{, .}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = c(1.667, 1.0835) ~ c(0.2, 0.8))
## 
## Coefficients:
## (Intercept)  c(0.2, 0.8)  
##      1.8615      -0.9725
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lm}\NormalTok{(}\KeywordTok{c}\NormalTok{(.}\DecValTok{5}\NormalTok{, }\FloatTok{1.0835}\NormalTok{) }\OperatorTok{~}\StringTok{ }\KeywordTok{c}\NormalTok{(.}\DecValTok{2}\NormalTok{, .}\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = c(0.5, 1.0835) ~ c(0.2, 0.8))
## 
## Coefficients:
## (Intercept)  c(0.2, 0.8)  
##      0.3055       0.9725
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{st.w <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) \{ }\FloatTok{1.861} \OperatorTok{-}\StringTok{ }\NormalTok{.}\DecValTok{972} \OperatorTok{*}\StringTok{ }\NormalTok{(freq}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{freq)) \}}
\NormalTok{gr.w <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) \{ }\FloatTok{0.306} \OperatorTok{+}\StringTok{ }\NormalTok{.}\DecValTok{972} \OperatorTok{*}\StringTok{ }\NormalTok{(freq}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{freq)) \}}



\NormalTok{w.bar <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(freq) }\KeywordTok{st.w}\NormalTok{(freq) }\OperatorTok{*}\StringTok{ }\NormalTok{freq }\OperatorTok{+}\StringTok{ }\KeywordTok{gr.w}\NormalTok{(freq) }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{freq)}

\NormalTok{wbs <-}\StringTok{ }\KeywordTok{w.bar}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{99}\NormalTok{, .}\DecValTok{01}\NormalTok{))}
\NormalTok{wbs.sc <-}\StringTok{ }\NormalTok{(wbs }\OperatorTok{-}\StringTok{ }\KeywordTok{min}\NormalTok{(wbs))}\OperatorTok{/}\KeywordTok{max}\NormalTok{(wbs}\OperatorTok{-}\KeywordTok{min}\NormalTok{(wbs))}

\KeywordTok{cbind}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,.}\DecValTok{99}\NormalTok{,.}\DecValTok{01}\NormalTok{), wbs.sc)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                wbs.sc
##   [1,] 0.00 0.9916345
##   [2,] 0.01 0.9919035
##   [3,] 0.02 0.9921705
##   [4,] 0.03 0.9924352
##   [5,] 0.04 0.9926977
##   [6,] 0.05 0.9929578
##   [7,] 0.06 0.9932155
##   [8,] 0.07 0.9934706
##   [9,] 0.08 0.9937232
##  [10,] 0.09 0.9939732
##  [11,] 0.10 0.9942203
##  [12,] 0.11 0.9944647
##  [13,] 0.12 0.9947060
##  [14,] 0.13 0.9949443
##  [15,] 0.14 0.9951795
##  [16,] 0.15 0.9954114
##  [17,] 0.16 0.9956399
##  [18,] 0.17 0.9958649
##  [19,] 0.18 0.9960863
##  [20,] 0.19 0.9963039
##  [21,] 0.20 0.9965176
##  [22,] 0.21 0.9967272
##  [23,] 0.22 0.9969326
##  [24,] 0.23 0.9971337
##  [25,] 0.24 0.9973302
##  [26,] 0.25 0.9975219
##  [27,] 0.26 0.9977087
##  [28,] 0.27 0.9978904
##  [29,] 0.28 0.9980668
##  [30,] 0.29 0.9982375
##  [31,] 0.30 0.9984025
##  [32,] 0.31 0.9985614
##  [33,] 0.32 0.9987140
##  [34,] 0.33 0.9988600
##  [35,] 0.34 0.9989991
##  [36,] 0.35 0.9991309
##  [37,] 0.36 0.9992552
##  [38,] 0.37 0.9993715
##  [39,] 0.38 0.9994795
##  [40,] 0.39 0.9995788
##  [41,] 0.40 0.9996690
##  [42,] 0.41 0.9997495
##  [43,] 0.42 0.9998199
##  [44,] 0.43 0.9998796
##  [45,] 0.44 0.9999281
##  [46,] 0.45 0.9999648
##  [47,] 0.46 0.9999890
##  [48,] 0.47 1.0000000
##  [49,] 0.48 0.9999970
##  [50,] 0.49 0.9999793
##  [51,] 0.50 0.9999458
##  [52,] 0.51 0.9998958
##  [53,] 0.52 0.9998280
##  [54,] 0.53 0.9997415
##  [55,] 0.54 0.9996349
##  [56,] 0.55 0.9995070
##  [57,] 0.56 0.9993563
##  [58,] 0.57 0.9991811
##  [59,] 0.58 0.9989798
##  [60,] 0.59 0.9987505
##  [61,] 0.60 0.9984909
##  [62,] 0.61 0.9981989
##  [63,] 0.62 0.9978718
##  [64,] 0.63 0.9975069
##  [65,] 0.64 0.9971008
##  [66,] 0.65 0.9966502
##  [67,] 0.66 0.9961511
##  [68,] 0.67 0.9955991
##  [69,] 0.68 0.9949892
##  [70,] 0.69 0.9943158
##  [71,] 0.70 0.9935725
##  [72,] 0.71 0.9927523
##  [73,] 0.72 0.9918467
##  [74,] 0.73 0.9908463
##  [75,] 0.74 0.9897402
##  [76,] 0.75 0.9885157
##  [77,] 0.76 0.9871580
##  [78,] 0.77 0.9856497
##  [79,] 0.78 0.9839702
##  [80,] 0.79 0.9820952
##  [81,] 0.80 0.9799953
##  [82,] 0.81 0.9776350
##  [83,] 0.82 0.9749709
##  [84,] 0.83 0.9719493
##  [85,] 0.84 0.9685033
##  [86,] 0.85 0.9645479
##  [87,] 0.86 0.9599741
##  [88,] 0.87 0.9546390
##  [89,] 0.88 0.9483525
##  [90,] 0.89 0.9408549
##  [91,] 0.90 0.9317830
##  [92,] 0.91 0.9206120
##  [93,] 0.92 0.9065547
##  [94,] 0.93 0.8883742
##  [95,] 0.94 0.8640088
##  [96,] 0.95 0.8297477
##  [97,] 0.96 0.7781690
##  [98,] 0.97 0.6919551
##  [99,] 0.98 0.5191534
## [100,] 0.99 0.0000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{max}\NormalTok{(wbs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.088568
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{99}\NormalTok{, .}\DecValTok{01}\NormalTok{), wbs.sc)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analyses_files/figure-latex/test-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{png}\NormalTok{(}\DataTypeTok{filename =} \StringTok{"figures/NFDS_model.png"}\NormalTok{)}
\CommentTok{#par(mfrow=c(2,1))}
\KeywordTok{plot}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), }\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{1.2}\NormalTok{), }\DataTypeTok{type=}\StringTok{"n"}\NormalTok{,}
     \DataTypeTok{xlab=}\StringTok{"cryptic morph frequency"}\NormalTok{,}
     \DataTypeTok{ylab=}\StringTok{"absolute fitness"}\NormalTok{,}
     \DataTypeTok{las=}\DecValTok{1}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{a=}\FloatTok{1.117}\NormalTok{, }\DataTypeTok{b =} \OperatorTok{-}\FloatTok{0.583}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{a=}\FloatTok{0.183}\NormalTok{, }\DataTypeTok{b =} \FloatTok{0.583}\NormalTok{, }\DataTypeTok{lty=}\DecValTok{2}\NormalTok{ )}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{h=}\NormalTok{.}\DecValTok{65}\NormalTok{, }\DataTypeTok{lty=}\DecValTok{3}\NormalTok{, }\DataTypeTok{lwd=}\NormalTok{.}\DecValTok{5}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }
       \DataTypeTok{legend=}\KeywordTok{c}\NormalTok{(}\StringTok{"cryptic"}\NormalTok{, }\StringTok{"conspicuous"}\NormalTok{),}
       \DataTypeTok{lty=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{),}
       \DataTypeTok{bty=}\StringTok{"n"}\NormalTok{, }\DataTypeTok{cex =}\NormalTok{ .}\DecValTok{75}\NormalTok{)}
\CommentTok{#plot(seq(0, 1, .01), wbs.sc, type="l", xlab="cryptic morph frequency",ylab="scaled average absolute fitness", las=1)}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\end{document}
